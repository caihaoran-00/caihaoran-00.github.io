<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"caihaoran-00.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€åœ¨LLMåº”ç”¨ï¼šç»“æ„åŒ–æå–åŠåç»­æ€è·¯ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨pdfplumberçš„.extract_textæ–¹æ³•ï¼Œä½†è¿™ä¸ªæ–¹æ³•ä¼šå°†å…¨æ–‡ï¼ˆå°¤å…¶æŒ‡è¡¨æ ¼éƒ¨åˆ†ï¼‰å½“åšæ™®é€šæ–‡æœ¬æŒ‰è¡Œè¯»å–ï¼Œä¼šå®Œå…¨ä¸¢å¤±è¡¨æ ¼çš„æ ¼å¼ï¼Œå¯Ÿè§‰pdfplumberåº“çš„ç”¨æ³•æœ‰äº›å­¦é—®ï¼Œé‚å‡†å¤‡æœ¬æ–‡è®°å½•ä¸‹pdfplumberçš„åŸºç¡€ç”¨æ³•ï¼Œç›®çš„æ˜¯è‡ªåŠ¨åŒ–çš„åˆ¤åˆ«æ˜¯æ™®é€šæ–‡æœ¬è¿˜æ˜¯è¡¨æ ¼ï¼Œè¡¨æ ¼æ•°æ®ç”¨è¡¨æ ¼æå–çš„æ–¹å¼ï¼Œæ™®é€šæ–‡æœ¬ç”¨æ–‡æœ¬æå–çš„æ–¹æ³•ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="PDFè§£æåº“ï¼špdfplumberåŸºç¡€ç”¨æ³•">
<meta property="og:url" content="https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/index.html">
<meta property="og:site_name" content="Chr&#39;s Blog">
<meta property="og:description" content="å‰è¨€åœ¨LLMåº”ç”¨ï¼šç»“æ„åŒ–æå–åŠåç»­æ€è·¯ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨pdfplumberçš„.extract_textæ–¹æ³•ï¼Œä½†è¿™ä¸ªæ–¹æ³•ä¼šå°†å…¨æ–‡ï¼ˆå°¤å…¶æŒ‡è¡¨æ ¼éƒ¨åˆ†ï¼‰å½“åšæ™®é€šæ–‡æœ¬æŒ‰è¡Œè¯»å–ï¼Œä¼šå®Œå…¨ä¸¢å¤±è¡¨æ ¼çš„æ ¼å¼ï¼Œå¯Ÿè§‰pdfplumberåº“çš„ç”¨æ³•æœ‰äº›å­¦é—®ï¼Œé‚å‡†å¤‡æœ¬æ–‡è®°å½•ä¸‹pdfplumberçš„åŸºç¡€ç”¨æ³•ï¼Œç›®çš„æ˜¯è‡ªåŠ¨åŒ–çš„åˆ¤åˆ«æ˜¯æ™®é€šæ–‡æœ¬è¿˜æ˜¯è¡¨æ ¼ï¼Œè¡¨æ ¼æ•°æ®ç”¨è¡¨æ ¼æå–çš„æ–¹å¼ï¼Œæ™®é€šæ–‡æœ¬ç”¨æ–‡æœ¬æå–çš„æ–¹æ³•ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-06-04T01:31:48.000Z">
<meta property="article:modified_time" content="2025-06-07T11:16:32.080Z">
<meta property="article:author" content="Chr">
<meta property="article:tag" content="pdf">
<meta property="article:tag" content="pdfplumber">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/","path":"2025/06/04/PDFè§£æåº“ï¼špdfplumberåŸºç¡€ç”¨æ³•/","title":"PDFè§£æåº“ï¼špdfplumberåŸºç¡€ç”¨æ³•"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>PDFè§£æåº“ï¼špdfplumberåŸºç¡€ç”¨æ³• | Chr's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Chr's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Record and Share</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="æœç´¢..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-number">2.</span> <span class="nav-text">åŸºç¡€çŸ¥è¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80-Page-chars"><span class="nav-number">2.1.</span> <span class="nav-text">ä¸€ Page.chars</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C-im-draw-rect-%E2%80%A6"><span class="nav-number">2.2.</span> <span class="nav-text">äºŒ im.draw_rect(â€¦)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89-%E6%96%87%E6%9C%AC%E6%8F%90%E5%8F%96"><span class="nav-number">2.3.</span> <span class="nav-text">ä¸‰ æ–‡æœ¬æå–</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Page-extract-text-%E2%80%A6"><span class="nav-number">2.3.1.</span> <span class="nav-text">1. Page.extract_text(â€¦)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-extract-words-%E2%80%A6"><span class="nav-number">2.3.2.</span> <span class="nav-text">2. extract_words(â€¦)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-extract-text-lines-%E2%80%A6"><span class="nav-number">2.3.3.</span> <span class="nav-text">3. extract_text_lines(â€¦)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-search-%E2%80%A6"><span class="nav-number">2.3.4.</span> <span class="nav-text">4. search(â€¦)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B-%E8%A1%A8%E6%A0%BC%E6%8F%90%E5%8F%96"><span class="nav-number">2.4.</span> <span class="nav-text">å›› è¡¨æ ¼æå–</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-extract-tables-%E2%80%A6"><span class="nav-number">2.4.1.</span> <span class="nav-text">1. extract_tables(â€¦)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-find-tables-%E2%80%A6"><span class="nav-number">2.4.2.</span> <span class="nav-text">2. find_tables(â€¦)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%AF%B9%E6%AF%94"><span class="nav-number">2.4.3.</span> <span class="nav-text">3. å¯¹æ¯”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94-Page-crop-%E2%80%A6"><span class="nav-number">2.5.</span> <span class="nav-text">äº” Page.crop(â€¦)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%9C%85%E6%AD%A3%E6%96%87"><span class="nav-number">3.</span> <span class="nav-text">âœ…æ­£æ–‡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%B7%E5%90%88%E8%A1%A8%E6%A0%BC-%E6%96%87%E6%9C%AC"><span class="nav-number">3.1.</span> <span class="nav-text">æ··åˆè¡¨æ ¼&#x2F;æ–‡æœ¬</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85%E7%95%99%E5%9D%91"><span class="nav-number">3.2.</span> <span class="nav-text">âœ…ç•™å‘</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%84%E5%BD%95"><span class="nav-number">4.</span> <span class="nav-text">é™„å½•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-page-extract-text"><span class="nav-number">4.1.</span> <span class="nav-text">1 page.extract_text</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%AC%AC%E4%BA%8C%E9%A1%B5-%E7%AC%AC%E4%B8%89%E9%A1%B5"><span class="nav-number">4.2.</span> <span class="nav-text">2 ç¬¬äºŒé¡µ+ç¬¬ä¸‰é¡µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-layout-True"><span class="nav-number">4.3.</span> <span class="nav-text">3 layout&#x3D;True</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-table-settings"><span class="nav-number">4.4.</span> <span class="nav-text">4 table_settings</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-extract-words-%E2%80%A6"><span class="nav-number">4.5.</span> <span class="nav-text">5 extract_words(â€¦)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-extract-words-vs-extract-text-lines"><span class="nav-number">4.6.</span> <span class="nav-text">6 extract_words() vs extract_text_lines()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-search"><span class="nav-number">4.7.</span> <span class="nav-text">7 search</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chr</p>
  <div class="site-description" itemprop="description">Welcome to my little world</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">90</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:1299964565@qq.com" title="E-Mail â†’ mailto:1299964565@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chr">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chr's Blog">
      <meta itemprop="description" content="Welcome to my little world">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="PDFè§£æåº“ï¼špdfplumberåŸºç¡€ç”¨æ³• | Chr's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PDFè§£æåº“ï¼špdfplumberåŸºç¡€ç”¨æ³•
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-06-04 09:31:48" itemprop="dateCreated datePublished" datetime="2025-06-04T09:31:48+08:00">2025-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-07 19:16:32" itemprop="dateModified" datetime="2025-06-07T19:16:32+08:00">2025-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>16k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>57 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨<a href="https://caihaoran-00.github.io/2025/05/29/LLM%E5%BA%94%E7%94%A8%EF%BC%9A%E7%BB%93%E6%9E%84%E5%8C%96%E6%8F%90%E5%8F%96%E5%8F%8A%E5%90%8E%E7%BB%AD%E6%80%9D%E8%B7%AF/#more">LLMåº”ç”¨ï¼šç»“æ„åŒ–æå–åŠåç»­æ€è·¯</a>ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>pdfplumber</code>çš„<code>.extract_text</code>æ–¹æ³•ï¼Œä½†è¿™ä¸ªæ–¹æ³•ä¼šå°†å…¨æ–‡ï¼ˆå°¤å…¶æŒ‡è¡¨æ ¼éƒ¨åˆ†ï¼‰å½“åšæ™®é€šæ–‡æœ¬æŒ‰è¡Œè¯»å–ï¼Œä¼šå®Œå…¨ä¸¢å¤±è¡¨æ ¼çš„æ ¼å¼ï¼Œå¯Ÿè§‰<code>pdfplumber</code>åº“çš„ç”¨æ³•æœ‰äº›å­¦é—®ï¼Œé‚å‡†å¤‡æœ¬æ–‡è®°å½•ä¸‹<code>pdfplumber</code>çš„åŸºç¡€ç”¨æ³•ï¼Œç›®çš„æ˜¯è‡ªåŠ¨åŒ–çš„åˆ¤åˆ«æ˜¯æ™®é€šæ–‡æœ¬è¿˜æ˜¯è¡¨æ ¼ï¼Œè¡¨æ ¼æ•°æ®ç”¨è¡¨æ ¼æå–çš„æ–¹å¼ï¼Œæ™®é€šæ–‡æœ¬ç”¨æ–‡æœ¬æå–çš„æ–¹æ³•ã€‚</p>
<span id="more"></span>

<hr>
<h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="ä¸€-Page-chars"><a href="#ä¸€-Page-chars" class="headerlink" title="ä¸€ Page.chars"></a>ä¸€ Page.chars</h3><p>æˆ‘ä»¬ä»å®˜æ–¹ç»™çš„åŸºæœ¬ç¤ºä¾‹å¼€å§‹çœ‹èµ·ï¼Œæ‰“å°ç¬¬ä¸€é¡µçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼š</p>
<figure class="highlight python"><figcaption><span>pdfplumber_basic_chars.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    first_page = pdf.pages[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(first_page.chars[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&#x27;matrix&#x27;</span>: (1, 0, 0, 1, 303.75000763, 37.94699858999995), </span><br><span class="line"><span class="string">&#x27;fontname&#x27;</span>: <span class="string">&#x27;FAAAAH+TimesNewRomanPSMT&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;adv&#x27;</span>: 4.5,</span><br><span class="line"><span class="string">&#x27;upright&#x27;</span>: True,</span><br><span class="line"><span class="string">&#x27;x0&#x27;</span>: 303.75000763,</span><br><span class="line"><span class="string">&#x27;y0&#x27;</span>: 36.00299858999995,</span><br><span class="line"><span class="string">&#x27;x1&#x27;</span>: 308.25000763,</span><br><span class="line"><span class="string">&#x27;y1&#x27;</span>: 45.00299858999995,</span><br><span class="line"><span class="string">&#x27;width&#x27;</span>: 4.5,</span><br><span class="line"><span class="string">&#x27;height&#x27;</span>: 9.0,</span><br><span class="line"><span class="string">&#x27;size&#x27;</span>: 9.0,</span><br><span class="line"><span class="string">&#x27;mcid&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;tag&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;object_type&#x27;</span>: <span class="string">&#x27;char&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;page_number&#x27;</span>: 1, </span><br><span class="line"><span class="string">&#x27;ncs&#x27;</span>: <span class="string">&#x27;DeviceGray&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;stroking_color&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;stroking_pattern&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;non_stroking_color&#x27;</span>: (0,), </span><br><span class="line"><span class="string">&#x27;non_stroking_pattern&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;top&#x27;</span>: 746.99700141,</span><br><span class="line"><span class="string">&#x27;bottom&#x27;</span>: 755.99700141,</span><br><span class="line"><span class="string">&#x27;doctop&#x27;</span>: 746.99700141</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å„å­—æ®µ&#x2F;å±æ€§åçš„è¯´æ˜å¦‚ä¸‹ï¼š</strong></p>
<table>
<thead>
<tr>
<th align="center">å±æ€§å</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">matrix</td>
<td align="center">å­—ç¬¦çš„å½“å‰å˜æ¢çŸ©é˜µï¼ˆCurrent Transformation Matrixï¼‰</td>
</tr>
<tr>
<td align="center">fontname</td>
<td align="center">å­—ä½“åç§°</td>
</tr>
<tr>
<td align="center">adv</td>
<td align="center">æ–‡å­—å®½åº¦ Ã— å­—ä½“å¤§å° Ã— ç¼©æ”¾å› å­</td>
</tr>
<tr>
<td align="center">upright</td>
<td align="center">å­—ç¬¦æ˜¯å¦ç›´ç«‹</td>
</tr>
<tr>
<td align="center">x0</td>
<td align="center">å­—ç¬¦å·¦è¾¹åˆ°é¡µé¢å·¦è¾¹çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">y0</td>
<td align="center">å­—ç¬¦åº•éƒ¨åˆ°é¡µé¢åº•éƒ¨çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">x1</td>
<td align="center">å­—ç¬¦å³è¾¹åˆ°é¡µé¢å·¦è¾¹çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">y1</td>
<td align="center">å­—ç¬¦é¡¶éƒ¨åˆ°é¡µé¢åº•éƒ¨çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">width</td>
<td align="center">å­—ç¬¦å®½åº¦</td>
</tr>
<tr>
<td align="center">height</td>
<td align="center">å­—ç¬¦é«˜åº¦</td>
</tr>
<tr>
<td align="center">size</td>
<td align="center">å­—ä½“å¤§å°</td>
</tr>
<tr>
<td align="center">mcid</td>
<td align="center">å­—ç¬¦æ‰€å±çš„æ ‡è®°å†…å®¹æ®µ IDï¼ˆå¦‚æœæœ‰ï¼Œå¦åˆ™ä¸º Noneï¼‰ï¼Œå®éªŒæ€§å±æ€§</td>
</tr>
<tr>
<td align="center">tag</td>
<td align="center">å­—ç¬¦æ‰€å±çš„æ ‡è®°å†…å®¹æ®µæ ‡ç­¾ï¼ˆå¦‚æœæœ‰ï¼Œå¦åˆ™ä¸º Noneï¼‰ï¼Œå®éªŒæ€§å±æ€§</td>
</tr>
<tr>
<td align="center">object_type</td>
<td align="center">å¯¹è±¡ç±»å‹ï¼Œå›ºå®šä¸º â€œcharâ€</td>
</tr>
<tr>
<td align="center">page_number</td>
<td align="center">å­—ç¬¦æ‰€åœ¨çš„é¡µç </td>
</tr>
<tr>
<td align="center">ncs</td>
<td align="center">TKTKï¼ˆå¾…è¡¥å……ï¼‰</td>
</tr>
<tr>
<td align="center">text</td>
<td align="center">å­—ç¬¦æœ¬èº«ï¼Œä¾‹å¦‚ï¼šâ€zâ€ã€â€Zâ€ æˆ–ç©ºæ ¼</td>
</tr>
<tr>
<td align="center">stroking_color</td>
<td align="center">å­—ç¬¦è½®å»“é¢œè‰²ï¼ˆæè¾¹è‰²ï¼‰ï¼Œè¯¦è§ docs&#x2F;colors.md</td>
</tr>
<tr>
<td align="center">stroking_pattern</td>
<td align="center">TKTKï¼ˆå¾…è¡¥å……ï¼‰</td>
</tr>
<tr>
<td align="center">non_stroking_color</td>
<td align="center">å­—ç¬¦å†…éƒ¨é¢œè‰²ï¼ˆå¡«å……è‰²ï¼‰ï¼Œè¯¦è§ docs&#x2F;colors.md</td>
</tr>
<tr>
<td align="center">non_stroking_pattern</td>
<td align="center">TKTKï¼ˆå¾…è¡¥å……ï¼‰</td>
</tr>
<tr>
<td align="center">top</td>
<td align="center">å­—ç¬¦é¡¶éƒ¨åˆ°é¡µé¢é¡¶éƒ¨çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">bottom</td>
<td align="center">å­—ç¬¦åº•éƒ¨åˆ°é¡µé¢é¡¶éƒ¨çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">doctop</td>
<td align="center">å­—ç¬¦é¡¶éƒ¨åˆ°æ•´ä¸ªæ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»</td>
</tr>
</tbody></table>
<p>å¥½çš„ï¼Œè¯è¯´å›æ¥ï¼Œ<code>&#39;text&#39;: &#39;1&#39;?</code>å“ªé‡Œæœ‰1ğŸ˜³</p>


<p>ä¸ä¼šæ˜¯é¡µé¢æœ€ä¸‹é¢ä¸­é—´çš„é‚£ä¸ªåƒ0å’Œ1é‡å çš„é¡µç å§ï¼Ÿä¸è¡Œï¼Œæˆ‘è¦æŠŠè¿™é¡µçš„æ‰€æœ‰å­—ç¬¦éƒ½æ‰“å°å‡ºæ¥çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    first_page = pdf.pages[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(first_page.chars):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å­—ç¬¦ <span class="subst">&#123;i&#125;</span>: æ–‡æœ¬=&#x27;<span class="subst">&#123;char[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&#x27;, ä½ç½®=(x0=<span class="subst">&#123;char[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, y0=<span class="subst">&#123;char[<span class="string">&#x27;y0&#x27;</span>]&#125;</span>, x1=<span class="subst">&#123;char[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, y1=<span class="subst">&#123;char[<span class="string">&#x27;y1&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦ 0: æ–‡æœ¬=<span class="string">&#x27;1&#x27;</span>, ä½ç½®=(x0=303.75000763, y0=36.00299858999995, x1=308.25000763, y1=45.00299858999995)</span><br><span class="line">å­—ç¬¦ 1: æ–‡æœ¬=<span class="string">&#x27;0&#x27;</span>, ä½ç½®=(x0=303.75, y0=36.00299858999995, x1=308.25, y1=45.00299858999995)</span><br><span class="line">å­—ç¬¦ 2: æ–‡æœ¬=<span class="string">&#x27;æ­&#x27;</span>, ä½ç½®=(x0=113.23200226, y0=606.64799768, x1=137.23200226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 3: æ–‡æœ¬=<span class="string">&#x27;å·&#x27;</span>, ä½ç½®=(x0=137.32800226, y0=606.64799768, x1=161.32800226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 4: æ–‡æœ¬=<span class="string">&#x27;å¸‚&#x27;</span>, ä½ç½®=(x0=161.42400226, y0=606.64799768, x1=185.42400226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 5: æ–‡æœ¬=<span class="string">&#x27;æˆ¿&#x27;</span>, ä½ç½®=(x0=185.52000226, y0=606.64799768, x1=209.52000226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 6: æ–‡æœ¬=<span class="string">&#x27;å±‹&#x27;</span>, ä½ç½®=(x0=209.61600226000002, y0=606.64799768, x1=233.61600226000002, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 7: æ–‡æœ¬=<span class="string">&#x27;å»º&#x27;</span>, ä½ç½®=(x0=233.71200226000002, y0=606.64799768, x1=257.71200226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 8: æ–‡æœ¬=<span class="string">&#x27;ç­‘&#x27;</span>, ä½ç½®=(x0=257.80800226, y0=606.64799768, x1=281.80800226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 9: æ–‡æœ¬=<span class="string">&#x27;å’Œ&#x27;</span>, ä½ç½®=(x0=281.90400226, y0=606.64799768, x1=305.90400226, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 10: æ–‡æœ¬=<span class="string">&#x27;å¸‚&#x27;</span>, ä½ç½®=(x0=306.00000226000003, y0=606.64799768, x1=330.00000226000003, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 11: æ–‡æœ¬=<span class="string">&#x27;æ”¿&#x27;</span>, ä½ç½®=(x0=330.09600226000003, y0=606.64799768, x1=354.09600226000003, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 12: æ–‡æœ¬=<span class="string">&#x27;åŸº&#x27;</span>, ä½ç½®=(x0=354.19200226000004, y0=606.64799768, x1=378.19200226000004, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 13: æ–‡æœ¬=<span class="string">&#x27;ç¡€&#x27;</span>, ä½ç½®=(x0=378.28800226000004, y0=606.64799768, x1=402.28800226000004, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 14: æ–‡æœ¬=<span class="string">&#x27;è®¾&#x27;</span>, ä½ç½®=(x0=402.38400226000005, y0=606.64799768, x1=426.38400226000005, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 15: æ–‡æœ¬=<span class="string">&#x27;æ–½&#x27;</span>, ä½ç½®=(x0=426.48000226000005, y0=606.64799768, x1=450.48000226000005, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 16: æ–‡æœ¬=<span class="string">&#x27;é¡¹&#x27;</span>, ä½ç½®=(x0=450.57600226000005, y0=606.64799768, x1=474.57600226000005, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 17: æ–‡æœ¬=<span class="string">&#x27;ç›®&#x27;</span>, ä½ç½®=(x0=474.67200226000006, y0=606.64799768, x1=498.67200226000006, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 18: æ–‡æœ¬=<span class="string">&#x27; &#x27;</span>, ä½ç½®=(x0=498.76800226000006, y0=606.64799768, x1=510.76800226000006, y1=630.64799768)</span><br><span class="line">å­—ç¬¦ 19: æ–‡æœ¬=<span class="string">&#x27;è®¾&#x27;</span>, ä½ç½®=(x0=185.51999665, y0=544.39799768, x1=209.51999665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 20: æ–‡æœ¬=<span class="string">&#x27;è®¡&#x27;</span>, ä½ç½®=(x0=209.61599665, y0=544.39799768, x1=233.61599665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 21: æ–‡æœ¬=<span class="string">&#x27;æ‹›&#x27;</span>, ä½ç½®=(x0=233.71199665, y0=544.39799768, x1=257.71199665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 22: æ–‡æœ¬=<span class="string">&#x27;æ ‡&#x27;</span>, ä½ç½®=(x0=257.80799665, y0=544.39799768, x1=281.80799665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 23: æ–‡æœ¬=<span class="string">&#x27;æ–‡&#x27;</span>, ä½ç½®=(x0=281.90399665, y0=544.39799768, x1=305.90399665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 24: æ–‡æœ¬=<span class="string">&#x27;ä»¶&#x27;</span>, ä½ç½®=(x0=305.99999665, y0=544.39799768, x1=329.99999665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 25: æ–‡æœ¬=<span class="string">&#x27;ç¤º&#x27;</span>, ä½ç½®=(x0=330.09599665, y0=544.39799768, x1=354.09599665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 26: æ–‡æœ¬=<span class="string">&#x27;èŒƒ&#x27;</span>, ä½ç½®=(x0=354.19199665, y0=544.39799768, x1=378.19199665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 27: æ–‡æœ¬=<span class="string">&#x27;æ–‡&#x27;</span>, ä½ç½®=(x0=378.28799665, y0=544.39799768, x1=402.28799665, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 28: æ–‡æœ¬=<span class="string">&#x27;æœ¬&#x27;</span>, ä½ç½®=(x0=402.38399665000003, y0=544.39799768, x1=426.38399665000003, y1=568.39799768)</span><br><span class="line">å­—ç¬¦ 29: æ–‡æœ¬=<span class="string">&#x27;ï¼ˆ&#x27;</span>, ä½ç½®=(x0=251.78400421999999, y0=496.86800394999995, x1=269.78400422, y1=514.86800395)</span><br><span class="line">å­—ç¬¦ 30: æ–‡æœ¬=<span class="string">&#x27;èµ„&#x27;</span>, ä½ç½®=(x0=269.85600422, y0=496.86800394999995, x1=287.85600422, y1=514.86800395)</span><br><span class="line">å­—ç¬¦ 31: æ–‡æœ¬=<span class="string">&#x27;æ ¼&#x27;</span>, ä½ç½®=(x0=287.92800422, y0=496.86800394999995, x1=305.92800422, y1=514.86800395)</span><br><span class="line">å­—ç¬¦ 32: æ–‡æœ¬=<span class="string">&#x27;å&#x27;</span>, ä½ç½®=(x0=306.00000422, y0=496.86800394999995, x1=324.00000422, y1=514.86800395)</span><br><span class="line">å­—ç¬¦ 33: æ–‡æœ¬=<span class="string">&#x27;å®¡&#x27;</span>, ä½ç½®=(x0=324.07200422, y0=496.86800394999995, x1=342.07200422, y1=514.86800395)</span><br><span class="line">å­—ç¬¦ 34: æ–‡æœ¬=<span class="string">&#x27;ï¼‰&#x27;</span>, ä½ç½®=(x0=342.14400422, y0=496.86800394999995, x1=360.14400422, y1=514.86800395)</span><br><span class="line">å­—ç¬¦ 35: æ–‡æœ¬=<span class="string">&#x27;ï¼ˆ&#x27;</span>, ä½ç½®=(x0=251.71199799, y0=453.12900554, x1=269.71199799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 36: æ–‡æœ¬=<span class="string">&#x27;2&#x27;</span>, ä½ç½®=(x0=269.78399799, y0=453.12900554, x1=278.78399799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 37: æ–‡æœ¬=<span class="string">&#x27;0&#x27;</span>, ä½ç½®=(x0=278.85599799, y0=453.12900554, x1=287.85599799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 38: æ–‡æœ¬=<span class="string">&#x27;1&#x27;</span>, ä½ç½®=(x0=287.92799799, y0=453.12900554, x1=296.92799799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 39: æ–‡æœ¬=<span class="string">&#x27;9&#x27;</span>, ä½ç½®=(x0=296.99999799, y0=453.12900554, x1=305.99999799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 40: æ–‡æœ¬=<span class="string">&#x27;å¹´&#x27;</span>, ä½ç½®=(x0=306.07199799, y0=453.12900554, x1=324.07199799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 41: æ–‡æœ¬=<span class="string">&#x27;ç‰ˆ&#x27;</span>, ä½ç½®=(x0=324.14399799, y0=453.12900554, x1=342.14399799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 42: æ–‡æœ¬=<span class="string">&#x27;ï¼‰&#x27;</span>, ä½ç½®=(x0=342.21599799, y0=453.12900554, x1=360.21599799, y1=471.12900554)</span><br><span class="line">å­—ç¬¦ 43: æ–‡æœ¬=<span class="string">&#x27;æ­&#x27;</span>, ä½ç½®=(x0=206.60399628, y0=149.65998087999998, x1=224.60399628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 44: æ–‡æœ¬=<span class="string">&#x27;å·&#x27;</span>, ä½ç½®=(x0=224.67599628, y0=149.65998087999998, x1=242.67599628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 45: æ–‡æœ¬=<span class="string">&#x27;å¸‚&#x27;</span>, ä½ç½®=(x0=242.74799628, y0=149.65998087999998, x1=260.74799628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 46: æ–‡æœ¬=<span class="string">&#x27;åŸ&#x27;</span>, ä½ç½®=(x0=260.81999628, y0=149.65998087999998, x1=278.81999628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 47: æ–‡æœ¬=<span class="string">&#x27;ä¹¡&#x27;</span>, ä½ç½®=(x0=278.89199628, y0=149.65998087999998, x1=296.89199628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 48: æ–‡æœ¬=<span class="string">&#x27;å»º&#x27;</span>, ä½ç½®=(x0=296.96399628, y0=149.65998087999998, x1=314.96399628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 49: æ–‡æœ¬=<span class="string">&#x27;è®¾&#x27;</span>, ä½ç½®=(x0=315.03599628, y0=149.65998087999998, x1=333.03599628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 50: æ–‡æœ¬=<span class="string">&#x27;å§”&#x27;</span>, ä½ç½®=(x0=333.10799628, y0=149.65998087999998, x1=351.10799628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 51: æ–‡æœ¬=<span class="string">&#x27;å‘˜&#x27;</span>, ä½ç½®=(x0=351.17999628, y0=149.65998087999998, x1=369.17999628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 52: æ–‡æœ¬=<span class="string">&#x27;ä¼š&#x27;</span>, ä½ç½®=(x0=369.25199628, y0=149.65998087999998, x1=387.25199628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 53: æ–‡æœ¬=<span class="string">&#x27;åˆ¶&#x27;</span>, ä½ç½®=(x0=387.32399628, y0=149.65998087999998, x1=405.32399628, y1=167.65998087999998)</span><br><span class="line">å­—ç¬¦ 54: æ–‡æœ¬=<span class="string">&#x27;äºŒ&#x27;</span>, ä½ç½®=(x0=247.24800873, y0=126.31598674000004, x1=265.24800873000004, y1=144.31598674000003)</span><br><span class="line">å­—ç¬¦ 55: æ–‡æœ¬=<span class="string">&#x27;0&#x27;</span>, ä½ç½®=(x0=265.32000873, y0=126.31598674000004, x1=274.32000873, y1=144.31598674000003)</span><br><span class="line">å­—ç¬¦ 56: æ–‡æœ¬=<span class="string">&#x27;äºŒ&#x27;</span>, ä½ç½®=(x0=274.39200873, y0=126.31598674000004, x1=292.39200873, y1=144.31598674000003)</span><br><span class="line">å­—ç¬¦ 57: æ–‡æœ¬=<span class="string">&#x27;äº”&#x27;</span>, ä½ç½®=(x0=292.46400873, y0=126.31598674000004, x1=310.46400873, y1=144.31598674000003)</span><br><span class="line">å­—ç¬¦ 58: æ–‡æœ¬=<span class="string">&#x27;å¹´&#x27;</span>, ä½ç½®=(x0=310.53600873, y0=126.31598674000004, x1=328.53600873, y1=144.31598674000003)</span><br><span class="line">å­—ç¬¦ 59: æ–‡æœ¬=<span class="string">&#x27;å››&#x27;</span>, ä½ç½®=(x0=328.60800873000005, y0=126.31598674000004, x1=346.60800873000005, y1=144.31598674000003)</span><br><span class="line">å­—ç¬¦ 60: æ–‡æœ¬=<span class="string">&#x27;æœˆ&#x27;</span>, ä½ç½®=(x0=346.68000873000005, y0=126.31598674000004, x1=364.68000873000005, y1=144.31598674000003)</span><br></pre></td></tr></table></figure>

<p>å¥½åƒç¡®å®æ˜¯é‚£ä¸ªé¡µç ï¼Œä½†ä¸ºä»€ä¹ˆæ˜¯å…ˆä»æœ€åè¯»å–å‘¢ï¼Œæœ‰äº›å¥‡æ€ªï¼Œä¸è¡Œï¼Œæˆ‘æƒ³å†ç¡®åˆ‡çš„ç¡®è®¤ä¸‹åˆ°åº•æ˜¯ä¸æ˜¯é¡µç ã€‚</p>
<hr>
<h3 id="äºŒ-im-draw-rect-â€¦"><a href="#äºŒ-im-draw-rect-â€¦" class="headerlink" title="äºŒ im.draw_rect(â€¦)"></a>äºŒ im.draw_rect(â€¦)</h3><table>
<thead>
<tr>
<th align="center">å•å¯¹è±¡æ–¹æ³•</th>
<th align="center">æ‰¹é‡æ–¹æ³•</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">im.draw_rect(<br />bbox_or_obj, <br />fill&#x3D;{color},<br /> stroke&#x3D;{color}, stroke_width&#x3D;1)</td>
<td align="center">im.draw_rects(list_of_rects, **kwargs)</td>
<td align="center">ä»çŸ©å½¢å¯¹è±¡ã€å­—ç¬¦å¯¹è±¡ç­‰ï¼Œæˆ–ä¸€ä¸ªå››å…ƒç»„å½¢å¼çš„è¾¹ç•Œæ¡†ä¸­ç»˜åˆ¶çŸ©å½¢ã€‚</td>
</tr>
</tbody></table>
<p>è§£é‡Šï¼š</p>
<ul>
<li><code>im.draw_rect(...)</code>ï¼šç»˜åˆ¶å•ä¸ªçŸ©å½¢ï¼Œå¯ä¼ å…¥ä¸€ä¸ªçŸ©å½¢å¯¹è±¡æˆ–å››å…ƒç»„è¾¹ç•Œæ¡†ã€‚</li>
<li><code>im.draw_rects(...)</code>ï¼šç»˜åˆ¶å¤šä¸ªçŸ©å½¢ï¼Œå‚æ•°ä¸ºçŸ©å½¢åˆ—è¡¨ã€‚å…¶ä»–ç»˜å›¾å‚æ•°å¯é€šè¿‡ <code>**kwargs</code> ä¼ å…¥ï¼Œä¾‹å¦‚å¡«å……é¢œè‰²ã€æè¾¹é¢œè‰²å’Œæè¾¹å®½åº¦ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    first_page = pdf.pages[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–é¡µé¢å›¾åƒ</span></span><br><span class="line">    im = first_page.to_image(resolution=<span class="number">150</span>)  <span class="comment"># åˆ†è¾¨ç‡ 150 DPI</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ‡è®°å‰ä¸¤ä¸ªå­—ç¬¦çš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> first_page.chars[<span class="number">0</span>:<span class="number">2</span>]:</span><br><span class="line">        x0, y0, x1, y1 = char[<span class="string">&#x27;x0&#x27;</span>], char[<span class="string">&#x27;top&#x27;</span>], char[<span class="string">&#x27;x1&#x27;</span>], char[<span class="string">&#x27;bottom&#x27;</span>]</span><br><span class="line">        im.draw_rect((x0, y0, x1, y1), fill=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">50</span>), stroke=<span class="string">&quot;red&quot;</span>, stroke_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ˜¾ç¤ºå›¾åƒ</span></span><br><span class="line">    im.show()</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">å˜é‡å</th>
<th align="center">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="center">fill</td>
<td align="center">å¡«å……è‰²</td>
</tr>
<tr>
<td align="center">stoke</td>
<td align="center">æ¡†æ¡†çš„é¢œè‰²</td>
</tr>
<tr>
<td align="center">stroke_width</td>
<td align="center">æ¡†æ¡†çš„å®½åº¦</td>
</tr>
</tbody></table>
<blockquote>
<p><code>fill=(255, 255, 0, 50)</code> è¡¨ç¤ºä¸€ç§å¸¦é€æ˜åº¦çš„å¡«å……é¢œè‰²ï¼Œå…·ä½“å«ä¹‰æ˜¯ï¼š</p>
<ul>
<li><code>(255, 255, 0)</code> æ˜¯ RGB é¢œè‰²å€¼ï¼Œå¯¹åº”çº¯é»„è‰²ï¼ˆçº¢255ï¼Œç»¿255ï¼Œè“0ï¼‰</li>
<li><code>50</code> æ˜¯ alpha é€šé“å€¼ï¼Œè¡¨ç¤ºé€æ˜åº¦ï¼ŒèŒƒå›´é€šå¸¸æ˜¯ 0~255ï¼Œ50 è¡¨ç¤ºæ¯”è¾ƒé€æ˜ï¼ˆçº¦ 20% ä¸é€æ˜ï¼‰</li>
</ul>
<p>æ‰€ä»¥è¿™æ˜¯ä¸€ç§åŠé€æ˜çš„é»„è‰²å¡«å……è‰²ï¼Œé¢œè‰²æ¯”è¾ƒæµ…ï¼Œå¸¦æœ‰ä¸€å®šé€æ˜æ•ˆæœã€‚</p>
</blockquote>
<p><strong>è¾“å‡ºï¼š</strong></p>


<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>0,1</code>ç¡®å®æ˜¯é¡µç ä½ç½®ã€‚</p>
<hr>
<p>å›å½’æ­£æ–‡ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¡¨æ ¼æ•°æ®ç”¨è¡¨æ ¼æå–çš„æ–¹å¼ï¼Œæ™®é€šæ–‡æœ¬ç”¨æ–‡æœ¬æå–çš„æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦å…ˆå•ç‹¬ä½“éªŒä¸‹æ–‡æœ¬æå–å’Œè¡¨æ ¼æå–çš„æ–¹æ³•ï¼Œå…ˆä»æ–‡æœ¬æå–å¼€å§‹å§ï¼š</p>
<h3 id="ä¸‰-æ–‡æœ¬æå–"><a href="#ä¸‰-æ–‡æœ¬æå–" class="headerlink" title="ä¸‰ æ–‡æœ¬æå–"></a>ä¸‰ æ–‡æœ¬æå–</h3><h4 id="1-Page-extract-text-â€¦"><a href="#1-Page-extract-text-â€¦" class="headerlink" title="1. Page.extract_text(â€¦)"></a>1. Page.extract_text(â€¦)</h4><table>
<thead>
<tr>
<th>æ–¹æ³•å</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>.extract_text(x_tolerance=3, x_tolerance_ratio=None, y_tolerance=3, layout=False, x_density=7.25, y_density=13, line_dir_render=None, char_dir_render=None, **kwargs)</code></td>
<td>å°†é¡µé¢ä¸Šçš„æ‰€æœ‰å­—ç¬¦å¯¹è±¡æ•´ç†ä¸ºä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²ã€‚<br><br><strong>å½“ <code>layout=False</code> æ—¶ï¼š</strong><br>è‹¥å‰ä¸€ä¸ªå­—ç¬¦çš„ <code>x1</code> ä¸ä¸‹ä¸€ä¸ªå­—ç¬¦çš„ <code>x0</code> ä¹‹é—´çš„å·®å€¼å¤§äº <code>x_tolerance</code>ï¼Œåˆ™æ’å…¥ç©ºæ ¼ã€‚ï¼ˆå¦‚æœè®¾ç½®äº† <code>x_tolerance_ratio</code>ï¼Œåˆ™ä½¿ç”¨åŠ¨æ€çš„ <code>x_tolerance</code>ï¼Œå…¶å€¼ä¸º <code>x_tolerance_ratio * ä¸Šä¸€ä¸ªå­—ç¬¦çš„ size</code>ã€‚ï¼‰è‹¥ä¸€ä¸ªå­—ç¬¦çš„ <code>doctop</code> ä¸ä¸‹ä¸€ä¸ªå­—ç¬¦çš„ <code>doctop</code> ä¹‹é—´çš„å·®å€¼å¤§äº <code>y_tolerance</code>ï¼Œåˆ™æ’å…¥æ¢è¡Œç¬¦ã€‚<br><br><strong>å½“ <code>layout=True</code> æ—¶ï¼ˆå®éªŒæ€§åŠŸèƒ½ï¼‰ï¼š</strong><br>å°è¯•æ¨¡æ‹Ÿ PDF é¡µé¢ä¸Šæ–‡æœ¬çš„ç»“æ„å¸ƒå±€ã€‚é€šè¿‡ <code>x_density</code> å’Œ <code>y_density</code> æ¥åˆ¤æ–­æ¯ä¸ª PDF åæ ‡ç‚¹ï¼ˆå•ä½ï¼‰ä¸Šè‡³å°‘åº”æœ‰çš„å­—ç¬¦æ•°æˆ–æ¢è¡Œæ•°ã€‚<br>ä½ å¯ä»¥ä¼ å…¥ <code>line_dir_render=&quot;ttb&quot;/&quot;btt&quot;/&quot;ltr&quot;/&quot;rtl&quot;</code> å’Œ&#x2F;æˆ– <code>char_dir_render=&quot;ttb&quot;/&quot;btt&quot;/&quot;ltr&quot;/&quot;rtl&quot;</code> æ¥æ”¹å˜é»˜è®¤çš„è¡Œæˆ–å­—ç¬¦è¾“å‡ºæ–¹å‘ï¼ˆä¾‹å¦‚ï¼šä»ä¸Šåˆ°ä¸‹ã€ä»å³åˆ°å·¦ç­‰ï¼‰ã€‚<br>å…¶ä½™æ‰€æœ‰çš„ <code>**kwargs</code> å‚æ•°éƒ½ä¼šä¼ é€’ç»™ <code>.extract_words(...)</code> æ–¹æ³•ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œè¯¥æ–¹æ³•æ˜¯è¿›è¡Œå¸ƒå±€è®¡ç®—çš„ç¬¬ä¸€æ­¥ã€‚</td>
</tr>
</tbody></table>
<blockquote>
<p><code>ttb</code>ï¼štop-to-bottomï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰</p>
<p><code>btt</code>ï¼šbottom-to-topï¼ˆä»ä¸‹åˆ°ä¸Šï¼‰</p>
<p><code>ltr</code>ï¼šleft-to-rightï¼ˆä»å·¦åˆ°å³ï¼‰</p>
<p><code>rtl</code>ï¼šright-to-leftï¼ˆä»å³åˆ°å·¦ï¼‰ã€‚</p>
</blockquote>
<p><strong>æ›´è¯¦ç»†çš„ä»‹ç»è¯·çœ‹é™„å½•1</strong>ï¼Œä½¿ç”¨<code>.extract_text</code>è¯»å–æ–‡ä»¶çš„å‰ä¸‰é¡µå¹¶æ‰“å°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢ä¸ºä½ çš„ PDF æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">pdf_path = <span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">3</span>, <span class="built_in">len</span>(pdf.pages))):  <span class="comment"># æœ€å¤šè¯»å–å‰ä¸‰é¡µ</span></span><br><span class="line">        page = pdf.pages[i]</span><br><span class="line">        text = page.extract_text(</span><br><span class="line">            x_tolerance=<span class="number">3</span>,</span><br><span class="line">            y_tolerance=<span class="number">3</span>,</span><br><span class="line">            layout=<span class="literal">False</span>  <span class="comment"># æˆ–è®¾ç½®ä¸º True ä»¥å°è¯•è¿˜åŸæ’ç‰ˆç»“æ„</span></span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;--- ç¬¬ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> é¡µ ---\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(text <span class="keyword">or</span> <span class="string">&quot;[è¯¥é¡µæ— å¯æå–æ–‡æœ¬]&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;-&quot;</span>*<span class="number">40</span> + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æˆ‘è§‰å¾—æœ‰å¿…è¦æŠŠç¬¬äºŒé¡µå’Œç¬¬ä¸‰é¡µä¹Ÿè´´å‡ºæ¥ï¼Œä¸ºäº†ä¸å ç”¨æ­£æ–‡ä½ç½®ï¼Œè´´åœ¨<strong>é™„å½•2</strong>äº†ï¼Œæœ‰ä¸¤ç‚¹éœ€è¦å…³æ³¨çš„ï¼š</p>
<ol>
<li>ç¬¬ä¸‰é¡µæ˜¯è¡¨æ ¼</li>
<li>é¡µç æœ‰é—®é¢˜ï¼ˆå‡ä»¥1æ‰“åº•ï¼Œçœ‹é™„å½•2ä½ å°±æ˜ç™½äº†ï¼‰</li>
</ol>
<p><strong>è¾“å‡ºï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">--- ç¬¬ 1 é¡µ ---</span><br><span class="line"></span><br><span class="line">æ­å·å¸‚æˆ¿å±‹å»ºç­‘å’Œå¸‚æ”¿åŸºç¡€è®¾æ–½é¡¹ç›®</span><br><span class="line">è®¾è®¡æ‹›æ ‡æ–‡ä»¶ç¤ºèŒƒæ–‡æœ¬</span><br><span class="line">ï¼ˆèµ„æ ¼åå®¡ï¼‰</span><br><span class="line">ï¼ˆ2019å¹´ç‰ˆï¼‰</span><br><span class="line">æ­å·å¸‚åŸä¹¡å»ºè®¾å§”å‘˜ä¼šåˆ¶</span><br><span class="line">äºŒ0äºŒäº”å¹´å››æœˆ</span><br><span class="line">01</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- ç¬¬ 2 é¡µ ---</span><br><span class="line"></span><br><span class="line">å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡</span><br><span class="line">ï¼ˆæ‹›æ ‡ç¼–å·ï¼šA3301080120526863001221ï¼‰</span><br><span class="line">æ‹›æ ‡æ–‡ä»¶</span><br><span class="line">ï¼ˆâ˜‘èµ„æ ¼åå®¡â–¡é‚€è¯·æ‹›æ ‡ï¼‰</span><br><span class="line">æ‹›æ ‡äººï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»ºè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸ ï¼ˆç›–å•ä½ç« ï¼‰</span><br><span class="line">æ‹›æ ‡ä»£ç†æœºæ„ï¼šæµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸ ï¼ˆç›–å•ä½ç« ï¼‰</span><br><span class="line">2025å¹´05æœˆ15æ—¥</span><br><span class="line">11</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- ç¬¬ 3 é¡µ ---</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒç«  æŠ•æ ‡äººé¡»çŸ¥</span><br><span class="line">æŠ•æ ‡äººé¡»çŸ¥å‰é™„è¡¨</span><br><span class="line">æ¡æ¬¾å· æ¡æ¬¾åç§° ç¼–åˆ—å†…å®¹</span><br><span class="line">åç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º</span><br><span class="line">è®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸</span><br><span class="line">åœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒºæµ¦æ²¿è¡—</span><br><span class="line">1.1.2 æ‹›æ ‡äºº</span><br><span class="line">é“æ»¨å®‰è·¯1338å·ä¸‰æ¥¼</span><br><span class="line">è”ç³»äººï¼šç¿æ è¶…</span><br><span class="line">ç”µè¯ï¼š13600511926</span><br><span class="line">åç§°ï¼š æµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸</span><br><span class="line">åœ°å€ï¼šæ­å·å¸‚ä¸ŠåŸåŒºä½°å¯Œæ—¶ä»£ä¸­å¿ƒ3å¹¢13æ¥¼</span><br><span class="line">1.1.3 æ‹›æ ‡ä»£ç†æœºæ„</span><br><span class="line">è”ç³»äººï¼šæ½˜æ­£é˜³ã€é™ˆç‘¶</span><br><span class="line">ç”µè¯ï¼š13758171369ã€18757567243</span><br><span class="line">å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡</span><br><span class="line">1.1.4 å·¥ç¨‹åç§°</span><br><span class="line">æ­å·å¸‚æ»¨æ±ŸåŒº</span><br><span class="line">1.1.5 å»ºè®¾åœ°ç‚¹</span><br><span class="line">è§æ‹›æ ‡å…¬å‘Š</span><br><span class="line">1.1.6 å»ºè®¾è§„æ¨¡</span><br><span class="line">æœ¬é¡¹ç›®æŠ•èµ„ä¼°ç®—ä¸º22798ä¸‡å…ƒ</span><br><span class="line">1.1.7 æŠ•èµ„ä¼°ç®—</span><br><span class="line">å›½æœ‰100%</span><br><span class="line">1.2.1 èµ„é‡‘æ¥æºåŠæ¯”ä¾‹</span><br><span class="line">å·²è½å®</span><br><span class="line">1.2.2 èµ„é‡‘è½å®æƒ…å†µ</span><br><span class="line">â˜‘æ–¹æ¡ˆè®¾è®¡ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—ç¼–åˆ¶å’Œè°ƒæ•´ï¼‰å’Œæ–½å·¥å›¾è®¾è®¡ï¼ˆâ˜‘BIMè®¾è®¡</span><br><span class="line">æœåŠ¡ï¼‰</span><br><span class="line">æ‹›æ ‡å†…å®¹å…·ä½“åŒ…æ‹¬:å·¥ç¨‹è®¾è®¡æœåŠ¡å†…å®¹ï¼š åŒ…æ‹¬ä½†ä¸é™äºï¼š</span><br><span class="line">ï¼ˆ1ï¼‰å¯ç ”ç¼–åˆ¶ï¼ˆå«ä¼°ç®—ç¼–åˆ¶ï¼‰ã€æ–¹æ¡ˆè®¾è®¡åŠæ·±åŒ–ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—</span><br><span class="line">ç¼–åˆ¶ï¼‰ã€æ–½å·¥å›¾è®¾è®¡ã€å«BIMï¼ˆè‹¥æœ‰ï¼‰ã€‘ã€ç®¡çº¿ç»¼åˆã€äº¤æ”¹è®¾è®¡ï¼ˆè‹¥</span><br><span class="line">æœ‰ï¼Œå«ä¸»ä½“é¡¹ç›®äº¤æ”¹ä»¥åŠå…¶ä»–é…å¥—äº¤æ”¹è®¾è®¡ï¼‰ã€é›¨æ±¡æ°´ç®¡çº¿è¿æ”¹ï¼ˆè‹¥</span><br><span class="line">æœ‰ï¼‰ã€åŸºå‘è®¾è®¡ã€æŠ¥æ‰¹å®¡æŸ¥é…åˆã€æŒ‰å®¡æŸ¥å’Œæ‹›æ ‡äººæ„è§å¯¹æ•´ä¸ªè®¾è®¡è¿‡ç¨‹</span><br><span class="line">çš„ä¿®æ”¹ã€æ·±åŒ–æ•´åˆç­‰ä¼˜åŒ–è®¾è®¡ï¼›</span><br><span class="line">1.3.1 æ‹›æ ‡èŒƒå›´</span><br><span class="line">ï¼ˆ2ï¼‰æŒ‰æ‹›æ ‡æ–‡ä»¶è¦æ±‚æä¾›çº¸è´¨å’Œç”µå­å›¾çº¸ï¼›</span><br><span class="line">ï¼ˆ3ï¼‰è®¾è®¡è¡¥å›¾å’Œå·¥ç¨‹æ–½å·¥é˜¶æ®µçš„å˜æ›´è”ç³»å•ï¼›</span><br><span class="line">ï¼ˆ4ï¼‰æ–½å·¥é…åˆã€éªŒæ”¶é…åˆã€ç«£å·¥å›¾ç¼–åˆ¶é…åˆç­‰ç›¸å…³æœåŠ¡ï¼›</span><br><span class="line">ï¼ˆ5ï¼‰æ ¹æ®å·¥ç¨‹å®é™…éœ€è¦æä¾›ç°åœºæœåŠ¡ç­‰ã€‚</span><br><span class="line">å„é˜¶æ®µè®¾è®¡æˆæœåº”ç¬¦åˆå›½å®¶è§„å®šçš„å›¾çº¸ç¼–åˆ¶æ·±åº¦è¦æ±‚åŠç›¸å…³å‡ºå›¾æ ‡å‡†è¦</span><br><span class="line">æ±‚ä¸”åº”æ»¡è¶³å‘åŒ…äººçš„ç›¸å…³è¦æ±‚ï¼Œå¹¶åº”åŠæ—¶å®Œæˆæ‹›æ ‡äººå’Œç›¸å…³å®¡æŸ¥éƒ¨é—¨çš„</span><br><span class="line">é˜¶æ®µæ€§å®¡æŸ¥æ„è§æ‰€æå‡ºçš„ä¿®æ”¹å·¥ä½œç­‰ï¼Œç‰¹åˆ«æ˜¯ç›¸å…³éƒ¨é—¨ä¸è®¡æ¬¡æ•°çš„ä¼˜åŒ–</span><br><span class="line">ä¿®æ”¹è¦æ±‚ç­‰ã€‚é˜¶æ®µæ€§å®¡æŸ¥åŒ…æ‹¬æ–¹æ¡ˆè¯„å®¡ã€åˆæ­¥è®¾è®¡å®¡æŸ¥å’Œæ–½å·¥å›¾å®¡æŸ¥</span><br><span class="line">12</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br></pre></td></tr></table></figure>

<blockquote>
<p>layout&#x3D;Trueçš„è´´åœ¨é™„å½•3äº†ï¼Œæ„Ÿè§‰ä¹Ÿæ²¡æœ‰æ ¼å¼ä¿¡æ¯ï¼ˆçŒ›åœ°ä¸€çœ‹åƒæ˜¯æœ‰æ ¼å¼ä¿¡æ¯ï¼‰ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼š</p>
<ol>
<li>æ¯é¡µçš„æœ€åæœ‰ä¸€ä¸ªæ•°å­—ï¼Œåˆ†åˆ«æ˜¯01,11,12ï¼Œä¸ºé¡µç </li>
<li>ç¬¬ä¸‰é¡µæ˜¯è¡¨æ ¼ï¼Œ<code>extract_text</code>ä¾æ—§ä¼šå°†å…¶å½“åšæ™®é€šæ–‡æœ¬æŒ‰è¡Œè¯»å–ï¼Œå³å¤±å»æ®µè½ç»“æ„äº†</li>
</ol>
<hr>
<h4 id="2-extract-words-â€¦"><a href="#2-extract-words-â€¦" class="headerlink" title="2. extract_words(â€¦)"></a>2. extract_words(â€¦)</h4><p>å…³äº<code>extract_words</code>å‚æ•°çš„è¯¦ç»†è®²è§£è§<strong>é™„å½•5</strong>ï¼Œ<strong>ä»£ç 1ï¼ˆåŸºç¡€ç”¨æ³•ï¼‰ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">3</span>, <span class="built_in">len</span>(pdf.pages))):  <span class="comment"># åªè§£æå‰ 3 é¡µï¼ˆæˆ–æ–‡ä»¶é¡µæ•°æ›´å°‘æ—¶è‡ªåŠ¨é€‚é…ï¼‰</span></span><br><span class="line">        page = pdf.pages[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n--- ç¬¬ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> é¡µ ---&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æå–å•è¯åˆ—è¡¨ï¼ˆé»˜è®¤å®¹å·®è®¾ç½®ï¼‰</span></span><br><span class="line">        words = page.extract_words()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰“å°å‰å‡ ä¸ªå•è¯çš„ä¿¡æ¯ï¼ˆå¤ªå¤šå¯ä»¥è£å‰ªï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words[:<span class="number">10</span>]:  <span class="comment"># æ¯é¡µå‰ 10 ä¸ªå•è¯</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;è¯ï¼š<span class="subst">&#123;word[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  â†ª åæ ‡ï¼š(<span class="subst">&#123;word[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>å¯ä»¥çœ‹å‡ºï¼Œextract_wordsç›¸å½“äºåœ¨extract_textçš„åŸºç¡€ä¸ŠåŠ ä¸Šåæ ‡è¾“å‡ºï¼ˆè™½ç„¶[ç¬¬äºŒç«  æŠ•æ ‡äººé¡»çŸ¥]è¢«åˆ†å¼€ä¸ºä¸¤ä»½äº†ï¼‰ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">--- ç¬¬ 1 é¡µ ---</span><br><span class="line">è¯ï¼šæ­å·å¸‚æˆ¿å±‹å»ºç­‘å’Œå¸‚æ”¿åŸºç¡€è®¾æ–½é¡¹ç›®</span><br><span class="line">  â†ª åæ ‡ï¼š(113.23200226, 161.35200232, 498.67200226000006, 185.35200232)</span><br><span class="line">è¯ï¼šè®¾è®¡æ‹›æ ‡æ–‡ä»¶ç¤ºèŒƒæ–‡æœ¬</span><br><span class="line">  â†ª åæ ‡ï¼š(185.51999665, 223.60200232, 426.38399665000003, 247.60200232)</span><br><span class="line">è¯ï¼šï¼ˆèµ„æ ¼åå®¡ï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(251.78400421999999, 277.13199605, 360.14400422, 295.13199605000005)</span><br><span class="line">è¯ï¼šï¼ˆ2019å¹´ç‰ˆï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(251.71199799, 320.87099446, 360.21599799, 338.87099446)</span><br><span class="line">è¯ï¼šæ­å·å¸‚åŸä¹¡å»ºè®¾å§”å‘˜ä¼šåˆ¶</span><br><span class="line">  â†ª åæ ‡ï¼š(206.60399628, 624.3400191200001, 405.32399628, 642.3400191200001)</span><br><span class="line">è¯ï¼šäºŒ0äºŒäº”å¹´å››æœˆ</span><br><span class="line">  â†ª åæ ‡ï¼š(247.24800873, 647.68401326, 364.68000873000005, 665.6840132599999)</span><br><span class="line">è¯ï¼š01</span><br><span class="line">  â†ª åæ ‡ï¼š(303.75, 746.99700141, 308.25000763, 755.99700141)</span><br><span class="line"></span><br><span class="line">--- ç¬¬ 2 é¡µ ---</span><br><span class="line">è¯ï¼šå¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡</span><br><span class="line">  â†ª åæ ‡ï¼š(204.31200457999998, 95.86200049000013, 394.0400045800001, 109.86200049000013)</span><br><span class="line">è¯ï¼šï¼ˆæ‹›æ ‡ç¼–å·ï¼šA3301080120526863001221ï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(188.40000153, 129.73200037000004, 445.9440015299999, 143.73200037000004)</span><br><span class="line">è¯ï¼šæ‹›æ ‡æ–‡ä»¶</span><br><span class="line">  â†ª åæ ‡ï¼š(253.97500458999997, 219.91299402000004, 357.97500458999997, 245.91299402000004)</span><br><span class="line">è¯ï¼šï¼ˆâ˜‘èµ„æ ¼åå®¡â–¡é‚€è¯·æ‹›æ ‡ï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(175.49999849, 259.70200610999996, 436.44199849, 284.12200611)</span><br><span class="line">è¯ï¼šæ‹›æ ‡äººï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»ºè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸</span><br><span class="line">  â†ª åæ ‡ï¼š(84.15000192, 524.49500181, 434.15000192, 538.49500181)</span><br><span class="line">è¯ï¼šï¼ˆç›–å•ä½ç« ï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(444.00600192, 524.49500181, 528.00600192, 538.49500181)</span><br><span class="line">è¯ï¼šæ‹›æ ‡ä»£ç†æœºæ„ï¼šæµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸</span><br><span class="line">  â†ª åæ ‡ï¼š(120.15000001, 551.7290106, 386.15000001, 565.7290106)</span><br><span class="line">è¯ï¼šï¼ˆç›–å•ä½ç« ï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(408.00400000999997, 551.7290106, 492.00400000999997, 565.7290106)</span><br><span class="line">è¯ï¼š2025å¹´05æœˆ15æ—¥</span><br><span class="line">  â†ª åæ ‡ï¼š(310.00000763, 602.28399088, 408.00000763, 616.28399088)</span><br><span class="line">è¯ï¼š11</span><br><span class="line">  â†ª åæ ‡ï¼š(303.75, 746.99700141, 308.25000763, 755.99700141)</span><br><span class="line"></span><br><span class="line">--- ç¬¬ 3 é¡µ ---</span><br><span class="line">è¯ï¼šç¬¬äºŒç« </span><br><span class="line">  â†ª åæ ‡ï¼š(228.69999695, 92.72899985999993, 294.87599695, 114.72899985999993)</span><br><span class="line">è¯ï¼šæŠ•æ ‡äººé¡»çŸ¥</span><br><span class="line">  â†ª åæ ‡ï¼š(306.05199695, 92.72899985999993, 416.40399694999996, 114.72899985999993)</span><br><span class="line">è¯ï¼šæŠ•æ ‡äººé¡»çŸ¥å‰é™„è¡¨</span><br><span class="line">  â†ª åæ ‡ï¼š(238.89399719, 126.88100191000001, 367.34199719, 142.88100191)</span><br><span class="line">è¯ï¼šæ¡æ¬¾å·</span><br><span class="line">  â†ª åæ ‡ï¼š(64.62499905, 171.73550296999997, 96.20899905, 182.23550296999997)</span><br><span class="line">è¯ï¼šæ¡æ¬¾åç§°</span><br><span class="line">  â†ª åæ ‡ï¼š(147.31599999, 171.73550296999997, 189.44199999, 182.23550296999997)</span><br><span class="line">è¯ï¼šç¼–åˆ—å†…å®¹</span><br><span class="line">  â†ª åæ ‡ï¼š(358.14099653999995, 171.73550296999997, 400.2669965399999, 182.23550296999997)</span><br><span class="line">è¯ï¼šåç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º</span><br><span class="line">  â†ª åæ ‡ï¼š(219.87500239, 193.33550335999996, 377.37500238999996, 203.83550335999996)</span><br><span class="line">è¯ï¼šè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸</span><br><span class="line">  â†ª åæ ‡ï¼š(219.87500239, 208.93550374000006, 314.37500238999996, 219.43550374000006)</span><br><span class="line">è¯ï¼šåœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒºæµ¦æ²¿è¡—</span><br><span class="line">  â†ª åæ ‡ï¼š(220.02200238999998, 230.03550411999993, 377.52200239, 240.53550411999993)</span><br><span class="line">è¯ï¼š1.1.2</span><br><span class="line">  â†ª åæ ‡ï¼š(73.75, 236.08550145000004, 100.0, 246.58550145000004)</span><br></pre></td></tr></table></figure>

<p><strong>ä»£ç äºŒï¼ˆæŒ‡å®šreturn_chars&#x3D;Trueï¼‰</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">3</span>, <span class="built_in">len</span>(pdf.pages))):  <span class="comment"># åªè§£æå‰ 3 é¡µï¼ˆæˆ–æ–‡ä»¶é¡µæ•°æ›´å°‘æ—¶è‡ªåŠ¨é€‚é…ï¼‰</span></span><br><span class="line">        page = pdf.pages[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n--- ç¬¬ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> é¡µ ---&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æå–å•è¯åˆ—è¡¨ï¼Œå¹¶åŒ…å«ç»„æˆæ¯ä¸ªå•è¯çš„å­—ç¬¦è¯¦æƒ…</span></span><br><span class="line">        words = page.extract_words(return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰“å°å‰å‡ ä¸ªå•è¯çš„ä¿¡æ¯ï¼ˆå¤ªå¤šå¯ä»¥è£å‰ªï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words[:<span class="number">10</span>]:  <span class="comment"># æ¯é¡µå‰ 10 ä¸ªå•è¯</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;è¯ï¼š<span class="subst">&#123;word[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  â†ª åæ ‡ï¼š(<span class="subst">&#123;word[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;  â†ª å­—ç¬¦ç»„æˆï¼š&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> word[<span class="string">&quot;chars&quot;</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    - å­—ç¬¦ï¼š<span class="subst">&#123;char[<span class="string">&#x27;text&#x27;</span>]&#125;</span>, åæ ‡ï¼š(<span class="subst">&#123;char[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>), å­—ä½“ï¼š<span class="subst">&#123;char.get(<span class="string">&#x27;fontname&#x27;</span>)&#125;</span>, å¤§å°ï¼š<span class="subst">&#123;char.get(<span class="string">&#x27;size&#x27;</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>å†…å®¹å¤ªé•¿ï¼Œè¿™é‡Œä»…å±•ç¤ºç¬¬ä¸€é¡µï¼Œå¯ä»¥çœ‹å‡ºæŒ‡å®šreturn_chars&#x3D;Trueåå°±ç›¸å½“äºåœ¨ä¸æŒ‡å®šçš„åŸºç¡€ä¸ŠåŠ ä¸Š.charsæ–¹æ³•ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"> --- ç¬¬ 1 é¡µ ---</span><br><span class="line">è¯ï¼šæ­å·å¸‚æˆ¿å±‹å»ºç­‘å’Œå¸‚æ”¿åŸºç¡€è®¾æ–½é¡¹ç›®</span><br><span class="line">  â†ª åæ ‡ï¼š(113.23200226, 161.35200232, 498.67200226000006, 185.35200232)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼šæ­, åæ ‡ï¼š(113.23200226, 161.35200232, 137.23200226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šå·, åæ ‡ï¼š(137.32800226, 161.35200232, 161.32800226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šå¸‚, åæ ‡ï¼š(161.42400226, 161.35200232, 185.42400226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæˆ¿, åæ ‡ï¼š(185.52000226, 161.35200232, 209.52000226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šå±‹, åæ ‡ï¼š(209.61600226000002, 161.35200232, 233.61600226000002, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šå»º, åæ ‡ï¼š(233.71200226000002, 161.35200232, 257.71200226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šç­‘, åæ ‡ï¼š(257.80800226, 161.35200232, 281.80800226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šå’Œ, åæ ‡ï¼š(281.90400226, 161.35200232, 305.90400226, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šå¸‚, åæ ‡ï¼š(306.00000226000003, 161.35200232, 330.00000226000003, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæ”¿, åæ ‡ï¼š(330.09600226000003, 161.35200232, 354.09600226000003, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šåŸº, åæ ‡ï¼š(354.19200226000004, 161.35200232, 378.19200226000004, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šç¡€, åæ ‡ï¼š(378.28800226000004, 161.35200232, 402.28800226000004, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šè®¾, åæ ‡ï¼š(402.38400226000005, 161.35200232, 426.38400226000005, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæ–½, åæ ‡ï¼š(426.48000226000005, 161.35200232, 450.48000226000005, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šé¡¹, åæ ‡ï¼š(450.57600226000005, 161.35200232, 474.57600226000005, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šç›®, åæ ‡ï¼š(474.67200226000006, 161.35200232, 498.67200226000006, 185.35200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">è¯ï¼šè®¾è®¡æ‹›æ ‡æ–‡ä»¶ç¤ºèŒƒæ–‡æœ¬</span><br><span class="line">  â†ª åæ ‡ï¼š(185.51999665, 223.60200232, 426.38399665000003, 247.60200232)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼šè®¾, åæ ‡ï¼š(185.51999665, 223.60200232, 209.51999665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šè®¡, åæ ‡ï¼š(209.61599665, 223.60200232, 233.61599665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæ‹›, åæ ‡ï¼š(233.71199665, 223.60200232, 257.71199665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæ ‡, åæ ‡ï¼š(257.80799665, 223.60200232, 281.80799665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæ–‡, åæ ‡ï¼š(281.90399665, 223.60200232, 305.90399665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šä»¶, åæ ‡ï¼š(305.99999665, 223.60200232, 329.99999665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šç¤º, åæ ‡ï¼š(330.09599665, 223.60200232, 354.09599665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šèŒƒ, åæ ‡ï¼š(354.19199665, 223.60200232, 378.19199665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæ–‡, åæ ‡ï¼š(378.28799665, 223.60200232, 402.28799665, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">    - å­—ç¬¦ï¼šæœ¬, åæ ‡ï¼š(402.38399665000003, 223.60200232, 426.38399665000003, 247.60200232), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š24.0</span><br><span class="line">è¯ï¼šï¼ˆèµ„æ ¼åå®¡ï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(251.78400421999999, 277.13199605, 360.14400422, 295.13199605000005)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼šï¼ˆ, åæ ‡ï¼š(251.78400421999999, 277.13199605, 269.78400422, 295.13199605000005), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.000000000000057</span><br><span class="line">    - å­—ç¬¦ï¼šèµ„, åæ ‡ï¼š(269.85600422, 277.13199605, 287.85600422, 295.13199605000005), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.000000000000057</span><br><span class="line">    - å­—ç¬¦ï¼šæ ¼, åæ ‡ï¼š(287.92800422, 277.13199605, 305.92800422, 295.13199605000005), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.000000000000057</span><br><span class="line">    - å­—ç¬¦ï¼šå, åæ ‡ï¼š(306.00000422, 277.13199605, 324.00000422, 295.13199605000005), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.000000000000057</span><br><span class="line">    - å­—ç¬¦ï¼šå®¡, åæ ‡ï¼š(324.07200422, 277.13199605, 342.07200422, 295.13199605000005), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.000000000000057</span><br><span class="line">    - å­—ç¬¦ï¼šï¼‰, åæ ‡ï¼š(342.14400422, 277.13199605, 360.14400422, 295.13199605000005), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.000000000000057</span><br><span class="line">è¯ï¼šï¼ˆ2019å¹´ç‰ˆï¼‰</span><br><span class="line">  â†ª åæ ‡ï¼š(251.71199799, 320.87099446, 360.21599799, 338.87099446)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼šï¼ˆ, åæ ‡ï¼š(251.71199799, 320.87099446, 269.71199799, 338.87099446), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼š2, åæ ‡ï¼š(269.78399799, 320.87099446, 278.78399799, 338.87099446), å­—ä½“ï¼šFAAABE+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼š0, åæ ‡ï¼š(278.85599799, 320.87099446, 287.85599799, 338.87099446), å­—ä½“ï¼šFAAABE+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼š1, åæ ‡ï¼š(287.92799799, 320.87099446, 296.92799799, 338.87099446), å­—ä½“ï¼šFAAABE+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼š9, åæ ‡ï¼š(296.99999799, 320.87099446, 305.99999799, 338.87099446), å­—ä½“ï¼šFAAABE+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šå¹´, åæ ‡ï¼š(306.07199799, 320.87099446, 324.07199799, 338.87099446), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šç‰ˆ, åæ ‡ï¼š(324.14399799, 320.87099446, 342.14399799, 338.87099446), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šï¼‰, åæ ‡ï¼š(342.21599799, 320.87099446, 360.21599799, 338.87099446), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">è¯ï¼šæ­å·å¸‚åŸä¹¡å»ºè®¾å§”å‘˜ä¼šåˆ¶</span><br><span class="line">  â†ª åæ ‡ï¼š(206.60399628, 624.3400191200001, 405.32399628, 642.3400191200001)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼šæ­, åæ ‡ï¼š(206.60399628, 624.3400191200001, 224.60399628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šå·, åæ ‡ï¼š(224.67599628, 624.3400191200001, 242.67599628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šå¸‚, åæ ‡ï¼š(242.74799628, 624.3400191200001, 260.74799628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šåŸ, åæ ‡ï¼š(260.81999628, 624.3400191200001, 278.81999628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šä¹¡, åæ ‡ï¼š(278.89199628, 624.3400191200001, 296.89199628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šå»º, åæ ‡ï¼š(296.96399628, 624.3400191200001, 314.96399628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šè®¾, åæ ‡ï¼š(315.03599628, 624.3400191200001, 333.03599628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šå§”, åæ ‡ï¼š(333.10799628, 624.3400191200001, 351.10799628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šå‘˜, åæ ‡ï¼š(351.17999628, 624.3400191200001, 369.17999628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šä¼š, åæ ‡ï¼š(369.25199628, 624.3400191200001, 387.25199628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">    - å­—ç¬¦ï¼šåˆ¶, åæ ‡ï¼š(387.32399628, 624.3400191200001, 405.32399628, 642.3400191200001), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š18.0</span><br><span class="line">è¯ï¼šäºŒ0äºŒäº”å¹´å››æœˆ</span><br><span class="line">  â†ª åæ ‡ï¼š(247.24800873, 647.68401326, 364.68000873000005, 665.6840132599999)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼šäºŒ, åæ ‡ï¼š(247.24800873, 647.68401326, 265.24800873000004, 665.6840132599999), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">    - å­—ç¬¦ï¼š0, åæ ‡ï¼š(265.32000873, 647.68401326, 274.32000873, 665.6840132599999), å­—ä½“ï¼šFAAABE+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">    - å­—ç¬¦ï¼šäºŒ, åæ ‡ï¼š(274.39200873, 647.68401326, 292.39200873, 665.6840132599999), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">    - å­—ç¬¦ï¼šäº”, åæ ‡ï¼š(292.46400873, 647.68401326, 310.46400873, 665.6840132599999), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">    - å­—ç¬¦ï¼šå¹´, åæ ‡ï¼š(310.53600873, 647.68401326, 328.53600873, 665.6840132599999), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">    - å­—ç¬¦ï¼šå››, åæ ‡ï¼š(328.60800873000005, 647.68401326, 346.60800873000005, 665.6840132599999), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">    - å­—ç¬¦ï¼šæœˆ, åæ ‡ï¼š(346.68000873000005, 647.68401326, 364.68000873000005, 665.6840132599999), å­—ä½“ï¼šFAAABA+SimSun,Bold, å¤§å°ï¼š17.999999999999986</span><br><span class="line">è¯ï¼š01</span><br><span class="line">  â†ª åæ ‡ï¼š(303.75, 746.99700141, 308.25000763, 755.99700141)</span><br><span class="line">  â†ª å­—ç¬¦ç»„æˆï¼š</span><br><span class="line">    - å­—ç¬¦ï¼š0, åæ ‡ï¼š(303.75, 746.99700141, 308.25, 755.99700141), å­—ä½“ï¼šFAAAAH+TimesNewRomanPSMT, å¤§å°ï¼š9.0</span><br><span class="line">    - å­—ç¬¦ï¼š1, åæ ‡ï¼š(303.75000763, 746.99700141, 308.25000763, 755.99700141), å­—ä½“ï¼šFAAAAH+TimesNewRomanPSMT, å¤§å°ï¼š9.0</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="3-extract-text-lines-â€¦"><a href="#3-extract-text-lines-â€¦" class="headerlink" title="3. extract_text_lines(â€¦)"></a>3. extract_text_lines(â€¦)</h4><p>é‚£å¦‚æœä¸æƒ³ä½¿ç”¨<code>extract_words</code>è¿™ç§ç»†ç²’åº¦çš„æ–¹æ³•ï¼Œåªæƒ³æŒ‰è¡Œå»æå–æ–‡æœ¬æ€ä¹ˆåŠå‘¢ï¼Œå¯ä»¥ç”¨<code>extract_text_lines</code>æ–¹æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">2</span>]  <span class="comment"># è¯»å–ç¬¬1é¡µ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–æ–‡æœ¬è¡Œï¼ˆå®éªŒåŠŸèƒ½ï¼‰</span></span><br><span class="line">    lines = page.extract_text_lines(return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å°å‰å‡ è¡Œçš„å†…å®¹å’Œä½ç½®</span></span><br><span class="line">    <span class="keyword">for</span> i, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(lines[:<span class="number">5</span>]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ”¹ ç¬¬ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> è¡Œï¼š<span class="subst">&#123;line[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   â¤ è¾¹ç•Œæ¡†ï¼š(<span class="subst">&#123;line[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;line[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;line[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;line[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   â¤ å­—ç¬¦æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(line[<span class="string">&#x27;chars&#x27;</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> line[<span class="string">&#x27;chars&#x27;</span>][:<span class="number">3</span>]:  <span class="comment"># æ˜¾ç¤ºå‰ä¸‰ä¸ªå­—ç¬¦</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;     - å­—ç¬¦ï¼š<span class="subst">&#123;char[<span class="string">&#x27;text&#x27;</span>]&#125;</span>ï¼Œä½ç½®ï¼š(<span class="subst">&#123;char[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;top&#x27;</span>]&#125;</span>ï¼Œ<span class="subst">&#123;char[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">ğŸ”¹ ç¬¬ 1 è¡Œï¼šç¬¬äºŒç«  æŠ•æ ‡äººé¡»çŸ¥</span><br><span class="line">   â¤ è¾¹ç•Œæ¡†ï¼š(228.69999695, 92.72899985999993, 416.40399694999996, 114.72899985999993)</span><br><span class="line">   â¤ å­—ç¬¦æ•°ï¼š8</span><br><span class="line">     - å­—ç¬¦ï¼šç¬¬ï¼Œä½ç½®ï¼š(228.69999695, 92.72899985999993ï¼Œ250.69999695, 114.72899985999993)</span><br><span class="line">     - å­—ç¬¦ï¼šäºŒï¼Œä½ç½®ï¼š(250.78799695, 92.72899985999993ï¼Œ272.78799695, 114.72899985999993)</span><br><span class="line">     - å­—ç¬¦ï¼šç« ï¼Œä½ç½®ï¼š(272.87599695, 92.72899985999993ï¼Œ294.87599695, 114.72899985999993)</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 2 è¡Œï¼šæŠ•æ ‡äººé¡»çŸ¥å‰é™„è¡¨</span><br><span class="line">   â¤ è¾¹ç•Œæ¡†ï¼š(238.89399719, 126.88100191000001, 367.34199719, 142.88100191)</span><br><span class="line">   â¤ å­—ç¬¦æ•°ï¼š8</span><br><span class="line">     - å­—ç¬¦ï¼šæŠ•ï¼Œä½ç½®ï¼š(238.89399719, 126.88100191000001ï¼Œ254.89399719, 142.88100191)</span><br><span class="line">     - å­—ç¬¦ï¼šæ ‡ï¼Œä½ç½®ï¼š(254.95799719, 126.88100191000001ï¼Œ270.95799719, 142.88100191)</span><br><span class="line">     - å­—ç¬¦ï¼šäººï¼Œä½ç½®ï¼š(271.02199719, 126.88100191000001ï¼Œ287.02199719, 142.88100191)</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 3 è¡Œï¼šæ¡æ¬¾å· æ¡æ¬¾åç§° ç¼–åˆ—å†…å®¹</span><br><span class="line">   â¤ è¾¹ç•Œæ¡†ï¼š(64.62499905, 171.73550296999997, 400.2669965399999, 182.23550296999997)</span><br><span class="line">   â¤ å­—ç¬¦æ•°ï¼š11</span><br><span class="line">     - å­—ç¬¦ï¼šæ¡ï¼Œä½ç½®ï¼š(64.62499905, 171.73550296999997ï¼Œ75.12499905, 182.23550296999997)</span><br><span class="line">     - å­—ç¬¦ï¼šæ¬¾ï¼Œä½ç½®ï¼š(75.16699905, 171.73550296999997ï¼Œ85.66699905, 182.23550296999997)</span><br><span class="line">     - å­—ç¬¦ï¼šå·ï¼Œä½ç½®ï¼š(85.70899905, 171.73550296999997ï¼Œ96.20899905, 182.23550296999997)</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 4 è¡Œï¼šåç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º</span><br><span class="line">   â¤ è¾¹ç•Œæ¡†ï¼š(219.87500239, 193.33550335999996, 377.37500238999996, 203.83550335999996)</span><br><span class="line">   â¤ å­—ç¬¦æ•°ï¼š15</span><br><span class="line">     - å­—ç¬¦ï¼šåï¼Œä½ç½®ï¼š(219.87500239, 193.33550335999996ï¼Œ230.37500239, 203.83550335999996)</span><br><span class="line">     - å­—ç¬¦ï¼šç§°ï¼Œä½ç½®ï¼š(230.37500239, 193.33550335999996ï¼Œ240.87500239, 203.83550335999996)</span><br><span class="line">     - å­—ç¬¦ï¼šï¼šï¼Œä½ç½®ï¼š(240.87500239, 193.33550335999996ï¼Œ251.37500239, 203.83550335999996)</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 5 è¡Œï¼šè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸</span><br><span class="line">   â¤ è¾¹ç•Œæ¡†ï¼š(219.87500239, 208.93550374000006, 314.37500238999996, 219.43550374000006)</span><br><span class="line">   â¤ å­—ç¬¦æ•°ï¼š9</span><br><span class="line">     - å­—ç¬¦ï¼šè®¾ï¼Œä½ç½®ï¼š(219.87500239, 208.93550374000006ï¼Œ230.37500239, 219.43550374000006)</span><br><span class="line">     - å­—ç¬¦ï¼šè¿ï¼Œä½ç½®ï¼š(230.37500239, 208.93550374000006ï¼Œ240.87500239, 219.43550374000006)</span><br><span class="line">     - å­—ç¬¦ï¼šè¥ï¼Œä½ç½®ï¼š(240.87500239, 208.93550374000006ï¼Œ251.37500239, 219.43550374000006)</span><br></pre></td></tr></table></figure>

<p><strong>å…³äºextract_wordsä¸extract_text_linesçš„æ¯”è¾ƒè§é™„å½•6ã€‚</strong></p>
<hr>
<h4 id="4-search-â€¦"><a href="#4-search-â€¦" class="headerlink" title="4. search(â€¦)"></a>4. search(â€¦)</h4><p>é«˜äº®ç¬¬ä¸‰é¡µçš„<strong>æ‹›æ ‡äººï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æœç´¢å…³é”®è¯â€œæ‹›æ ‡äººâ€ï¼Œå¹¶åŒ…å«å­—ç¬¦å¯¹è±¡</span></span><br><span class="line">    matches = page.search(<span class="string">&quot;æ‹›æ ‡äºº&quot;</span>, return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆé¡µé¢å›¾åƒå¯¹è±¡</span></span><br><span class="line">    im = page.to_image(resolution=<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é«˜äº®æ¯ä¸€ä¸ªåŒ¹é…åˆ°çš„æ–‡æœ¬åŒºåŸŸ</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        bbox = (<span class="keyword">match</span>[<span class="string">&quot;x0&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;top&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;x1&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;bottom&quot;</span>])</span><br><span class="line">        im.draw_rect(bbox, stroke=<span class="string">&quot;red&quot;</span>, stroke_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å±•ç¤ºå›¾åƒ</span></span><br><span class="line">    im.show()</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="å››-è¡¨æ ¼æå–"><a href="#å››-è¡¨æ ¼æå–" class="headerlink" title="å›› è¡¨æ ¼æå–"></a>å›› è¡¨æ ¼æå–</h3><table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>.find_tables(table_settings=&#123;&#125;)</code></td>
<td>è¿”å›å¤šä¸ª <code>Table</code> å¯¹è±¡ã€‚<code>Table</code> å¯¹è±¡æä¾› <code>.cells</code>, <code>.rows</code>, <code>.columns</code>, <code>.bbox</code> å±æ€§ä»¥åŠ <code>.extract(x_tolerance=3, y_tolerance=3)</code> æ–¹æ³•ã€‚</td>
</tr>
<tr>
<td><code>.find_table(table_settings=&#123;&#125;)</code></td>
<td>ç±»ä¼¼äº <code>.find_tables(...)</code>ï¼Œä½†åªè¿”å›é¡µé¢ä¸­<strong>æœ€å¤§çš„è¡¨æ ¼</strong>ï¼ˆæŒ‰å•å…ƒæ ¼æ•°é‡è¡¡é‡ï¼‰ã€‚å¦‚æœå¤šä¸ªè¡¨æ ¼å¤§å°ç›¸åŒï¼Œåˆ™è¿”å›ç¦»é¡µé¢é¡¶éƒ¨æœ€è¿‘çš„ä¸€ä¸ªã€‚</td>
</tr>
<tr>
<td><code>.extract_tables(table_settings=&#123;&#125;)</code></td>
<td>è¿”å›é¡µé¢ä¸­æ‰€æœ‰è¡¨æ ¼çš„æ–‡æœ¬å†…å®¹ï¼Œæ ¼å¼ä¸ºåˆ—è¡¨åµŒå¥—åˆ—è¡¨åµŒå¥—åˆ—è¡¨ï¼š<code>è¡¨æ ¼ -&gt; è¡Œ -&gt; å•å…ƒæ ¼</code>ã€‚</td>
</tr>
<tr>
<td><code>.extract_table(table_settings=&#123;&#125;)</code></td>
<td>è¿”å›é¡µé¢ä¸­æœ€å¤§è¡¨æ ¼çš„æ–‡æœ¬å†…å®¹ï¼Œæ ¼å¼ä¸ºï¼š<code>è¡Œ -&gt; å•å…ƒæ ¼</code>ã€‚</td>
</tr>
<tr>
<td><code>.debug_tablefinder(table_settings=&#123;&#125;)</code></td>
<td>è¿”å› <code>TableFinder</code> ç±»å®ä¾‹ï¼Œå¯è®¿é—® <code>.edges</code>, <code>.intersections</code>, <code>.cells</code>, <code>.tables</code> å±æ€§ã€‚</td>
</tr>
</tbody></table>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>.extract_tables()</code> ä½¿ç”¨é¡µé¢çš„æ°´å¹³ä¸å‚ç›´çº¿ï¼ˆåŒ…æ‹¬çŸ©å½¢è¾¹ï¼‰ä½œä¸ºå•å…ƒæ ¼è¾¹ç•Œã€‚ä½†ä½ å¯ä»¥é€šè¿‡ <code>table_settings</code> è‡ªå®šä¹‰ç­–ç•¥å’Œé˜ˆå€¼ã€‚è¯¦ç»†ä»‹ç»è§é™„å½•4ã€‚</p>
</blockquote>
<h4 id="1-extract-tables-â€¦"><a href="#1-extract-tables-â€¦" class="headerlink" title="1. extract_tables(â€¦)"></a>1. extract_tables(â€¦)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="comment"># è®¾ç½®è¦æå–çš„é¡µç ï¼ˆæ³¨æ„ï¼špdfplumber çš„é¡µç ä» 0 å¼€å§‹ï¼‰</span></span><br><span class="line">    pages_to_extract = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>)) + <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">14</span>, <span class="number">17</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†é€‰ä¸­çš„é¡µé¢</span></span><br><span class="line">    <span class="keyword">for</span> page_number <span class="keyword">in</span> pages_to_extract:</span><br><span class="line">        page = pdf.pages[page_number]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ”¹ ç¬¬ <span class="subst">&#123;page_number + <span class="number">1</span>&#125;</span> é¡µçš„è¡¨æ ¼å†…å®¹ï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line">        tables = page.extract_tables()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœæœ‰è¡¨æ ¼</span></span><br><span class="line">        <span class="keyword">if</span> tables:</span><br><span class="line">            <span class="keyword">for</span> table_index, table <span class="keyword">in</span> <span class="built_in">enumerate</span>(tables):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n  â¤ è¡¨æ ¼ <span class="subst">&#123;table_index + <span class="number">1</span>&#125;</span>:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> row <span class="keyword">in</span> table:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;    &quot;</span>, row)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;  âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">ğŸ”¹ ç¬¬ 1 é¡µçš„è¡¨æ ¼å†…å®¹ï¼š</span><br><span class="line">  âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 2 é¡µçš„è¡¨æ ¼å†…å®¹ï¼š</span><br><span class="line">  âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 3 é¡µçš„è¡¨æ ¼å†…å®¹ï¼š</span><br><span class="line"></span><br><span class="line">  â¤ è¡¨æ ¼ 1:</span><br><span class="line">     [<span class="string">&#x27;æ¡æ¬¾å·&#x27;</span>, <span class="string">&#x27;æ¡æ¬¾åç§°&#x27;</span>, <span class="string">&#x27;ç¼–åˆ—å†…å®¹&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.2&#x27;</span>, <span class="string">&#x27;æ‹›æ ‡äºº&#x27;</span>, <span class="string">&#x27;åç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º\nè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸\nåœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒºæµ¦æ²¿è¡—\né“æ»¨å®‰è·¯1338å·ä¸‰æ¥¼\nè”ç³»äººï¼šç¿æ è¶…\nç”µè¯ï¼š13600511926&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.3&#x27;</span>, <span class="string">&#x27;æ‹›æ ‡ä»£ç†æœºæ„&#x27;</span>, <span class="string">&#x27;åç§°ï¼š æµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸\nåœ°å€ï¼šæ­å·å¸‚ä¸ŠåŸåŒºä½°å¯Œæ—¶ä»£ä¸­å¿ƒ3å¹¢13æ¥¼\nè”ç³»äººï¼šæ½˜æ­£é˜³ã€é™ˆç‘¶\nç”µè¯ï¼š13758171369ã€18757567243&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.4&#x27;</span>, <span class="string">&#x27;å·¥ç¨‹åç§°&#x27;</span>, <span class="string">&#x27;å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.5&#x27;</span>, <span class="string">&#x27;å»ºè®¾åœ°ç‚¹&#x27;</span>, <span class="string">&#x27;æ­å·å¸‚æ»¨æ±ŸåŒº&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.6&#x27;</span>, <span class="string">&#x27;å»ºè®¾è§„æ¨¡&#x27;</span>, <span class="string">&#x27;è§æ‹›æ ‡å…¬å‘Š&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.7&#x27;</span>, <span class="string">&#x27;æŠ•èµ„ä¼°ç®—&#x27;</span>, <span class="string">&#x27;æœ¬é¡¹ç›®æŠ•èµ„ä¼°ç®—ä¸º22798ä¸‡å…ƒ&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.2.1&#x27;</span>, <span class="string">&#x27;èµ„é‡‘æ¥æºåŠæ¯”ä¾‹&#x27;</span>, <span class="string">&#x27;å›½æœ‰100%&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.2.2&#x27;</span>, <span class="string">&#x27;èµ„é‡‘è½å®æƒ…å†µ&#x27;</span>, <span class="string">&#x27;å·²è½å®&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.3.1&#x27;</span>, <span class="string">&#x27;æ‹›æ ‡èŒƒå›´&#x27;</span>, <span class="string">&#x27;â˜‘æ–¹æ¡ˆè®¾è®¡ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—ç¼–åˆ¶å’Œè°ƒæ•´ï¼‰å’Œæ–½å·¥å›¾è®¾è®¡ï¼ˆâ˜‘BIMè®¾è®¡\næœåŠ¡ï¼‰\næ‹›æ ‡å†…å®¹å…·ä½“åŒ…æ‹¬:å·¥ç¨‹è®¾è®¡æœåŠ¡å†…å®¹ï¼š åŒ…æ‹¬ä½†ä¸é™äºï¼š\nï¼ˆ1ï¼‰å¯ç ”ç¼–åˆ¶ï¼ˆå«ä¼°ç®—ç¼–åˆ¶ï¼‰ã€æ–¹æ¡ˆè®¾è®¡åŠæ·±åŒ–ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—\nç¼–åˆ¶ï¼‰ã€æ–½å·¥å›¾è®¾è®¡ã€å«BIMï¼ˆè‹¥æœ‰ï¼‰ã€‘ã€ç®¡çº¿ç»¼åˆã€äº¤æ”¹è®¾è®¡ï¼ˆè‹¥\næœ‰ï¼Œå«ä¸»ä½“é¡¹ç›®äº¤æ”¹ä»¥åŠå…¶ä»–é…å¥—äº¤æ”¹è®¾è®¡ï¼‰ã€é›¨æ±¡æ°´ç®¡çº¿è¿æ”¹ï¼ˆè‹¥\næœ‰ï¼‰ã€åŸºå‘è®¾è®¡ã€æŠ¥æ‰¹å®¡æŸ¥é…åˆã€æŒ‰å®¡æŸ¥å’Œæ‹›æ ‡äººæ„è§å¯¹æ•´ä¸ªè®¾è®¡è¿‡ç¨‹\nçš„ä¿®æ”¹ã€æ·±åŒ–æ•´åˆç­‰ä¼˜åŒ–è®¾è®¡ï¼›\nï¼ˆ2ï¼‰æŒ‰æ‹›æ ‡æ–‡ä»¶è¦æ±‚æä¾›çº¸è´¨å’Œç”µå­å›¾çº¸ï¼›\nï¼ˆ3ï¼‰è®¾è®¡è¡¥å›¾å’Œå·¥ç¨‹æ–½å·¥é˜¶æ®µçš„å˜æ›´è”ç³»å•ï¼›\nï¼ˆ4ï¼‰æ–½å·¥é…åˆã€éªŒæ”¶é…åˆã€ç«£å·¥å›¾ç¼–åˆ¶é…åˆç­‰ç›¸å…³æœåŠ¡ï¼›\nï¼ˆ5ï¼‰æ ¹æ®å·¥ç¨‹å®é™…éœ€è¦æä¾›ç°åœºæœåŠ¡ç­‰ã€‚\nå„é˜¶æ®µè®¾è®¡æˆæœåº”ç¬¦åˆå›½å®¶è§„å®šçš„å›¾çº¸ç¼–åˆ¶æ·±åº¦è¦æ±‚åŠç›¸å…³å‡ºå›¾æ ‡å‡†è¦\næ±‚ä¸”åº”æ»¡è¶³å‘åŒ…äººçš„ç›¸å…³è¦æ±‚ï¼Œå¹¶åº”åŠæ—¶å®Œæˆæ‹›æ ‡äººå’Œç›¸å…³å®¡æŸ¥éƒ¨é—¨çš„\né˜¶æ®µæ€§å®¡æŸ¥æ„è§æ‰€æå‡ºçš„ä¿®æ”¹å·¥ä½œç­‰ï¼Œç‰¹åˆ«æ˜¯ç›¸å…³éƒ¨é—¨ä¸è®¡æ¬¡æ•°çš„ä¼˜åŒ–\nä¿®æ”¹è¦æ±‚ç­‰ã€‚é˜¶æ®µæ€§å®¡æŸ¥åŒ…æ‹¬æ–¹æ¡ˆè¯„å®¡ã€åˆæ­¥è®¾è®¡å®¡æŸ¥å’Œæ–½å·¥å›¾å®¡æŸ¥&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 15 é¡µçš„è¡¨æ ¼å†…å®¹ï¼š</span><br><span class="line"></span><br><span class="line">  â¤ è¡¨æ ¼ 1:</span><br><span class="line">     [<span class="string">&#x27;è¯„å®¡å› ç´ &#x27;</span>, <span class="string">&#x27;è¯„å®¡å†…å®¹&#x27;</span>, <span class="string">&#x27;åˆ†å€¼&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 16 é¡µçš„è¡¨æ ¼å†…å®¹ï¼š</span><br><span class="line"></span><br><span class="line">  â¤ è¡¨æ ¼ 1:</span><br><span class="line">     [<span class="string">&#x27;ç±»ä¼¼å·¥ç¨‹ä¸š\nç»©&#x27;</span>, <span class="string">&#x27;ä¼ä¸šä¸šç»©ï¼šæŠ•æ ‡äººè‡ªæŠ•æ ‡æˆªæ­¢æ—¥ä¹‹å‰5å¹´ï¼ˆå«ï¼‰å†…ï¼ˆä»¥åˆ\nåŒç­¾è®¢æ—¶é—´ä¸ºå‡†ï¼‰æ‰¿æ¥è¿‡çš„ç±»ä¼¼ä¸šç»©ï¼š\nâ‘ å•ä¸ªè®¾è®¡åˆåŒé‡‘é¢260ä¸‡å…ƒï¼ˆå«ï¼‰ä»¥ä¸Šçš„å¸‚æ”¿é“è·¯å·¥ç¨‹\nè®¾è®¡åˆåŒä¸šç»©ï¼Œæ¯ä¸€ä¸ªå¾—1.5åˆ†ï¼Œæœ¬é¡¹æœ€å¤šå¾—1.5åˆ†ï¼›\nâ‘¡å•ä¸ªè®¾è®¡åˆåŒåŒ…å«é•¿åº¦200ç±³ï¼ˆå«ï¼‰ä»¥ä¸ŠåŸå¸‚éš§é“(éš§\né“é•¿åº¦å«Uå‹æ§½æ®µ)çš„å¸‚æ”¿é“è·¯å·¥ç¨‹è®¾è®¡åˆåŒä¸šç»©ï¼Œæ¯ä¸€\nä¸ªå¾—1.5åˆ†ï¼Œæœ¬é¡¹æœ€å¤šå¾—1.5åˆ†ã€‚\nï¼ˆè¯æ˜ææ–™ï¼šè®¾è®¡åˆåŒã€ä¸­æ ‡é€šçŸ¥ä¹¦å¤å°ä»¶åŠ ç›–å…¬ç« ï¼Œåˆ\nåŒä¸­å¿…é¡»ä½“ç°é¡¹ç›®å±æ€§ã€æ—¶é—´ç­‰é¡¹ç›®ç‰¹å¾è¡¨è¿°ï¼›å¦‚ä¸èƒ½ä½“\nç°ï¼Œä¸å¾—åˆ†ã€‚ï¼‰&#x27;</span>, <span class="string">&#x27;0-3åˆ†&#x27;</span>]</span><br><span class="line">     [None, <span class="string">&#x27;é¡¹ç›®è´Ÿè´£äººä¸šç»©ï¼šæŠ•æ ‡äººè‡ªæŠ•æ ‡æˆªæ­¢æ—¥ä¹‹å‰5å¹´ï¼ˆå«ï¼‰å†…\nï¼ˆä»¥åˆåŒç­¾è®¢æ—¶é—´ä¸ºå‡†ï¼‰ï¼Œæ‹Ÿæ´¾é¡¹ç›®è´Ÿè´£äººä»¥é¡¹ç›®è´Ÿè´£äºº\nèº«ä»½è´Ÿè´£è¿‡çš„ç±»ä¼¼ä¸šç»©ï¼š\nâ‘ å•ä¸ªè®¾è®¡åˆåŒé‡‘é¢260ä¸‡å…ƒï¼ˆå«ï¼‰ä»¥ä¸Šçš„å¸‚æ”¿é“è·¯å·¥ç¨‹\nè®¾è®¡åˆåŒä¸šç»©ï¼Œæ¯ä¸€ä¸ªå¾—2åˆ†ï¼Œæœ¬é¡¹æœ€å¤šå¾—2åˆ†ï¼›\nâ‘¡ å•ä¸ªè®¾è®¡åˆåŒé‡‘é¢200ï¼ˆå«ï¼‰-260ä¸‡å…ƒå¸‚æ”¿é“è·¯å·¥ç¨‹\nè®¾è®¡åˆåŒä¸šç»©ï¼Œæ¯ä¸€ä¸ªå¾—1åˆ†ï¼Œæœ¬é¡¹æœ€å¤šå¾—2åˆ†ã€‚\nï¼ˆè¯æ˜ææ–™ï¼šè®¾è®¡åˆåŒã€ä¸­æ ‡é€šçŸ¥ä¹¦å¤å°ä»¶åŠ ç›–å…¬ç« ï¼Œåˆ\nåŒä¸­å¿…é¡»ä½“ç°é¡¹ç›®å±æ€§ã€æ—¶é—´ã€é¡¹ç›®è´Ÿè´£äººåå­—ç­‰é¡¹ç›®ç‰¹\nå¾è¡¨è¿°ï¼›å¦‚ä¸èƒ½ä½“ç°ï¼Œä¸å¾—åˆ†ã€‚ï¼‰&#x27;</span>, <span class="string">&#x27;0-2åˆ†&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;ä¿¡ç”¨è¯„ä»·&#x27;</span>, <span class="string">&#x27;å»ºè®¾è¡Œæ”¿ä¸»ç®¡éƒ¨é—¨ä¿¡ç”¨è¯„ä»·&#x27;</span>, <span class="string">&#x27;0-2åˆ†&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;å›¢é˜Ÿé…å¤‡&#x27;</span>, <span class="string">&#x27;ï¼ˆ1ï¼‰é¡¹ç›®ç­å­äººå‘˜å…¨éƒ¨æ»¡è¶³æ‹›æ ‡æ–‡ä»¶äººå‘˜é…å¤‡è¦æ±‚ï¼ˆå…·\nä½“è¦æ±‚è§ã€Šé™„è¡¨ï¼šé¡¹ç›®è´Ÿè´£äººåŠäººå‘˜é…å¤‡è¡¨ã€‹ï¼‰å¾—2åˆ†ï¼Œ\næ¯æœ‰ä¸€é¡¹ä¸æ»¡è¶³æ‰£0.5åˆ†ï¼ˆæœ€å°‘0åˆ†ï¼‰ã€‚\nï¼ˆ2ï¼‰é“è·¯ã€éš§é“ã€ç»™æ’æ°´ã€ç”µæ°”ä¸“ä¸šè®¾è®¡å¸ˆï¼Œå…·æœ‰å¯¹åº”\nä¸“ä¸šæ³¨å†Œæ‰§ä¸šèµ„æ ¼ã€å¦‚æ³¨å†ŒåœŸæœ¨å·¥ç¨‹å¸ˆï¼ˆå²©åœŸï¼‰èµ„æ ¼ã€æ³¨\nå†Œå…¬ç”¨è®¾å¤‡å·¥ç¨‹å¸ˆï¼ˆç»™æ’æ°´ï¼‰èµ„æ ¼ã€æ³¨å†Œç”µæ°”å·¥ç¨‹å¸ˆï¼ˆä¾›\né…ç”µï¼‰èµ„æ ¼ã€‘çš„ï¼Œæä¾›ä¸€ä¸ªå¾—0.3åˆ†ï¼Œä¸¤ä¸ªå¾—0.6åˆ†ï¼Œä¸‰\nä¸ªå¾—1åˆ†ï¼Œæœ€é«˜å¾—1åˆ†ã€‚\næ³¨ï¼šé¡¹ç›®è®¾è®¡å›¢é˜Ÿä¸­å„ä¸“ä¸šä¸å¯å…¼ä»»ã€‚\n(æœ‰æ•ˆè¯æ˜ææ–™ï¼šæä¾›æ‰§ä¸šèµ„æ ¼è¯ä¹¦ï¼ŒèŒç§°è¯ä¹¦ï¼Œæœ¬å•ä½\nè¿‘ä¸‰ä¸ªæœˆçš„ç¤¾ä¿è¯æ˜ï¼ˆè‡³æŠ•æ ‡æˆªæ­¢æ—¶é—´ä¸Šæº¯6ä¸ªæœˆä¸­ä»»æ„\nè¿ç»­3ä¸ªæœˆçš„ç¤¾ä¿ç¼´çº³è¯æ˜ï¼‰ï¼Œå¤å°ä»¶åŠ ç›–å…¬ç« ã€‚å¦‚èŒç§°\nè¯ä¹¦æ— æ³•è¯æ˜ä¸“ä¸šï¼Œä»¥æ¯•ä¸šè¯ä¸“ä¸šä¸ºå‡†ã€‚)&#x27;</span>, <span class="string">&#x27;0-3åˆ†&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  â¤ è¡¨æ ¼ 2:</span><br><span class="line">     [<span class="string">&#x27;åºå·&#x27;</span>, <span class="string">&#x27;èŒåŠ¡åç§°&#x27;</span>, <span class="string">&#x27;æœ€å°‘é…å¤‡\næ•°é‡\nï¼ˆäººï¼‰&#x27;</span>, <span class="string">&#x27;èŒç§°æˆ–èŒä¸šèµ„æ ¼&#x27;</span>, <span class="string">&#x27;å¤‡æ³¨&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;é¡¹ç›®è´Ÿè´£äºº&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å¸‚æ”¿å…¬ç”¨å·¥ç¨‹æˆ–éš§é“å·¥ç¨‹&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ğŸ”¹ ç¬¬ 17 é¡µçš„è¡¨æ ¼å†…å®¹ï¼š</span><br><span class="line"></span><br><span class="line">  â¤ è¡¨æ ¼ 1:</span><br><span class="line">     [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;ç±»é«˜çº§å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>, <span class="string">&#x27;&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;é“è·¯ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;éš§é“ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;ç»™æ’æ°´ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;ç”µæ°”ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;å›­æ—ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;é€ ä»·ä¸“ä¸šè´Ÿè´£äºº&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰æ³¨å†Œä¸€çº§é€ ä»·å¸ˆèµ„æ ¼&#x27;</span>, <span class="string">&#x27;å…¨è¿‡ç¨‹&#x27;</span>]</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="2-find-tables-â€¦"><a href="#2-find-tables-â€¦" class="headerlink" title="2. find_tables(â€¦)"></a>2. find_tables(â€¦)</h4><p><strong>ç›´æ¥ä¸Šä»£ç ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="comment"># å®šä¹‰é¡µç èŒƒå›´ï¼ˆæ³¨æ„ï¼šé¡µç ä» 0 å¼€å§‹ï¼‰</span></span><br><span class="line">    target_pages = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>)) + <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">14</span>, <span class="number">17</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> page_num <span class="keyword">in</span> target_pages:</span><br><span class="line">        <span class="keyword">if</span> page_num &gt;= <span class="built_in">len</span>(pdf.pages):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸ é¡µç  <span class="subst">&#123;page_num + <span class="number">1</span>&#125;</span> è¶…å‡º PDF é¡µæ•°èŒƒå›´ã€‚&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n================ ğŸ“„ ç¬¬ <span class="subst">&#123;page_num + <span class="number">1</span>&#125;</span> é¡µ ================&quot;</span>)</span><br><span class="line">        page = pdf.pages[page_num]</span><br><span class="line">        tables = page.find_tables()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> tables:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i, table <span class="keyword">in</span> <span class="built_in">enumerate</span>(tables):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ”¹ è¡¨æ ¼ <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 1. è¡¨æ ¼è¾¹ç•Œæ¡†</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;ğŸ“ bbox è¾¹ç•Œæ¡†:&quot;</span>, table.bbox)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 2. å•å…ƒæ ¼</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;ğŸ§± cellsï¼ˆå…± <span class="subst">&#123;<span class="built_in">len</span>(table.cells)&#125;</span> ä¸ªå•å…ƒæ ¼ï¼‰:&quot;</span>)</span><br><span class="line">                <span class="comment"># è·å–å‰ä¸¤ä¸ªå’Œæœ€åä¸¤ä¸ª</span></span><br><span class="line">                cells_to_show = table.cells[:<span class="number">2</span>] + table.cells[-<span class="number">2</span>:] <span class="keyword">if</span> <span class="built_in">len</span>(table.cells) &gt; <span class="number">4</span> <span class="keyword">else</span> table.cells</span><br><span class="line">                <span class="keyword">for</span> idx, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(cells_to_show, <span class="number">1</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  â†’ ç¬¬ <span class="subst">&#123;idx&#125;</span> ä¸ªå•å…ƒæ ¼: <span class="subst">&#123;cell&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 3. è¡Œï¼ˆå®Œæ•´æ‰“å°æ¯ä¸ªå•å…ƒæ ¼ï¼‰</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“‹ rowsï¼ˆå…± <span class="subst">&#123;<span class="built_in">len</span>(table.rows)&#125;</span> è¡Œï¼‰:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> row_idx, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(table.rows):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  â¬‡ ç¬¬ <span class="subst">&#123;row_idx + <span class="number">1</span>&#125;</span> è¡Œ:&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> col_idx, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(row.cells):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;     â†’ ç¬¬ <span class="subst">&#123;col_idx + <span class="number">1</span>&#125;</span> åˆ—å•å…ƒæ ¼å†…å®¹: <span class="subst">&#123;cell&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 4. åˆ—ï¼ˆå®Œæ•´æ‰“å°æ¯ä¸ªå•å…ƒæ ¼ï¼‰</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š columnsï¼ˆå…± <span class="subst">&#123;<span class="built_in">len</span>(table.columns)&#125;</span> åˆ—ï¼‰:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> col_idx, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(table.columns):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  â¬… ç¬¬ <span class="subst">&#123;col_idx + <span class="number">1</span>&#125;</span> åˆ—:&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> row_idx, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(col.cells):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;     â†’ ç¬¬ <span class="subst">&#123;row_idx + <span class="number">1</span>&#125;</span> è¡Œå•å…ƒæ ¼å†…å®¹: <span class="subst">&#123;cell&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 5. æå–æ–‡æœ¬å½¢å¼çš„è¡¨æ ¼</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;ğŸ“„ è¡¨æ ¼å†…å®¹ï¼ˆä½¿ç”¨ extract æå–ï¼‰:&quot;</span>)</span><br><span class="line">                extracted = table.extract(x_tolerance=<span class="number">3</span>, y_tolerance=<span class="number">3</span>)</span><br><span class="line">                <span class="keyword">for</span> row <span class="keyword">in</span> extracted:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;   &quot;</span>, row)</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºï¼ˆè¿™é‡Œä»…ä»¥å‰ä¸‰é¡µä¸ºä¾‹è¿›è¡Œè¯´æ˜ï¼‰ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">================ ğŸ“„ ç¬¬ 1 é¡µ ================</span><br><span class="line">âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚</span><br><span class="line"></span><br><span class="line">================ ğŸ“„ ç¬¬ 2 é¡µ ================</span><br><span class="line">âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚</span><br><span class="line"></span><br><span class="line">================ ğŸ“„ ç¬¬ 3 é¡µ ================</span><br><span class="line"></span><br><span class="line">ğŸ”¹ è¡¨æ ¼ 1:</span><br><span class="line">ğŸ“ bbox è¾¹ç•Œæ¡†: (51.42499924, 166.80000305, 543.87501145, 761.84999084)</span><br><span class="line">ğŸ§± cellsï¼ˆå…± 30 ä¸ªå•å…ƒæ ¼ï¼‰:</span><br><span class="line">  â†’ ç¬¬ 1 ä¸ªå•å…ƒæ ¼: (51.42499924, 166.80000305, 122.32500077, 184.95000267)</span><br><span class="line">  â†’ ç¬¬ 2 ä¸ªå•å…ƒæ ¼: (51.42499924, 184.95000267, 122.32500077, 297.55000305)</span><br><span class="line">  â†’ ç¬¬ 3 ä¸ªå•å…ƒæ ¼: (214.47500228999996, 487.84999084, 543.87501145, 511.74998474)</span><br><span class="line">  â†’ ç¬¬ 4 ä¸ªå•å…ƒæ ¼: (214.47500228999996, 511.74998474, 543.87501145, 761.84999084)</span><br><span class="line">ğŸ“‹ rowsï¼ˆå…± 10 è¡Œï¼‰:</span><br><span class="line">  â¬‡ ç¬¬ 1 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 166.80000305, 122.32500077, 184.95000267)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 166.80000305, 214.47500228999996, 184.95000267)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 166.80000305, 543.87501145, 184.95000267)</span><br><span class="line">  â¬‡ ç¬¬ 2 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 184.95000267, 122.32500077, 297.55000305)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 184.95000267, 214.47500228999996, 297.55000305)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 184.95000267, 543.87501145, 297.55000305)</span><br><span class="line">  â¬‡ ç¬¬ 3 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 297.55000305, 122.32500077, 368.05000305)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 297.55000305, 214.47500228999996, 368.05000305)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 297.55000305, 543.87501145, 368.05000305)</span><br><span class="line">  â¬‡ ç¬¬ 4 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 368.05000305, 122.32500077, 392.1000061)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 368.05000305, 214.47500228999996, 392.1000061)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 368.05000305, 543.87501145, 392.1000061)</span><br><span class="line">  â¬‡ ç¬¬ 5 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 392.1000061, 122.32500077, 416.0)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 392.1000061, 214.47500228999996, 416.0)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 392.1000061, 543.87501145, 416.0)</span><br><span class="line">  â¬‡ ç¬¬ 6 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 416.0, 122.32500077, 439.90000914999996)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 416.0, 214.47500228999996, 439.90000914999996)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 416.0, 543.87501145, 439.90000914999996)</span><br><span class="line">  â¬‡ ç¬¬ 7 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 439.90000914999996, 122.32500077, 463.80000305)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 439.90000914999996, 214.47500228999996, 463.80000305)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 439.90000914999996, 543.87501145, 463.80000305)</span><br><span class="line">  â¬‡ ç¬¬ 8 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 463.80000305, 122.32500077, 487.84999084)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 463.80000305, 214.47500228999996, 487.84999084)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 463.80000305, 543.87501145, 487.84999084)</span><br><span class="line">  â¬‡ ç¬¬ 9 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 487.84999084, 122.32500077, 511.74998474)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 487.84999084, 214.47500228999996, 511.74998474)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 487.84999084, 543.87501145, 511.74998474)</span><br><span class="line">  â¬‡ ç¬¬ 10 è¡Œ:</span><br><span class="line">     â†’ ç¬¬ 1 åˆ—å•å…ƒæ ¼å†…å®¹: (51.42499924, 511.74998474, 122.32500077, 761.84999084)</span><br><span class="line">     â†’ ç¬¬ 2 åˆ—å•å…ƒæ ¼å†…å®¹: (122.32500077, 511.74998474, 214.47500228999996, 761.84999084)</span><br><span class="line">     â†’ ç¬¬ 3 åˆ—å•å…ƒæ ¼å†…å®¹: (214.47500228999996, 511.74998474, 543.87501145, 761.84999084)</span><br><span class="line">ğŸ“Š columnsï¼ˆå…± 3 åˆ—ï¼‰:</span><br><span class="line">  â¬… ç¬¬ 1 åˆ—:</span><br><span class="line">     â†’ ç¬¬ 1 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 166.80000305, 122.32500077, 184.95000267)</span><br><span class="line">     â†’ ç¬¬ 2 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 184.95000267, 122.32500077, 297.55000305)</span><br><span class="line">     â†’ ç¬¬ 3 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 297.55000305, 122.32500077, 368.05000305)</span><br><span class="line">     â†’ ç¬¬ 4 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 368.05000305, 122.32500077, 392.1000061)</span><br><span class="line">     â†’ ç¬¬ 5 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 392.1000061, 122.32500077, 416.0)</span><br><span class="line">     â†’ ç¬¬ 6 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 416.0, 122.32500077, 439.90000914999996)</span><br><span class="line">     â†’ ç¬¬ 7 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 439.90000914999996, 122.32500077, 463.80000305)</span><br><span class="line">     â†’ ç¬¬ 8 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 463.80000305, 122.32500077, 487.84999084)</span><br><span class="line">     â†’ ç¬¬ 9 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 487.84999084, 122.32500077, 511.74998474)</span><br><span class="line">     â†’ ç¬¬ 10 è¡Œå•å…ƒæ ¼å†…å®¹: (51.42499924, 511.74998474, 122.32500077, 761.84999084)</span><br><span class="line">  â¬… ç¬¬ 2 åˆ—:</span><br><span class="line">     â†’ ç¬¬ 1 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 166.80000305, 214.47500228999996, 184.95000267)</span><br><span class="line">     â†’ ç¬¬ 2 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 184.95000267, 214.47500228999996, 297.55000305)</span><br><span class="line">     â†’ ç¬¬ 3 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 297.55000305, 214.47500228999996, 368.05000305)</span><br><span class="line">     â†’ ç¬¬ 4 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 368.05000305, 214.47500228999996, 392.1000061)</span><br><span class="line">     â†’ ç¬¬ 5 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 392.1000061, 214.47500228999996, 416.0)</span><br><span class="line">     â†’ ç¬¬ 6 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 416.0, 214.47500228999996, 439.90000914999996)</span><br><span class="line">     â†’ ç¬¬ 7 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 439.90000914999996, 214.47500228999996, 463.80000305)</span><br><span class="line">     â†’ ç¬¬ 8 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 463.80000305, 214.47500228999996, 487.84999084)</span><br><span class="line">     â†’ ç¬¬ 9 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 487.84999084, 214.47500228999996, 511.74998474)</span><br><span class="line">     â†’ ç¬¬ 10 è¡Œå•å…ƒæ ¼å†…å®¹: (122.32500077, 511.74998474, 214.47500228999996, 761.84999084)</span><br><span class="line">  â¬… ç¬¬ 3 åˆ—:</span><br><span class="line">     â†’ ç¬¬ 1 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 166.80000305, 543.87501145, 184.95000267)</span><br><span class="line">     â†’ ç¬¬ 2 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 184.95000267, 543.87501145, 297.55000305)</span><br><span class="line">     â†’ ç¬¬ 3 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 297.55000305, 543.87501145, 368.05000305)</span><br><span class="line">     â†’ ç¬¬ 4 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 368.05000305, 543.87501145, 392.1000061)</span><br><span class="line">     â†’ ç¬¬ 5 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 392.1000061, 543.87501145, 416.0)</span><br><span class="line">     â†’ ç¬¬ 6 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 416.0, 543.87501145, 439.90000914999996)</span><br><span class="line">     â†’ ç¬¬ 7 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 439.90000914999996, 543.87501145, 463.80000305)</span><br><span class="line">     â†’ ç¬¬ 8 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 463.80000305, 543.87501145, 487.84999084)</span><br><span class="line">     â†’ ç¬¬ 9 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 487.84999084, 543.87501145, 511.74998474)</span><br><span class="line">     â†’ ç¬¬ 10 è¡Œå•å…ƒæ ¼å†…å®¹: (214.47500228999996, 511.74998474, 543.87501145, 761.84999084)</span><br><span class="line">ğŸ“„ è¡¨æ ¼å†…å®¹ï¼ˆä½¿ç”¨ extract æå–ï¼‰:</span><br><span class="line">    [<span class="string">&#x27;æ¡æ¬¾å·&#x27;</span>, <span class="string">&#x27;æ¡æ¬¾åç§°&#x27;</span>, <span class="string">&#x27;ç¼–åˆ—å†…å®¹&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.2&#x27;</span>, <span class="string">&#x27;æ‹›æ ‡äºº&#x27;</span>, <span class="string">&#x27;åç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º\nè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸\nåœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒºæµ¦æ²¿è¡—\né“æ»¨å®‰è·¯1338å·ä¸‰æ¥¼\nè”ç³»äººï¼šç¿æ è¶…\nç”µè¯ï¼š13600511926&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.3&#x27;</span>, <span class="string">&#x27;æ‹›æ ‡ä»£ç†æœºæ„&#x27;</span>, <span class="string">&#x27;åç§°ï¼š æµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸\nåœ°å€ï¼šæ­å·å¸‚ä¸ŠåŸåŒºä½°å¯Œæ—¶ä»£ä¸­å¿ƒ3å¹¢13æ¥¼\nè”ç³»äººï¼šæ½˜æ­£é˜³ã€é™ˆç‘¶\nç”µè¯ï¼š13758171369ã€18757567243&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.4&#x27;</span>, <span class="string">&#x27;å·¥ç¨‹åç§°&#x27;</span>, <span class="string">&#x27;å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.5&#x27;</span>, <span class="string">&#x27;å»ºè®¾åœ°ç‚¹&#x27;</span>, <span class="string">&#x27;æ­å·å¸‚æ»¨æ±ŸåŒº&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.6&#x27;</span>, <span class="string">&#x27;å»ºè®¾è§„æ¨¡&#x27;</span>, <span class="string">&#x27;è§æ‹›æ ‡å…¬å‘Š&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.7&#x27;</span>, <span class="string">&#x27;æŠ•èµ„ä¼°ç®—&#x27;</span>, <span class="string">&#x27;æœ¬é¡¹ç›®æŠ•èµ„ä¼°ç®—ä¸º22798ä¸‡å…ƒ&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.2.1&#x27;</span>, <span class="string">&#x27;èµ„é‡‘æ¥æºåŠæ¯”ä¾‹&#x27;</span>, <span class="string">&#x27;å›½æœ‰100%&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.2.2&#x27;</span>, <span class="string">&#x27;èµ„é‡‘è½å®æƒ…å†µ&#x27;</span>, <span class="string">&#x27;å·²è½å®&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.3.1&#x27;</span>, <span class="string">&#x27;æ‹›æ ‡èŒƒå›´&#x27;</span>, <span class="string">&#x27;â˜‘æ–¹æ¡ˆè®¾è®¡ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—ç¼–åˆ¶å’Œè°ƒæ•´ï¼‰å’Œæ–½å·¥å›¾è®¾è®¡ï¼ˆâ˜‘BIMè®¾è®¡\næœåŠ¡ï¼‰\næ‹›æ ‡å†…å®¹å…·ä½“åŒ…æ‹¬:å·¥ç¨‹è®¾è®¡æœåŠ¡å†…å®¹ï¼š åŒ…æ‹¬ä½†ä¸é™äºï¼š\nï¼ˆ1ï¼‰å¯ç ”ç¼–åˆ¶ï¼ˆå«ä¼°ç®—ç¼–åˆ¶ï¼‰ã€æ–¹æ¡ˆè®¾è®¡åŠæ·±åŒ–ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—\nç¼–åˆ¶ï¼‰ã€æ–½å·¥å›¾è®¾è®¡ã€å«BIMï¼ˆè‹¥æœ‰ï¼‰ã€‘ã€ç®¡çº¿ç»¼åˆã€äº¤æ”¹è®¾è®¡ï¼ˆè‹¥\næœ‰ï¼Œå«ä¸»ä½“é¡¹ç›®äº¤æ”¹ä»¥åŠå…¶ä»–é…å¥—äº¤æ”¹è®¾è®¡ï¼‰ã€é›¨æ±¡æ°´ç®¡çº¿è¿æ”¹ï¼ˆè‹¥\næœ‰ï¼‰ã€åŸºå‘è®¾è®¡ã€æŠ¥æ‰¹å®¡æŸ¥é…åˆã€æŒ‰å®¡æŸ¥å’Œæ‹›æ ‡äººæ„è§å¯¹æ•´ä¸ªè®¾è®¡è¿‡ç¨‹\nçš„ä¿®æ”¹ã€æ·±åŒ–æ•´åˆç­‰ä¼˜åŒ–è®¾è®¡ï¼›\nï¼ˆ2ï¼‰æŒ‰æ‹›æ ‡æ–‡ä»¶è¦æ±‚æä¾›çº¸è´¨å’Œç”µå­å›¾çº¸ï¼›\nï¼ˆ3ï¼‰è®¾è®¡è¡¥å›¾å’Œå·¥ç¨‹æ–½å·¥é˜¶æ®µçš„å˜æ›´è”ç³»å•ï¼›\nï¼ˆ4ï¼‰æ–½å·¥é…åˆã€éªŒæ”¶é…åˆã€ç«£å·¥å›¾ç¼–åˆ¶é…åˆç­‰ç›¸å…³æœåŠ¡ï¼›\nï¼ˆ5ï¼‰æ ¹æ®å·¥ç¨‹å®é™…éœ€è¦æä¾›ç°åœºæœåŠ¡ç­‰ã€‚\nå„é˜¶æ®µè®¾è®¡æˆæœåº”ç¬¦åˆå›½å®¶è§„å®šçš„å›¾çº¸ç¼–åˆ¶æ·±åº¦è¦æ±‚åŠç›¸å…³å‡ºå›¾æ ‡å‡†è¦\næ±‚ä¸”åº”æ»¡è¶³å‘åŒ…äººçš„ç›¸å…³è¦æ±‚ï¼Œå¹¶åº”åŠæ—¶å®Œæˆæ‹›æ ‡äººå’Œç›¸å…³å®¡æŸ¥éƒ¨é—¨çš„\né˜¶æ®µæ€§å®¡æŸ¥æ„è§æ‰€æå‡ºçš„ä¿®æ”¹å·¥ä½œç­‰ï¼Œç‰¹åˆ«æ˜¯ç›¸å…³éƒ¨é—¨ä¸è®¡æ¬¡æ•°çš„ä¼˜åŒ–\nä¿®æ”¹è¦æ±‚ç­‰ã€‚é˜¶æ®µæ€§å®¡æŸ¥åŒ…æ‹¬æ–¹æ¡ˆè¯„å®¡ã€åˆæ­¥è®¾è®¡å®¡æŸ¥å’Œæ–½å·¥å›¾å®¡æŸ¥&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜ï¼š</strong></p>
<ol>
<li><p>ä¸Šæ–¹çš„åæ ‡å•ä½æ˜¯â€pointsâ€(pt)ï¼Œä¹Ÿå«PDFå•ä½ã€‚</p>
<blockquote>
<p>1 point &#x3D; 1&#x2F;72 inchï¼Œ72 pt &#x3D; 1 è‹±å¯¸ â‰ˆ 2.54 cm</p>
</blockquote>
</li>
<li><p>ä¸Šæ–¹çš„å››ä¸ªåæ ‡å‡ä¸º(x0, top, x1, bottom)</p>
<table>
<thead>
<tr>
<th align="center">æ ‡å¿—</th>
<th align="center">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="center">x0</td>
<td align="center">å·¦è¾¹æ¡†åˆ°é¡µé¢å·¦è¾¹æ¡†è·ç¦»</td>
</tr>
<tr>
<td align="center">top</td>
<td align="center">ä¸Šè¾¹æ¡†åˆ°é¡µé¢ä¸Šè¾¹æ¡†çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">x1</td>
<td align="center">å³è¾¹æ¡†åˆ°é¡µé¢å·¦è¾¹æ¡†çš„è·ç¦»</td>
</tr>
<tr>
<td align="center">bottom</td>
<td align="center">ä¸‹è¾¹æ¡†åˆ°é¡µé¢ä¸Šè¾¹æ¡†çš„è·ç¦»</td>
</tr>
</tbody></table>
</li>
<li><p>bbox è¾¹ç•Œæ¡†: (51.42499924, 166.80000305, 543.87501145, 761.84999084)è¡¨ç¤ºå½“å‰æ•´ä¸ªè¡¨æ ¼çš„åæ ‡ä½ç½®ï¼Œå·¦è¾¹æ¡†è·ç¦»é¡µé¢å·¦è¾¹ç¼˜51.42 ptï¼Œä¸Šè¾¹æ¡†è·ç¦»é¡µé¢ä¸Šè¾¹ç¼˜166.80 ptï¼Œå³è¾¹æ¡†è·ç¦»é¡µé¢å·¦è¾¹ç¼˜543.88 ptï¼Œä¸‹è¾¹æ¡†è·ç¦»é¡µé¢ä¸Šè¾¹ç¼˜761.85 ptã€‚</p>
</li>
<li><p>cellsè¡¨ç¤ºå½“å‰è¡¨æ ¼æœ‰å¤šå°‘å„å•å…ƒæ ¼ï¼Œé¡ºåºä¸ºä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ï¼Œè¿™é‡Œåªæ‰“å°å‡ºäº†å‰ä¸¤ä¸ªå’Œæœ€åä¸¤ä¸ªï¼Œå¯ä»¥çœ‹å‡ºç¬¬ä¸€ä¸ªå•å…ƒæ ¼çš„å‰ä¸¤ä½ä¸æœ€åä¸€ä¸ªå•å…ƒæ ¼çš„åä¸¤ä½ç»„åˆå³ä¸ºbboxè¾¹ç•Œæ¡†ã€‚</p>
</li>
<li><p>rowè¡¨ç¤ºæŒ‰è¡Œè¯»å–ï¼Œå¯ä»¥çœ‹å‡ºå¯¹äºåŒä¸€è¡Œæ¥è¯´ï¼Œtopå’Œbottomæ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>columnsè¡¨ç¤ºæŒ‰åˆ—è¯»å–ï¼Œå¯ä»¥çœ‹å‡ºå¯¹äºåŒä¸€åˆ—ï¼Œx0å’Œx1æ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>æœ€ç»ˆextractæå–çš„å†…å®¹å’Œextract_tables()æå–çš„å†…å®¹ä¸€æ ·ã€‚</p>
</li>
</ol>
<h4 id="3-å¯¹æ¯”"><a href="#3-å¯¹æ¯”" class="headerlink" title="3. å¯¹æ¯”"></a>3. å¯¹æ¯”</h4><p>æ¯”è¾ƒä¸‹ä¸Šé¢æåˆ°çš„ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><code>.find_tables()</code> â• <code>.extract()</code></li>
<li><code>.extract_tables()</code></li>
</ul>
<p>æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸ºäº†æå–è¡¨æ ¼å†…å®¹ï¼Œä½†å®ƒä»¬åœ¨ä½¿ç”¨æ–¹å¼å’Œæ§åˆ¶ç²’åº¦ä¸Š<strong>æœ‰æ‰€åŒºåˆ«</strong>ã€‚ä¸‹é¢æ˜¯è¯¦ç»†è§£é‡Šï¼š</p>
<p>âœ… <code>.find_tables() + .extract()</code> çš„ç‰¹ç‚¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tables = page.find_tables()</span><br><span class="line"><span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">    data = table.extract()</span><br></pre></td></tr></table></figure>

<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>è¿”å›çš„æ˜¯ <code>Table</code> å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®æ›´å¤šå±æ€§ï¼š<ul>
<li><code>.cells</code>: è¡¨æ ¼æ‰€æœ‰å•å…ƒæ ¼ï¼ˆåŒ…å«ä½ç½®å’Œå†…å®¹ï¼‰</li>
<li><code>.bbox</code>: è¡¨æ ¼è¾¹ç•Œæ¡†</li>
<li><code>.rows</code>, <code>.columns</code>: æ¯è¡Œæ¯åˆ—çš„å•å…ƒæ ¼</li>
</ul>
</li>
<li>æ›´é€‚åˆ<strong>éœ€è¦å¯¹è¡¨æ ¼ç»“æ„è¿›è¡Œè¿›ä¸€æ­¥åˆ†ææˆ–å¯è§†åŒ–</strong>çš„åœºæ™¯ã€‚</li>
<li>å¯ä»¥åœ¨æå–å‰å¯¹æ¯ä¸ªè¡¨æ ¼å•ç‹¬å¤„ç†ï¼Œä¾‹å¦‚ç­›é€‰ç‰¹å®šå¤§å°æˆ–ä½ç½®çš„è¡¨æ ¼ã€‚</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>ç¨å¾®å¤æ‚ä¸€äº›ï¼Œä¸é€‚åˆåªæƒ³å¿«é€Ÿæå–æ–‡æœ¬çš„ç®€å•åœºæ™¯ã€‚</li>
</ul>
<p>âœ… <code>.extract_tables()</code> çš„ç‰¹ç‚¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tables = page.extract_tables()</span><br></pre></td></tr></table></figure>

<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æ›´<strong>å¿«é€Ÿã€ç›´æ¥</strong>ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª<strong>åµŒå¥—åˆ—è¡¨ç»“æ„</strong>ï¼š<ul>
<li>ç»“æ„ï¼š<code>[table1, table2, ...]</code>ï¼Œæ¯ä¸ª table æ˜¯ä¸€ä¸ª <code>[[cell1, cell2, ...], [...], ...]</code></li>
</ul>
</li>
<li>æ›´é€‚åˆ<strong>å¿«é€Ÿè·å–çº¯æ–‡æœ¬è¡¨æ ¼</strong>å†…å®¹å¹¶æ‰“å°æˆ–å¯¼å‡ºã€‚</li>
<li>å®é™…å†…éƒ¨å°±æ˜¯è°ƒç”¨äº† <code>find_tables(...).extract()</code> çš„å°è£…ã€‚</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>ä¸è¿”å› <code>Table</code> å¯¹è±¡ï¼Œå› æ­¤<strong>æ— æ³•è®¿é—®å•å…ƒæ ¼ä½ç½®ã€è¡¨æ ¼è¾¹ç•Œç­‰é«˜çº§ä¿¡æ¯</strong>ã€‚</li>
<li>æ— æ³•å¯¹è¡¨æ ¼ç»“æ„è¿›è¡Œæ›´å¤šæ§åˆ¶ã€‚</li>
</ul>
<p>ğŸ“Œ æ€»ç»“å¯¹æ¯”è¡¨</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¿”å›ç±»å‹</th>
<th>èƒ½è®¿é—®ç»“æ„ä¿¡æ¯</th>
<th>æ“ä½œå¤æ‚åº¦</th>
<th>é€‚åˆåœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td><code>.find_tables() + .extract()</code></td>
<td><code>Table</code> å¯¹è±¡ + åˆ—è¡¨</td>
<td>âœ… æ˜¯</td>
<td>ç¨å¤æ‚</td>
<td>è¡¨æ ¼ç»“æ„åˆ†æã€è‡ªå®šä¹‰è¿‡æ»¤</td>
</tr>
<tr>
<td><code>.extract_tables()</code></td>
<td>åµŒå¥—åˆ—è¡¨</td>
<td>âŒ å¦</td>
<td>ç®€å•</td>
<td>å¿«é€Ÿæå–æ‰€æœ‰è¡¨æ ¼çº¯æ–‡æœ¬å†…å®¹</td>
</tr>
</tbody></table>
<p>âœ… å»ºè®®ä½¿ç”¨æ–¹å¼</p>
<ul>
<li><strong>åªæƒ³æå–è¡¨æ ¼å†…å®¹æ–‡æœ¬</strong> â†’ <code>extract_tables()</code> æ›´å¿«æ›´æ–¹ä¾¿ï¼›</li>
<li><strong>æƒ³è¿›ä¸€æ­¥åˆ†æè¡¨æ ¼ç»“æ„ã€ä½ç½®æˆ–å¯è§†åŒ–</strong> â†’ ä½¿ç”¨ <code>find_tables()</code> å’Œ <code>.extract()</code> æ›´çµæ´»ã€‚</li>
</ul>
<hr>
<h3 id="äº”-Page-crop-â€¦"><a href="#äº”-Page-crop-â€¦" class="headerlink" title="äº” Page.crop(â€¦)"></a>äº” Page.crop(â€¦)</h3><table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>.crop(bounding_box, relative&#x3D;False, strict&#x3D;True)</td>
<td>è¿”å›ä¸€ä¸ª<strong>è£å‰ªåˆ°æŒ‡å®šè¾¹ç•Œæ¡†</strong>ï¼ˆbounding boxï¼‰çš„é¡µé¢ç‰ˆæœ¬ã€‚è¾¹ç•Œæ¡†åº”è¡¨ç¤ºä¸ºä¸€ä¸ª 4 å…ƒç»„ï¼Œæ ¼å¼ä¸º <code>(x0, top, x1, bottom)</code>ã€‚è£å‰ªåçš„é¡µé¢<strong>ä¿ç•™é‚£äº›è‡³å°‘éƒ¨åˆ†ä½äºè¾¹ç•Œæ¡†å†…çš„å¯¹è±¡</strong>ã€‚å¦‚æœæŸä¸ªå¯¹è±¡<strong>åªæœ‰ä¸€éƒ¨åˆ†ä½äºè¾¹ç•Œæ¡†å†…</strong>ï¼Œé‚£ä¹ˆå®ƒçš„å°ºå¯¸å°†è¢«æˆªå–ä»¥é€‚åº”è¿™ä¸ªè¾¹ç•Œæ¡†ã€‚å¦‚æœè®¾ç½® <code>relative=True</code>ï¼Œåˆ™è¾¹ç•Œæ¡†çš„åæ ‡å°†<strong>ç›¸å¯¹äºé¡µé¢å·¦ä¸Šè§’è¿›è¡Œåç§»è®¡ç®—</strong>ï¼ˆè€Œä¸æ˜¯ä½¿ç”¨ç»å¯¹ä½ç½®ï¼‰ã€‚ï¼ˆè¯¦è§ <a target="_blank" rel="noopener" href="https://github.com/jsvine/pdfplumber/issues/245">Issue #245</a> ä»¥è·å–å›¾ç¤ºå’Œè§£é‡Šã€‚ï¼‰å½“ <code>strict=True</code>ï¼ˆé»˜è®¤å€¼ï¼‰æ—¶ï¼Œè¦æ±‚<strong>è£å‰ªè¾¹ç•Œæ¡†å¿…é¡»å®Œå…¨ä½äºé¡µé¢è¾¹ç•Œæ¡†ä¹‹å†…</strong>ï¼Œå¦åˆ™å°†å¼•å‘é”™è¯¯ã€‚</td>
</tr>
</tbody></table>
<p>æŒ‰ä¸Šé¢<code>find_tables</code>ä¸€èŠ‚ä¸­ç¬¬17é¡µè¾“å‡ºçš„<code>bbox</code>åæ ‡ä¿¡æ¯æå–è¡¨æ ¼å¹¶ä¿å­˜ä¸‹æ¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># PDF è·¯å¾„å’Œè£å‰ªåŒºåŸŸï¼ˆbboxï¼‰</span></span><br><span class="line">pdf_path = <span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span></span><br><span class="line">page_number = <span class="number">16</span>  <span class="comment"># ç¬¬17ä¸š</span></span><br><span class="line">crop_bbox = (<span class="number">88.1</span>, <span class="number">72.25</span>, <span class="number">516.05</span>, <span class="number">226.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF å¹¶å¤„ç†æŒ‡å®šé¡µé¢</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[page_number]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è£å‰ªæŒ‡å®šåŒºåŸŸ</span></span><br><span class="line">    cropped_page = page.crop(crop_bbox)</span><br><span class="line">    tables = cropped_page.extract_tables()</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è¡¨æ ¼</span></span><br><span class="line">    <span class="keyword">if</span> tables:</span><br><span class="line">        <span class="keyword">for</span> table_index, table <span class="keyword">in</span> <span class="built_in">enumerate</span>(tables):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n  â¤ è¡¨æ ¼ <span class="subst">&#123;table_index + <span class="number">1</span>&#125;</span>:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> table:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;    &quot;</span>, row)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âŒ æ²¡æœ‰æ‰¾åˆ°è¡¨æ ¼ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¸²æŸ“ä¸ºå›¾åƒï¼ˆé»˜è®¤ resolution=72 dpiï¼Œå¯è°ƒé«˜æå‡æ¸…æ™°åº¦ï¼‰</span></span><br><span class="line">    image = cropped_page.to_image(resolution=<span class="number">150</span>)  <span class="comment"># 150 æˆ– 200 æ›´æ¸…æ™°</span></span><br><span class="line"></span><br><span class="line">    image.save(<span class="string">&quot;table.png&quot;</span>, <span class="built_in">format</span>=<span class="string">&quot;PNG&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â¤ è¡¨æ ¼ 1:</span><br><span class="line">   [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;ç±»é«˜çº§å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;é“è·¯ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;éš§é“ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;ç»™æ’æ°´ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;ç”µæ°”ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;å›­æ—ä¸“ä¸šè®¾è®¡å¸ˆ&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰å·¥ç¨‹å¸ˆåŠä»¥ä¸ŠèŒç§°&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;é€ ä»·ä¸“ä¸šè´Ÿè´£äºº&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å…·æœ‰æ³¨å†Œä¸€çº§é€ ä»·å¸ˆèµ„æ ¼&#x27;</span>]</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="âœ…æ­£æ–‡"><a href="#âœ…æ­£æ–‡" class="headerlink" title="âœ…æ­£æ–‡"></a>âœ…æ­£æ–‡</h2><h3 id="æ··åˆè¡¨æ ¼-æ–‡æœ¬"><a href="#æ··åˆè¡¨æ ¼-æ–‡æœ¬" class="headerlink" title="æ··åˆè¡¨æ ¼&#x2F;æ–‡æœ¬"></a>æ··åˆè¡¨æ ¼&#x2F;æ–‡æœ¬</h3><p>å¦‚æœä½¿ç”¨<code>extract_text_line()</code>ä¼šå°†æ‰€æœ‰å†…å®¹æŒ‰è¡Œè¯»å–ï¼Œä¼šä¸¢å¤±è¡¨æ ¼çš„ç»“æ„ï¼Œæ•…è¡¨æ ¼éœ€ç”¨<code>find_tables()+extract()</code>æå–ï¼ˆå› ä¸ºå•çº¯çš„<code>extract_tables()</code>æ‹¿ä¸åˆ°åæ ‡ä¿¡æ¯ï¼‰,åˆç†è¿ç”¨<code>extract_text_line</code>+<code>find_tables+extract</code>+<code>crop</code>æ˜¯è§£ææ··åˆè¡¨æ ¼+æ™®é€šæ–‡æœ¬çš„PDFæ–‡ä»¶çš„å…³é”®ã€‚</p>
<p>æ€è·¯ï¼š</p>
<ul>
<li>å…ˆæå–æ‰€æœ‰è¡¨æ ¼ï¼Œè®°å½•ä»–ä»¬çš„<code>bounding boxes</code></li>
<li>å†æå–æ‰€æœ‰æ–‡æœ¬è¡Œï¼Œæ’é™¤é‚£äº›å‡ºç°åœ¨è¡¨æ ¼ä¸­çš„è¡Œ</li>
</ul>
<p><strong>ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·ï¼Œå’±ä»¬ä¸€ä¸ªé—®é¢˜ä¸€ä¸ªé—®é¢˜çš„è§£å†³ï¼Œå…ˆä»æœ€åŸºæœ¬çš„ä»£ç æ¥çœ‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_text_and_tables</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># æå–æ–‡æœ¬è¡Œï¼ˆæŒ‰è§†è§‰é¡ºåºï¼‰</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                result.append(&#123;</span><br><span class="line">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># æå–è¡¨æ ¼ï¼ˆæŒ‰æ¯é¡µé¡ºåºï¼‰</span></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> page.find_tables():</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    result.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_output.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_text_and_tables(pdf_path, max_pages=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å·²å®Œæˆæå–å¹¶ä¿å­˜è‡³ï¼š<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>æ­¤æ—¶çš„é—®é¢˜ï¼šè¡¨æ ¼å†…å®¹è¯»å–ä¸¤æ¬¡ï¼Œè§£å†³æ–¹å¼ï¼šé€šè¿‡åæ ‡åˆ¤æ–­textæ˜¯å¦å±äºtableèŒƒå›´</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_in_any_table</span>(<span class="params">line, table_bboxes</span>):</span><br><span class="line">    y = line[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x0, top, x1, bottom <span class="keyword">in</span> table_bboxes:</span><br><span class="line">        <span class="keyword">if</span> top &lt;= y &lt;= bottom:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_text_and_tables</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: æå–è¡¨æ ¼åŠå…¶ä½ç½®</span></span><br><span class="line">            tables = page.find_tables()</span><br><span class="line">            table_bboxes = [t.bbox <span class="keyword">for</span> t <span class="keyword">in</span> tables]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    result.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: æå–éè¡¨æ ¼æ–‡æœ¬è¡Œ</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> is_in_any_table(line, table_bboxes):</span><br><span class="line">                    result.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_clean.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_text_and_tables(pdf_path, max_pages=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æå–å®Œæˆï¼Œç»“æœå·²ä¿å­˜è‡³ï¼š<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>æ­¤æ—¶çš„é—®é¢˜ï¼šè™½ç„¶è¡¨æ ¼åªè¯»å–ä¸€æ¬¡äº†ï¼Œä½†é¡ºåºä¸å¯¹ï¼Œæ€»æ˜¯å…ˆå†™å…¥tableå†…å®¹å†å†™å…¥textå†…å®¹ï¼Œè§£å†³åŠæ³•ï¼šå†™å…¥åˆ°resultä¹‹å‰å…ˆæŒ‰åæ ‡æ’åº</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_in_any_table</span>(<span class="params">line, table_bboxes</span>):</span><br><span class="line">    y = line[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x0, top, x1, bottom <span class="keyword">in</span> table_bboxes:</span><br><span class="line">        <span class="keyword">if</span> top &lt;= y &lt;= bottom:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_ordered_content</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            items_on_page = []</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: æå–è¡¨æ ¼åŠå…¶bbox</span></span><br><span class="line">            tables = page.find_tables()</span><br><span class="line">            table_bboxes = [t.bbox <span class="keyword">for</span> t <span class="keyword">in</span> tables]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    <span class="comment"># ä½¿ç”¨è¡¨æ ¼çš„ bbox.top ä½œä¸ºæ’åºä¾æ®</span></span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: table.bbox[<span class="number">1</span>],  <span class="comment"># bbox = (x0, top, x1, bottom)</span></span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: æå–éè¡¨æ ¼æ–‡æœ¬è¡Œ</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> is_in_any_table(line, table_bboxes):</span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: line[<span class="string">&quot;top&quot;</span>],</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 3: æŒ‰ top åæ ‡æ’åºï¼Œæ¨¡æ‹Ÿé˜…è¯»é¡ºåº</span></span><br><span class="line">            items_on_page.sort(key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;top&quot;</span>])</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> items_on_page:</span><br><span class="line">                <span class="keyword">del</span> item[<span class="string">&quot;top&quot;</span>]  <span class="comment"># åˆ é™¤åæ ‡ï¼Œåªä¿ç•™å†…å®¹</span></span><br><span class="line">                result.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_ordered.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_ordered_content(pdf_path, max_pages=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æå–å®Œæˆï¼Œé¡ºåºå·²å¤„ç†ï¼Œç»“æœå·²ä¿å­˜è‡³ï¼š<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>ç°åœ¨é¡ºåºå¯¹äº†ï¼Œä½†æ˜¯éœ€å¯¹ç»­è¡¨å¢åŠ ä¸€ç‚¹å¤„ç†ï¼Œå¯¹äºä¸‹é¢çš„ç»­è¡¨ï¼Œåº”å°†å†…å®¹é™„åŠ åˆ°ä¸Šä¸€é¡µå¯¹åº”ä½ç½®çš„æœ«å°¾</strong></p>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_in_any_table</span>(<span class="params">line, table_bboxes</span>):</span><br><span class="line">    y = line[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x0, top, x1, bottom <span class="keyword">in</span> table_bboxes:</span><br><span class="line">        <span class="keyword">if</span> top &lt;= y &lt;= bottom:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_ordered_content_merged</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line">    last_table_ref = <span class="literal">None</span>  <span class="comment"># ç”¨äºå­˜å‚¨ä¸Šä¸€é¡µçš„è¡¨æ ¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            items_on_page = []</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: æå–è¡¨æ ¼åŠå…¶bbox</span></span><br><span class="line">            tables = page.find_tables()</span><br><span class="line">            table_bboxes = [t.bbox <span class="keyword">for</span> t <span class="keyword">in</span> tables]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    <span class="comment"># æ£€æŸ¥æ˜¯å¦ä¸ºç»­è¡¨çš„é¦–è¡Œï¼ˆç¬¬ä¸€åˆ—ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">                    <span class="keyword">if</span> table_data <span class="keyword">and</span> table_data[<span class="number">0</span>] <span class="keyword">and</span> table_data[<span class="number">0</span>][<span class="number">0</span>].strip() == <span class="string">&quot;&quot;</span> <span class="keyword">and</span> last_table_ref:</span><br><span class="line">                        <span class="comment"># åˆå¹¶åˆ°ä¸Šä¸€é¡µçš„æœ€åä¸€è¡Œ</span></span><br><span class="line">                        last_row = last_table_ref[-<span class="number">1</span>]</span><br><span class="line">                        new_row = table_data[<span class="number">0</span>]</span><br><span class="line">                        <span class="comment"># å°†ç»­è¡¨è¡Œçš„æ¯ä¸ªéç©ºå•å…ƒæ ¼åˆå¹¶åˆ° last_row</span></span><br><span class="line">                        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(new_row)):</span><br><span class="line">                            <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(last_row) <span class="keyword">and</span> new_row[j].strip():</span><br><span class="line">                                last_row[j] += new_row[j]</span><br><span class="line">                        <span class="comment"># åˆ é™¤é¦–è¡Œ</span></span><br><span class="line">                        table_data = table_data[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># æ·»åŠ å½“å‰è¡¨æ ¼</span></span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: table.bbox[<span class="number">1</span>],</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># æ›´æ–° last_table_refï¼ˆåªå­˜å‚¨è¡¨æ ¼æ•°æ®éƒ¨åˆ†ï¼‰</span></span><br><span class="line">                    last_table_ref = table_data</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: æå–éè¡¨æ ¼æ–‡æœ¬è¡Œ</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> is_in_any_table(line, table_bboxes):</span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: line[<span class="string">&quot;top&quot;</span>],</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 3: æ’åºå¹¶æ¸…ç†</span></span><br><span class="line">            items_on_page.sort(key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;top&quot;</span>])</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> items_on_page:</span><br><span class="line">                <span class="keyword">del</span> item[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">                result.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../æ‹›æ ‡æ–‡ä»¶ä¿®è®¢-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_ordered.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_ordered_content_merged(pdf_path, max_pages=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æå–å®Œæˆï¼Œé¡ºåºå·²å¤„ç†ï¼Œç»“æœå·²ä¿å­˜è‡³ï¼š<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>åˆ°è¿™é‡Œå®Œæˆäº†åŸºæœ¬çš„è¡¨æ ¼&#x2F;æ–‡æœ¬æ··åˆæ ¼å¼çš„pdfæ–‡ä»¶çš„è§£æï¼Œè¿™é‡Œå±•ç¤ºä¸‹ç¬¬ä¸‰é¡µçš„è§£æç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç¬¬äºŒç«  æŠ•æ ‡äººé¡»çŸ¥&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æŠ•æ ‡äººé¡»çŸ¥å‰é™„è¡¨&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;table&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;æ¡æ¬¾å·&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æ¡æ¬¾åç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;ç¼–åˆ—å†…å®¹&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æ‹›æ ‡äºº&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;åç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º\nè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸\nåœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒºæµ¦æ²¿è¡—\né“æ»¨å®‰è·¯1338å·ä¸‰æ¥¼\nè”ç³»äººï¼šç¿æ è¶…\nç”µè¯ï¼š13600511926&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æ‹›æ ‡ä»£ç†æœºæ„&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;åç§°ï¼š æµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸\nåœ°å€ï¼šæ­å·å¸‚ä¸ŠåŸåŒºä½°å¯Œæ—¶ä»£ä¸­å¿ƒ3å¹¢13æ¥¼\nè”ç³»äººï¼šæ½˜æ­£é˜³ã€é™ˆç‘¶\nç”µè¯ï¼š13758171369ã€18757567243&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.4&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;å·¥ç¨‹åç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;å»ºè®¾åœ°ç‚¹&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æ­å·å¸‚æ»¨æ±ŸåŒº&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.6&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;å»ºè®¾è§„æ¨¡&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;è§æ‹›æ ‡å…¬å‘Š&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.7&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æŠ•èµ„ä¼°ç®—&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æœ¬é¡¹ç›®æŠ•èµ„ä¼°ç®—ä¸º22798ä¸‡å…ƒ&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.2.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;èµ„é‡‘æ¥æºåŠæ¯”ä¾‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;å›½æœ‰100%&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.2.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;èµ„é‡‘è½å®æƒ…å†µ&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;å·²è½å®&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;æ‹›æ ‡èŒƒå›´&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;â˜‘æ–¹æ¡ˆè®¾è®¡ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—ç¼–åˆ¶å’Œè°ƒæ•´ï¼‰å’Œæ–½å·¥å›¾è®¾è®¡ï¼ˆâ˜‘BIMè®¾è®¡\næœåŠ¡ï¼‰\næ‹›æ ‡å†…å®¹å…·ä½“åŒ…æ‹¬:å·¥ç¨‹è®¾è®¡æœåŠ¡å†…å®¹ï¼š åŒ…æ‹¬ä½†ä¸é™äºï¼š\nï¼ˆ1ï¼‰å¯ç ”ç¼–åˆ¶ï¼ˆå«ä¼°ç®—ç¼–åˆ¶ï¼‰ã€æ–¹æ¡ˆè®¾è®¡åŠæ·±åŒ–ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—\nç¼–åˆ¶ï¼‰ã€æ–½å·¥å›¾è®¾è®¡ã€å«BIMï¼ˆè‹¥æœ‰ï¼‰ã€‘ã€ç®¡çº¿ç»¼åˆã€äº¤æ”¹è®¾è®¡ï¼ˆè‹¥\næœ‰ï¼Œå«ä¸»ä½“é¡¹ç›®äº¤æ”¹ä»¥åŠå…¶ä»–é…å¥—äº¤æ”¹è®¾è®¡ï¼‰ã€é›¨æ±¡æ°´ç®¡çº¿è¿æ”¹ï¼ˆè‹¥\næœ‰ï¼‰ã€åŸºå‘è®¾è®¡ã€æŠ¥æ‰¹å®¡æŸ¥é…åˆã€æŒ‰å®¡æŸ¥å’Œæ‹›æ ‡äººæ„è§å¯¹æ•´ä¸ªè®¾è®¡è¿‡ç¨‹\nçš„ä¿®æ”¹ã€æ·±åŒ–æ•´åˆç­‰ä¼˜åŒ–è®¾è®¡ï¼›\nï¼ˆ2ï¼‰æŒ‰æ‹›æ ‡æ–‡ä»¶è¦æ±‚æä¾›çº¸è´¨å’Œç”µå­å›¾çº¸ï¼›\nï¼ˆ3ï¼‰è®¾è®¡è¡¥å›¾å’Œå·¥ç¨‹æ–½å·¥é˜¶æ®µçš„å˜æ›´è”ç³»å•ï¼›\nï¼ˆ4ï¼‰æ–½å·¥é…åˆã€éªŒæ”¶é…åˆã€ç«£å·¥å›¾ç¼–åˆ¶é…åˆç­‰ç›¸å…³æœåŠ¡ï¼›\nï¼ˆ5ï¼‰æ ¹æ®å·¥ç¨‹å®é™…éœ€è¦æä¾›ç°åœºæœåŠ¡ç­‰ã€‚\nå„é˜¶æ®µè®¾è®¡æˆæœåº”ç¬¦åˆå›½å®¶è§„å®šçš„å›¾çº¸ç¼–åˆ¶æ·±åº¦è¦æ±‚åŠç›¸å…³å‡ºå›¾æ ‡å‡†è¦\næ±‚ä¸”åº”æ»¡è¶³å‘åŒ…äººçš„ç›¸å…³è¦æ±‚ï¼Œå¹¶åº”åŠæ—¶å®Œæˆæ‹›æ ‡äººå’Œç›¸å…³å®¡æŸ¥éƒ¨é—¨çš„\né˜¶æ®µæ€§å®¡æŸ¥æ„è§æ‰€æå‡ºçš„ä¿®æ”¹å·¥ä½œç­‰ï¼Œç‰¹åˆ«æ˜¯ç›¸å…³éƒ¨é—¨ä¸è®¡æ¬¡æ•°çš„ä¼˜åŒ–\nä¿®æ”¹è¦æ±‚ç­‰ã€‚é˜¶æ®µæ€§å®¡æŸ¥åŒ…æ‹¬æ–¹æ¡ˆè¯„å®¡ã€åˆæ­¥è®¾è®¡å®¡æŸ¥å’Œæ–½å·¥å›¾å®¡æŸ¥ç­‰ã€‚è®¾è®¡å•ä½æä¾›ç»™æ‹›æ ‡äººçš„è®¾è®¡æˆæœå¿…é¡»ä¿è¯å…¶å®Œæ•´æ€§å’Œå‡†ç¡®æ€§ã€‚&quot;</span></span><br><span class="line">     <span class="punctuation">]</span></span><br><span class="line">   <span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;12&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<h3 id="âœ…ç•™å‘"><a href="#âœ…ç•™å‘" class="headerlink" title="âœ…ç•™å‘"></a>âœ…ç•™å‘</h3><p>ç•™ä¸ªå‘ï¼Œä¸‹é¢çš„ä¼˜åŒ–æ–¹å‘æ˜¯æ›´å¥½çš„æ ¼å¼åŒ–ï¼Œæ¯”å¦‚ä»¥ç« èŠ‚åˆ†ç±»ï¼Œè¡¨æ ¼å†…å®¹ä¸­å°†è¡¨å¤´ä¿¡æ¯å†™è¿›å»ç­‰ç­‰â€¦ç°åœ¨å…ˆå»ç©ä¸‹clip(å¦ä¸€ä¸ªé¡¹ç›®å¯èƒ½è¦ç”¨)ã€‚</p>
<hr>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="1-page-extract-text"><a href="#1-page-extract-text" class="headerlink" title="1 page.extract_text"></a>1 page.extract_text</h3><p>è®¾æƒ³ä½ æœ‰ä¸€é¡µ PDFï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello   world!</span><br><span class="line">This    is   a    <span class="built_in">test</span>.</span><br></pre></td></tr></table></figure>

<p>PDF ä¸­å­—ç¬¦çš„ä½ç½®æ˜¯ç²¾ç¡®åæ ‡æ’å¸ƒçš„ï¼Œå­—ç¬¦ä¹‹é—´<strong>ä¸ä¸€å®šæœ‰çœŸæ­£çš„ç©ºæ ¼å­—ç¬¦</strong>ï¼Œå®ƒä»¬å¯èƒ½åªæ˜¯é—´éš”äº†ä¸€æ®µè·ç¦»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¸Œæœ›æŠŠå­—ç¬¦<strong>æ­£ç¡®æ‹¼æ¥æˆæœ‰ç©ºæ ¼ã€æœ‰æ¢è¡Œ</strong>çš„æ–‡æœ¬ï¼Œå°±éœ€è¦ä¾èµ– <code>.extract_text()</code> çš„å„ä¸ªå‚æ•°æ¥å¸®ä½ æ§åˆ¶æå–é€»è¾‘ã€‚</p>
<p>âœ… ç¤ºä¾‹ï¼šå¦‚ä½•ä½œç”¨çš„ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">page.extract_text(</span><br><span class="line">    x_tolerance=<span class="number">3</span>,</span><br><span class="line">    y_tolerance=<span class="number">3</span>,</span><br><span class="line">    layout=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>x_tolerance=3</code></td>
<td>ä¸¤ä¸ªå­—ç¬¦ä¹‹é—´æ°´å¹³è·ç¦»ï¼ˆä¸‹ä¸€ä¸ªå­—ç¬¦çš„ <code>x0</code> - å½“å‰å­—ç¬¦çš„ <code>x1</code>ï¼‰è¶…è¿‡ 3ï¼Œå°±è®¤ä¸ºå®ƒä»¬ä¹‹é—´æœ‰ç©ºæ ¼ã€‚å¤ªå°ä¼šæ¼æ‰ç©ºæ ¼ï¼Œå¤ªå¤§å¯èƒ½ä¹±åŠ ç©ºæ ¼ã€‚</td>
</tr>
<tr>
<td><code>y_tolerance=3</code></td>
<td>ä¸¤ä¸ªå­—ç¬¦çš„å‚ç›´ä½ç½®ï¼ˆ<code>doctop</code>ï¼‰ç›¸å·®è¶…è¿‡ 3ï¼Œå°±è®¤ä¸ºè¦æ¢è¡Œã€‚</td>
</tr>
<tr>
<td><code>layout=False</code></td>
<td>ä¸è€ƒè™‘é¡µé¢çš„åŸå§‹æ’ç‰ˆï¼ŒåªæŒ‰å­—ç¬¦é—´è·å’Œå‚ç›´å·®è·æ’å…¥ç©ºæ ¼æˆ–æ¢è¡Œã€‚</td>
</tr>
</tbody></table>
<p>ğŸ” åŠ å…¥ <code>x_tolerance_ratio</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">page.extract_text(</span><br><span class="line">    x_tolerance=<span class="literal">None</span>,</span><br><span class="line">    x_tolerance_ratio=<span class="number">0.4</span>,</span><br><span class="line">    layout=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>x_tolerance_ratio=0.4</code></td>
<td>è®¾ç½®ä¸€ä¸ªç›¸å¯¹é—´éš”é˜ˆå€¼ã€‚æ¯”å¦‚å½“å‰å­—ç¬¦å­—ä½“å¤§å°æ˜¯ <code>10</code>ï¼Œé‚£åªè¦ä¸¤ä¸ªå­—ç¬¦æ¨ªå‘é—´è· &gt; <code>10 * 0.4 = 4</code> å°±è®¤ä¸ºå®ƒä»¬ä¹‹é—´åº”è¯¥åŠ ç©ºæ ¼ã€‚ç”¨äºåº”å¯¹ä¸åŒå­—å·çš„æƒ…å†µã€‚</td>
</tr>
</tbody></table>
<p>ğŸ§± ä½¿ç”¨ <code>layout=True</code> æ¨¡æ‹ŸåŸå§‹æ’ç‰ˆ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">page.extract_text(</span><br><span class="line">    layout=<span class="literal">True</span>,</span><br><span class="line">    x_density=<span class="number">5</span>,</span><br><span class="line">    y_density=<span class="number">10</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>layout=True</code></td>
<td>æŒ‰é¡µé¢ç»“æ„æå–æ–‡æœ¬ï¼Œä¸åªæ˜¯çº¯æ‹¼æ¥å­—ç¬¦ï¼Œä¼šå°è¯•è¿˜åŸæ¢è¡Œã€åˆ—ã€æ®µè½ã€‚é€‚åˆæœ‰è¡¨æ ¼æˆ–åŒæ å†…å®¹çš„ PDFã€‚</td>
</tr>
<tr>
<td><code>x_density=5</code></td>
<td>æ§åˆ¶æ°´å¹³æ–¹å‘å¯†åº¦ã€‚å€¼è¶Šå°ï¼Œè®¤ä¸ºå­—ç¬¦é—´éš”â€œæ­£å¸¸â€çš„é˜ˆå€¼è¶Šå°ï¼Œå­—ç¬¦æ›´å®¹æ˜“è¢«æ–­å¼€æˆä¸åŒâ€œåˆ—â€ã€‚</td>
</tr>
<tr>
<td><code>y_density=10</code></td>
<td>æ§åˆ¶å‚ç›´æ–¹å‘å¯†åº¦ã€‚å€¼è¶Šå°ï¼Œæ¢è¡Œæ›´é¢‘ç¹ã€‚</td>
</tr>
</tbody></table>
<p>â†•ï¸ å­—ç¬¦&#x2F;è¡Œæ–¹å‘æ§åˆ¶</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pythonå¤åˆ¶ç¼–è¾‘page.extract_text(</span><br><span class="line">    <span class="attribute">layout</span>=<span class="literal">True</span>,</span><br><span class="line">    <span class="attribute">line_dir_render</span>=<span class="string">&quot;ttb&quot;</span>,      # è¡Œä»ä¸Šåˆ°ä¸‹</span><br><span class="line">    <span class="attribute">char_dir_render</span>=<span class="string">&quot;ltr&quot;</span>       # å­—ä»å·¦åˆ°å³</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸¤ä¸ªå‚æ•°ç”¨äºæ§åˆ¶è¾“å‡ºæ–‡æœ¬çš„æ–¹å‘ï¼Œé€‚ç”¨äºä¾‹å¦‚ç«–æ’æ—¥æ–‡ã€ç¹ä½“ä¸­æ–‡æ–‡æ¡£çš„å¸ƒå±€è§£æã€‚</p>
<hr>
<h3 id="2-ç¬¬äºŒé¡µ-ç¬¬ä¸‰é¡µ"><a href="#2-ç¬¬äºŒé¡µ-ç¬¬ä¸‰é¡µ" class="headerlink" title="2 ç¬¬äºŒé¡µ+ç¬¬ä¸‰é¡µ"></a>2 ç¬¬äºŒé¡µ+ç¬¬ä¸‰é¡µ</h3><p><strong>ç¬¬äºŒé¡µï¼š</strong></p>


<p><strong>ç¬¬ä¸‰é¡µï¼š</strong></p>


<hr>
<h3 id="3-layout-True"><a href="#3-layout-True" class="headerlink" title="3 layout&#x3D;True"></a>3 layout&#x3D;True</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line">--- ç¬¬ 1 é¡µ ---</span><br><span class="line"></span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                æ­å·å¸‚æˆ¿å±‹å»ºç­‘å’Œå¸‚æ”¿åŸºç¡€è®¾æ–½é¡¹ç›®                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                          è®¾è®¡æ‹›æ ‡æ–‡ä»¶ç¤ºèŒƒæ–‡æœ¬                                                </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                   ï¼ˆèµ„æ ¼åå®¡ï¼‰                                           </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                   ï¼ˆ2019å¹´ç‰ˆï¼‰                                         </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                            æ­å·å¸‚åŸä¹¡å»ºè®¾å§”å‘˜ä¼šåˆ¶                                             </span><br><span class="line">                                                                                    </span><br><span class="line">                                  äºŒ0äºŒäº”å¹´å››æœˆ                                           </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                          01                                        </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- ç¬¬ 2 é¡µ ---</span><br><span class="line"></span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                            å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡                                          </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                          ï¼ˆæ‹›æ ‡ç¼–å·ï¼šA3301080120526863001221ï¼‰                            </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                   æ‹›æ ‡æ–‡ä»¶                                             </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                        ï¼ˆâ˜‘èµ„æ ¼åå®¡â–¡é‚€è¯·æ‹›æ ‡ï¼‰                                                </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">            æ‹›æ ‡äººï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»ºè®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸                        ï¼ˆç›–å•ä½ç« ï¼‰                 </span><br><span class="line">                                                                                    </span><br><span class="line">                 æ‹›æ ‡ä»£ç†æœºæ„ï¼šæµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸                    ï¼ˆç›–å•ä½ç« ï¼‰                      </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                           2025å¹´05æœˆ15æ—¥                              </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                          11                                        </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- ç¬¬ 3 é¡µ ---</span><br><span class="line"></span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                ç¬¬äºŒç«        æŠ•æ ‡äººé¡»çŸ¥                                   </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                 æŠ•æ ‡äººé¡»çŸ¥å‰é™„è¡¨                                         </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">         æ¡æ¬¾å·        æ¡æ¬¾åç§°                         ç¼–åˆ—å†…å®¹                             </span><br><span class="line">                                                                                  </span><br><span class="line">                              åç§°ï¼šæ­å·æ»¨æ±Ÿå¥¥ä½“åšè§ˆåŸå¼€å‘å»º                                     </span><br><span class="line">                              è®¾è¿è¥ç®¡ç†æœ‰é™å…¬å¸                                           </span><br><span class="line">                                                                                  </span><br><span class="line">                              åœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒºæµ¦æ²¿è¡—                                     </span><br><span class="line">          1.1.2      æ‹›æ ‡äºº                                                          </span><br><span class="line">                              é“æ»¨å®‰è·¯1338å·ä¸‰æ¥¼                                         </span><br><span class="line">                              è”ç³»äººï¼šç¿æ è¶…                                             </span><br><span class="line">                              ç”µè¯ï¼š13600511926                                      </span><br><span class="line">                              åç§°ï¼š  æµ™æ±Ÿåè€€å»ºè®¾å’¨è¯¢æœ‰é™å…¬å¸                                   </span><br><span class="line">                                                                                  </span><br><span class="line">                              åœ°å€ï¼šæ­å·å¸‚ä¸ŠåŸåŒºä½°å¯Œæ—¶ä»£ä¸­å¿ƒ3å¹¢13æ¥¼                                </span><br><span class="line">          1.1.3    æ‹›æ ‡ä»£ç†æœºæ„                                                         </span><br><span class="line">                               è”ç³»äººï¼šæ½˜æ­£é˜³ã€é™ˆç‘¶                                         </span><br><span class="line">                              ç”µè¯ï¼š13758171369ã€18757567243                          </span><br><span class="line">                                  å¥¥ä½“è¡—ï¼ˆæ‰¬å¸†è·¯-å…»æ­£å··ï¼‰è®¾è®¡                                  </span><br><span class="line">          1.1.4     å·¥ç¨‹åç§°                                                          </span><br><span class="line">                              æ­å·å¸‚æ»¨æ±ŸåŒº                                              </span><br><span class="line">          1.1.5     å»ºè®¾åœ°ç‚¹                                                          </span><br><span class="line">                              è§æ‹›æ ‡å…¬å‘Š                                               </span><br><span class="line">          1.1.6     å»ºè®¾è§„æ¨¡                                                          </span><br><span class="line">                              æœ¬é¡¹ç›®æŠ•èµ„ä¼°ç®—ä¸º22798ä¸‡å…ƒ                                     </span><br><span class="line">          1.1.7     æŠ•èµ„ä¼°ç®—                                                          </span><br><span class="line">                              å›½æœ‰100%                                              </span><br><span class="line">          1.2.1   èµ„é‡‘æ¥æºåŠæ¯”ä¾‹                                                         </span><br><span class="line">                              å·²è½å®                                                 </span><br><span class="line">          1.2.2    èµ„é‡‘è½å®æƒ…å†µ                                                         </span><br><span class="line">                              â˜‘æ–¹æ¡ˆè®¾è®¡ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—ç¼–åˆ¶å’Œè°ƒæ•´ï¼‰å’Œæ–½å·¥å›¾è®¾è®¡ï¼ˆâ˜‘BIMè®¾è®¡                   </span><br><span class="line">                              æœåŠ¡ï¼‰                                                 </span><br><span class="line">                              æ‹›æ ‡å†…å®¹å…·ä½“åŒ…æ‹¬:å·¥ç¨‹è®¾è®¡æœåŠ¡å†…å®¹ï¼š        åŒ…æ‹¬ä½†ä¸é™äºï¼š                   </span><br><span class="line">                              ï¼ˆ1ï¼‰å¯ç ”ç¼–åˆ¶ï¼ˆå«ä¼°ç®—ç¼–åˆ¶ï¼‰ã€æ–¹æ¡ˆè®¾è®¡åŠæ·±åŒ–ã€åˆæ­¥è®¾è®¡ï¼ˆå«æ¦‚ç®—                     </span><br><span class="line">                              ç¼–åˆ¶ï¼‰ã€æ–½å·¥å›¾è®¾è®¡ã€å«BIMï¼ˆè‹¥æœ‰ï¼‰ã€‘ã€ç®¡çº¿ç»¼åˆã€äº¤æ”¹è®¾è®¡ï¼ˆè‹¥                     </span><br><span class="line">                              æœ‰ï¼Œå«ä¸»ä½“é¡¹ç›®äº¤æ”¹ä»¥åŠå…¶ä»–é…å¥—äº¤æ”¹è®¾è®¡ï¼‰ã€é›¨æ±¡æ°´ç®¡çº¿è¿æ”¹ï¼ˆè‹¥                      </span><br><span class="line">                              æœ‰ï¼‰ã€åŸºå‘è®¾è®¡ã€æŠ¥æ‰¹å®¡æŸ¥é…åˆã€æŒ‰å®¡æŸ¥å’Œæ‹›æ ‡äººæ„è§å¯¹æ•´ä¸ªè®¾è®¡è¿‡ç¨‹                     </span><br><span class="line">                              çš„ä¿®æ”¹ã€æ·±åŒ–æ•´åˆç­‰ä¼˜åŒ–è®¾è®¡ï¼›                                      </span><br><span class="line">          1.3.1     æ‹›æ ‡èŒƒå›´                                                          </span><br><span class="line">                              ï¼ˆ2ï¼‰æŒ‰æ‹›æ ‡æ–‡ä»¶è¦æ±‚æä¾›çº¸è´¨å’Œç”µå­å›¾çº¸ï¼›                                </span><br><span class="line">                              ï¼ˆ3ï¼‰è®¾è®¡è¡¥å›¾å’Œå·¥ç¨‹æ–½å·¥é˜¶æ®µçš„å˜æ›´è”ç³»å•ï¼›                               </span><br><span class="line">                              ï¼ˆ4ï¼‰æ–½å·¥é…åˆã€éªŒæ”¶é…åˆã€ç«£å·¥å›¾ç¼–åˆ¶é…åˆç­‰ç›¸å…³æœåŠ¡ï¼›                          </span><br><span class="line">                              ï¼ˆ5ï¼‰æ ¹æ®å·¥ç¨‹å®é™…éœ€è¦æä¾›ç°åœºæœåŠ¡ç­‰ã€‚                                 </span><br><span class="line">                              å„é˜¶æ®µè®¾è®¡æˆæœåº”ç¬¦åˆå›½å®¶è§„å®šçš„å›¾çº¸ç¼–åˆ¶æ·±åº¦è¦æ±‚åŠç›¸å…³å‡ºå›¾æ ‡å‡†è¦                     </span><br><span class="line">                              æ±‚ä¸”åº”æ»¡è¶³å‘åŒ…äººçš„ç›¸å…³è¦æ±‚ï¼Œå¹¶åº”åŠæ—¶å®Œæˆæ‹›æ ‡äººå’Œç›¸å…³å®¡æŸ¥éƒ¨é—¨çš„                     </span><br><span class="line">                              é˜¶æ®µæ€§å®¡æŸ¥æ„è§æ‰€æå‡ºçš„ä¿®æ”¹å·¥ä½œç­‰ï¼Œç‰¹åˆ«æ˜¯ç›¸å…³éƒ¨é—¨ä¸è®¡æ¬¡æ•°çš„ä¼˜åŒ–                     </span><br><span class="line">                                                                                  </span><br><span class="line">                              ä¿®æ”¹è¦æ±‚ç­‰ã€‚é˜¶æ®µæ€§å®¡æŸ¥åŒ…æ‹¬æ–¹æ¡ˆè¯„å®¡ã€åˆæ­¥è®¾è®¡å®¡æŸ¥å’Œæ–½å·¥å›¾å®¡æŸ¥                      </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                         12                                       </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-table-settings"><a href="#4-table-settings" class="headerlink" title="4 table_settings"></a>4 table_settings</h3><p><strong>âš™ï¸ è¡¨æ ¼æå–è®¾ç½®ï¼ˆ<code>table_settings</code>ï¼‰</strong></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>.extract_tables()</code> ä½¿ç”¨é¡µé¢çš„æ°´å¹³ä¸å‚ç›´çº¿ï¼ˆåŒ…æ‹¬çŸ©å½¢è¾¹ï¼‰ä½œä¸ºå•å…ƒæ ¼è¾¹ç•Œã€‚ä½†ä½ å¯ä»¥é€šè¿‡ <code>table_settings</code> è‡ªå®šä¹‰ç­–ç•¥å’Œé˜ˆå€¼ã€‚ç¤ºä¾‹è®¾ç½®åŠé»˜è®¤å€¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;vertical_strategy&quot;</span>: <span class="string">&quot;lines&quot;</span>,</span><br><span class="line">  <span class="string">&quot;horizontal_strategy&quot;</span>: <span class="string">&quot;lines&quot;</span>,</span><br><span class="line">  <span class="string">&quot;explicit_vertical_lines&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;explicit_horizontal_lines&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;snap_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;snap_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;snap_y_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;join_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;join_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;join_y_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;edge_min_length&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;min_words_vertical&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;min_words_horizontal&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;intersection_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;intersection_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;intersection_y_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;text_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;text_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;text_y_tolerance&quot;</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸ§¾ æ¯ä¸ªå‚æ•°è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>vertical_strategy</code>, <code>horizontal_strategy</code></td>
<td>å¯é€‰ï¼š<code>&quot;lines&quot;</code>, <code>&quot;lines_strict&quot;</code>, <code>&quot;text&quot;</code>, <code>&quot;explicit&quot;</code>ï¼Œè§ä¸‹æ–‡ç­–ç•¥è§£é‡Šã€‚</td>
</tr>
<tr>
<td><code>explicit_vertical_lines</code>, <code>explicit_horizontal_lines</code></td>
<td>æ˜¾å¼æŒ‡å®šç”¨äºè¡¨æ ¼çš„å‚ç›´&#x2F;æ°´å¹³çº¿åˆ—è¡¨ï¼Œå¯ä¸ºæ•°å­—æˆ–çº¿æ¡å¯¹è±¡ã€‚</td>
</tr>
<tr>
<td><code>snap_*_tolerance</code></td>
<td>å¹³è¡Œçº¿åœ¨è¯¥èŒƒå›´å†…å°†è¢«â€œå¸é™„â€åˆ°ç›¸åŒä½ç½®ã€‚</td>
</tr>
<tr>
<td><code>join_*_tolerance</code></td>
<td>å…±çº¿çº¿æ®µè‹¥ç«¯ç‚¹é—´è·å°äºæ­¤å€¼å°†è¢«åˆå¹¶ä¸ºä¸€æ¡çº¿æ®µã€‚</td>
</tr>
<tr>
<td><code>edge_min_length</code></td>
<td>å¿½ç•¥çŸ­äºæ­¤å€¼çš„çº¿æ®µã€‚</td>
</tr>
<tr>
<td><code>min_words_vertical</code>, <code>min_words_horizontal</code></td>
<td>ä½¿ç”¨ <code>&quot;text&quot;</code> ç­–ç•¥æ—¶ï¼Œéœ€æœ‰å¤šå°‘å•è¯å¯¹é½æ‰èƒ½æ¨æ–­å‡ºçº¿ã€‚</td>
</tr>
<tr>
<td><code>intersection_*_tolerance</code></td>
<td>ç»„åˆè¾¹æˆå•å…ƒæ ¼æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦äº¤å‰çš„å®¹å·®èŒƒå›´ã€‚</td>
</tr>
<tr>
<td><code>text_*</code></td>
<td>æ§åˆ¶ä»è¡¨æ ¼ä¸­æå–æ–‡å­—çš„å‚æ•°ï¼Œæ”¯æŒæ‰€æœ‰ <code>.extract_text(...)</code> ä¸­çš„å‚æ•°ã€‚</td>
</tr>
</tbody></table>
<p>ğŸ§  è¡¨æ ¼æå–ç­–ç•¥è§£é‡Šï¼š</p>
<table>
<thead>
<tr>
<th>ç­–ç•¥</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>&quot;lines&quot;</code></td>
<td>ä½¿ç”¨å›¾å½¢çº¿æ¡ï¼ˆåŒ…æ‹¬çŸ©å½¢è¾¹ï¼‰ä½œä¸ºå•å…ƒæ ¼è¾¹ç•Œã€‚</td>
</tr>
<tr>
<td><code>&quot;lines_strict&quot;</code></td>
<td>ä½¿ç”¨å›¾å½¢çº¿æ¡ï¼ˆä¸åŒ…æ‹¬çŸ©å½¢è¾¹ï¼‰ä½œä¸ºå•å…ƒæ ¼è¾¹ç•Œã€‚</td>
</tr>
<tr>
<td><code>&quot;text&quot;</code></td>
<td>æ ¹æ®æ–‡å­—çš„å·¦&#x2F;ä¸­&#x2F;å³å¯¹é½ï¼ˆå‚ç›´ç­–ç•¥ï¼‰æˆ–é¡¶éƒ¨å¯¹é½ï¼ˆæ°´å¹³ç­–ç•¥ï¼‰æ¨æ–­å‡ºè™šæ‹Ÿçº¿æ¡ä½œä¸ºå•å…ƒæ ¼è¾¹ç•Œã€‚</td>
</tr>
<tr>
<td><code>&quot;explicit&quot;</code></td>
<td>ä»…ä½¿ç”¨æ˜¾å¼å®šä¹‰çš„çº¿æ¡ï¼ˆ<code>explicit_*_lines</code> å‚æ•°æä¾›ï¼‰ã€‚</td>
</tr>
</tbody></table>
<p>ğŸ“ è¯´æ˜</p>
<ul>
<li>åœ¨æå–è¡¨æ ¼å‰ä½¿ç”¨ <code>Page.crop(...)</code> è£å‰ªé¡µé¢ï¼Œå¾€å¾€å¯ä»¥æé«˜ç²¾åº¦ã€‚</li>
</ul>
<hr>
<h3 id="5-extract-words-â€¦"><a href="#5-extract-words-â€¦" class="headerlink" title="5 extract_words(â€¦)"></a>5 extract_words(â€¦)</h3><p><code>.extract_words()</code> æ–¹æ³•è¯´æ˜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.extract_words(</span><br><span class="line">    x_tolerance=<span class="number">3</span>,</span><br><span class="line">    x_tolerance_ratio=<span class="literal">None</span>,</span><br><span class="line">    y_tolerance=<span class="number">3</span>,</span><br><span class="line">    keep_blank_chars=<span class="literal">False</span>,</span><br><span class="line">    use_text_flow=<span class="literal">False</span>,</span><br><span class="line">    line_dir=<span class="string">&quot;ttb&quot;</span>,</span><br><span class="line">    char_dir=<span class="string">&quot;ltr&quot;</span>,</span><br><span class="line">    line_dir_rotated=<span class="string">&quot;ttb&quot;</span>,</span><br><span class="line">    char_dir_rotated=<span class="string">&quot;ltr&quot;</span>,</span><br><span class="line">    extra_attrs=[],</span><br><span class="line">    split_at_punctuation=<span class="literal">False</span>,</span><br><span class="line">    expand_ligatures=<span class="literal">True</span>,</span><br><span class="line">    return_chars=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª <strong>æ‰€æœ‰â€œçœ‹èµ·æ¥åƒå•è¯â€çš„æ–‡æœ¬åŠå…¶è¾¹ç•Œæ¡†</strong> çš„åˆ—è¡¨ã€‚</p>
<p>ğŸ” å•è¯è¯†åˆ«é€»è¾‘</p>
<ul>
<li><strong>é€šå¸¸å­—ç¬¦ï¼ˆuprightï¼‰</strong>ï¼šè‹¥ä¸€ä¸ªå­—ç¬¦çš„ <code>x1</code> ä¸ä¸‹ä¸€ä¸ªå­—ç¬¦çš„ <code>x0</code> ä¹‹é—´çš„è·ç¦» â‰¤ <code>x_tolerance</code>ï¼Œä¸”ä¸¤è€…çš„ <code>doctop</code> å·®å€¼ â‰¤ <code>y_tolerance</code>ï¼Œåˆ™è¢«è§†ä¸ºåŒä¸€ä¸ªå•è¯çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><strong>è‹¥è®¾ç½®äº† <code>x_tolerance_ratio</code></strong>ï¼Œåˆ™ <code>x_tolerance</code> ä¼šæ ¹æ®å­—ç¬¦å°ºå¯¸åŠ¨æ€è°ƒæ•´ï¼š<br> <code>x_tolerance = x_tolerance_ratio * previous_character[&quot;size&quot;]</code></li>
<li><strong>éæ­£ç«‹å­—ç¬¦</strong>ï¼ˆä¾‹å¦‚æ—‹è½¬è¿‡çš„æ–‡å­—ï¼‰ï¼šé‡‡ç”¨å‚ç›´è·ç¦»è€Œéæ°´å¹³è·ç¦»è¿›è¡Œåˆ¤æ–­ã€‚</li>
</ul>
<p>âš™ï¸ å‚æ•°è¯´æ˜</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>x_tolerance</code></td>
<td>åŒä¸€è¡Œå­—ç¬¦åœ¨æ°´å¹³æ–¹å‘ä¸Šé—´è·çš„å®¹å·®ã€‚</td>
</tr>
<tr>
<td><code>x_tolerance_ratio</code></td>
<td>åŠ¨æ€å®¹å·®æ¯”å€¼ï¼ŒåŸºäºå­—ç¬¦å¤§å°è®¡ç®—ã€‚è‹¥ä¸ä¸º Noneï¼Œåˆ™è¦†ç›– <code>x_tolerance</code>ã€‚</td>
</tr>
<tr>
<td><code>y_tolerance</code></td>
<td>åˆ¤æ–­å­—ç¬¦æ˜¯å¦åœ¨åŒä¸€è¡Œçš„å‚ç›´å®¹å·®ã€‚</td>
</tr>
<tr>
<td><code>keep_blank_chars</code></td>
<td>æ˜¯å¦ä¿ç•™ç©ºæ ¼å­—ç¬¦ä¸ºå•è¯çš„ä¸€éƒ¨åˆ†ï¼ˆé»˜è®¤å¦ï¼‰ã€‚è®¾ä¸º <code>True</code> è¡¨ç¤ºç©ºæ ¼ä¹Ÿè§†ä¸ºå­—ç¬¦ï¼Œä¸å°†å…¶ä½œä¸ºå•è¯åˆ†éš”ç¬¦ã€‚</td>
</tr>
<tr>
<td><code>use_text_flow</code></td>
<td>æ˜¯å¦ä¾æ® PDF å†…éƒ¨çš„å­—ç¬¦æµé¡ºåºæ’åˆ—ä¸åˆ†ç»„æ–‡æœ¬ï¼ˆæ¨¡æ‹Ÿæ–‡æœ¬æ‹–é€‰æ•ˆæœï¼‰ï¼Œè€Œä¸æ˜¯æŒ‰åæ ‡ä½ç½®æ’åºã€‚</td>
</tr>
<tr>
<td><code>line_dir</code></td>
<td>æœŸæœ›çš„è¡Œæ’åˆ—æ–¹å‘ï¼š <code>&quot;ttb&quot;</code>ï¼ˆä¸Šåˆ°ä¸‹ï¼‰ã€<code>&quot;btt&quot;</code>ï¼ˆä¸‹åˆ°ä¸Šï¼‰ã€‚</td>
</tr>
<tr>
<td><code>char_dir</code></td>
<td>æœŸæœ›çš„å­—ç¬¦æ’åˆ—æ–¹å‘ï¼š <code>&quot;ltr&quot;</code>ï¼ˆå·¦åˆ°å³ï¼‰ã€<code>&quot;rtl&quot;</code>ï¼ˆå³åˆ°å·¦ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>line_dir_rotated</code></td>
<td>æ—‹è½¬æ–‡æœ¬çš„è¡Œæ’åˆ—æ–¹å‘ã€‚</td>
</tr>
<tr>
<td><code>char_dir_rotated</code></td>
<td>æ—‹è½¬æ–‡æœ¬çš„å­—ç¬¦æ’åˆ—æ–¹å‘ã€‚</td>
</tr>
<tr>
<td><code>extra_attrs</code></td>
<td>é™å®šå•è¯å¿…é¡»ç”±å…·æœ‰å®Œå…¨ç›¸åŒå±æ€§çš„å­—ç¬¦ç»„æˆï¼Œå¦‚ <code>[&quot;fontname&quot;, &quot;size&quot;]</code>ã€‚æå–ç»“æœä¸­ä¼šåŒ…å«è¿™äº›å±æ€§ã€‚</td>
</tr>
<tr>
<td><code>split_at_punctuation</code></td>
<td>æ˜¯å¦åœ¨æ ‡ç‚¹å¤„åˆ†è¯ï¼Œè®¾ä¸º <code>True</code> è¡¨ç¤ºåœ¨æ ‡ç‚¹å¤„å¼ºåˆ¶åˆ‡è¯ã€‚ä¹Ÿå¯ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ <code>&#39;!.,;&#39;</code> è‡ªå®šä¹‰æ ‡ç‚¹ã€‚</td>
</tr>
<tr>
<td><code>expand_ligatures</code></td>
<td>æ˜¯å¦å°†è¿å­—ï¼ˆå¦‚ <code>ï¬</code>ï¼‰æ‹†ä¸ºå…¶ç»„æˆå­—æ¯ï¼ˆå¦‚ <code>f</code> å’Œ <code>i</code>ï¼‰ã€‚é»˜è®¤ <code>True</code>ã€‚</td>
</tr>
<tr>
<td><code>return_chars</code></td>
<td>æ˜¯å¦åœ¨æ¯ä¸ªå•è¯å­—å…¸ä¸­æ·»åŠ æ„æˆå®ƒçš„å­—ç¬¦åˆ—è¡¨ï¼ˆä½œä¸º <code>&quot;chars&quot;</code> å­—æ®µï¼‰ã€‚</td>
</tr>
</tbody></table>
<p>ğŸ“¦ è¿”å›å€¼ç»“æ„ï¼ˆåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå­—å…¸ï¼‰</p>
<p>æ¯ä¸ªâ€œå•è¯â€åŒ…å«å¦‚ä¸‹å­—æ®µï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;text&quot;</span>: <span class="string">&quot;å•è¯å†…å®¹&quot;</span>,</span><br><span class="line">  <span class="string">&quot;x0&quot;</span>: 100.0,</span><br><span class="line">  <span class="string">&quot;x1&quot;</span>: 130.5,</span><br><span class="line">  <span class="string">&quot;top&quot;</span>: 90.2,</span><br><span class="line">  <span class="string">&quot;bottom&quot;</span>: 103.6,</span><br><span class="line">  <span class="string">&quot;doctop&quot;</span>: 290.2,</span><br><span class="line">  <span class="string">&quot;chars&quot;</span>: [ &#123;...&#125;, &#123;...&#125; ]  <span class="comment"># ä»…å½“ return_chars=True æ—¶æä¾›</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>âœ… ç¤ºä¾‹ç”¨æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;example.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">0</span>]</span><br><span class="line">    words = page.extract_words(x_tolerance=<span class="number">2</span>, y_tolerance=<span class="number">2</span>, return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å•è¯: <span class="subst">&#123;word[<span class="string">&#x27;text&#x27;</span>]&#125;</span>, ä½ç½®: (<span class="subst">&#123;word[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;top&#x27;</span>]&#125;</span>) - (<span class="subst">&#123;word[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-extract-words-vs-extract-text-lines"><a href="#6-extract-words-vs-extract-text-lines" class="headerlink" title="6 extract_words() vs extract_text_lines()"></a>6 extract_words() vs extract_text_lines()</h3><p><code>.extract_text_lines()</code> å’Œ <code>.extract_words()</code> <strong>åœ¨è¾“å‡ºç»“æ„ä¸Šæœ‰ç›¸ä¼¼ä¹‹å¤„</strong>ï¼Œä½†å®ƒä»¬å…³æ³¨çš„<strong>ç²’åº¦å’Œåº”ç”¨åœºæ™¯ä¸åŒ</strong>ï¼š</p>
<p>ğŸ†š <code>.extract_words()</code> vs <code>.extract_text_lines()</code></p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th><code>.extract_words()</code></th>
<th><code>.extract_text_lines()</code></th>
</tr>
</thead>
<tbody><tr>
<td>ğŸ“¦ ç²’åº¦</td>
<td><strong>æŒ‰å•è¯</strong>åˆ’åˆ†</td>
<td><strong>æŒ‰æ–‡æœ¬è¡Œ</strong>åˆ’åˆ†</td>
</tr>
<tr>
<td>ğŸ“ åæ ‡</td>
<td>æ¯ä¸ªè¯çš„ <code>x0, top, x1, bottom</code></td>
<td>æ¯è¡Œæ–‡æœ¬çš„ <code>x0, top, x1, bottom</code></td>
</tr>
<tr>
<td>ğŸ”  å†…å®¹ç»„ç»‡</td>
<td>æ¯ä¸ªè¯æ˜¯ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡</td>
<td>æ¯è¡Œæ˜¯ä¸€ä¸ªæ•´ä½“ï¼ˆåŒ…å«å¤šä¸ªå­—ç¬¦æˆ–è¯ï¼‰</td>
</tr>
<tr>
<td>ğŸ” å¯é€‰å†…å®¹</td>
<td>å¯åŠ  <code>return_chars=True</code> è¿”å›ç»„æˆè¯çš„å­—ç¬¦</td>
<td>é»˜è®¤å¯è¿”å›æ¯è¡Œå­—ç¬¦ï¼ˆåŒæ ·ç”¨ <code>return_chars=True</code>ï¼‰</td>
</tr>
<tr>
<td>ğŸ§­ æ’åºä¾æ®</td>
<td>ä¸»è¦é å­—ç¬¦ä¹‹é—´çš„æ°´å¹³&#x2F;å‚ç›´è·ç¦»ï¼ˆé»˜è®¤ <code>x/y_tolerance</code>ï¼‰</td>
<td>å¯é€‰æ‹© layout æ–¹å¼ï¼Œä¾èµ–ç‰ˆå¼æµï¼ˆ<code>layout=True</code>ï¼‰</td>
</tr>
<tr>
<td>ğŸ§© åº”ç”¨åœºæ™¯</td>
<td>æå–å…³é”®å­—æ®µã€è¯çº§å¤„ç†ã€æœç´¢</td>
<td>ç²¾å‡†è¿˜åŸè¡Œç»“æ„ã€é€è¡Œå¤„ç†ã€OCR åå¤„ç†</td>
</tr>
</tbody></table>
<p>âœ… ä¸¾ä¾‹è¯´æ˜å·®åˆ«</p>
<p>å‡è®¾ä½ æœ‰ä¸€é¡µ PDF å†…å®¹æ˜¯ï¼š</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é¡¹ç›®åç§°ï¼šXXå·¥ç¨‹é¡¹ç›®</span><br><span class="line">æ‹›æ ‡äººï¼šYYå…¬å¸</span><br></pre></td></tr></table></figure>

<p>ç”¨ <code>.extract_words()</code> è¾“å‡ºï¼ˆæŒ‡å®š<code>split_at_punctuation=True</code>ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;é¡¹ç›®åç§°&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., <span class="string">&#x27;top&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;ï¼š&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;XXå·¥ç¨‹é¡¹ç›®&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;æ‹›æ ‡äºº&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;ï¼š&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;YYå…¬å¸&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‰ ä½ å¾—åˆ°çš„æ˜¯<strong>è¯çº§</strong>åˆ‡åˆ†ï¼Œé€‚åˆåšå…³é”®è¯åŒ¹é…æˆ–ç»“æ„åŒ–æå–ã€‚</p>
<p>ç”¨ <code>.extract_text_lines()</code> è¾“å‡ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;é¡¹ç›®åç§°ï¼šXXå·¥ç¨‹é¡¹ç›®&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;chars&#x27;</span>: [...],  <span class="comment"># æ‰€æœ‰å­—ç¬¦è¯¦ç»†ä½ç½®</span></span><br><span class="line">    <span class="string">&#x27;x0&#x27;</span>: ..., <span class="string">&#x27;top&#x27;</span>: ..., ...</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;æ‹›æ ‡äººï¼šYYå…¬å¸&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;chars&#x27;</span>: [...],</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‰ ä½ å¾—åˆ°çš„æ˜¯<strong>æ•´è¡Œä¿¡æ¯</strong>ï¼Œéå¸¸é€‚åˆåšï¼š</p>
<ul>
<li>OCRç»“æœè¿˜åŸ</li>
<li>æŒ‰è¡Œåˆ†ç»„å¤„ç†ï¼ˆæ¯”å¦‚â€æ‹›æ ‡äººâ€æ˜¯ keyï¼Œâ€YYå…¬å¸â€æ˜¯ valueï¼‰</li>
</ul>
<p>ğŸ¯ æ€»ç»“å»ºè®®</p>
<table>
<thead>
<tr>
<th>ç›®æ ‡</th>
<th>æ¨èæ–¹æ³•</th>
</tr>
</thead>
<tbody><tr>
<td>å…³é”®è¯å®šä½ã€å­—æ®µæŠ½å–</td>
<td><code>.extract_words()</code></td>
</tr>
<tr>
<td>ä¿æŒ PDF åŸæœ‰æ’ç‰ˆé¡ºåºã€è¡Œçº§å¤„ç†</td>
<td><code>.extract_text_lines()</code></td>
</tr>
<tr>
<td>ç²¾ç»†å­—ç¬¦ä½ç½®åˆ†æ</td>
<td>ä»»æ„æ–¹æ³• + <code>return_chars=True</code></td>
</tr>
</tbody></table>
<hr>
<h3 id="7-search"><a href="#7-search" class="headerlink" title="7 search"></a>7 search</h3><p>ğŸ“˜ <code>.search()</code> æ–¹æ³•è¯´æ˜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page.search(pattern, regex=<span class="literal">True</span>, <span class="keyword">case</span>=<span class="literal">True</span>, main_group=<span class="number">0</span>,</span><br><span class="line">            return_groups=<span class="literal">True</span>, return_chars=<span class="literal">True</span>,</span><br><span class="line">            layout=<span class="literal">False</span>, **kwargs)</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ä¸€ä¸ª<strong>å®éªŒæ€§åŠŸèƒ½</strong>ï¼Œç”¨äºåœ¨é¡µé¢ä¸­æœç´¢åŒ¹é…çš„æ–‡æœ¬ï¼Œè¿”å›æ‰€æœ‰åŒ¹é…é¡¹çš„åˆ—è¡¨ã€‚</p>
<p>ğŸ“Œ å‚æ•°è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>pattern</code></td>
<td>æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥æ˜¯ç¼–è¯‘æˆ–æœªç¼–è¯‘çš„ regexï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><code>regex</code></td>
<td>å¦‚æœä¸º <code>False</code>ï¼Œåˆ™ <code>pattern</code> è¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²å¤„ç†ï¼ˆéæ­£åˆ™è¡¨è¾¾å¼ï¼‰</td>
</tr>
<tr>
<td><code>case</code></td>
<td>ä¸º <code>False</code> æ—¶å¿½ç•¥å¤§å°å†™</td>
</tr>
<tr>
<td><code>main_group</code></td>
<td>æŒ‡å®šä¸»è¿”å›çš„æ­£åˆ™åˆ†ç»„ï¼ˆé»˜è®¤ <code>0</code> è¡¨ç¤ºæ•´ä½“åŒ¹é…ï¼‰</td>
</tr>
<tr>
<td><code>return_groups</code></td>
<td>å¦‚æœè®¾ä¸º <code>False</code>ï¼Œå°†ä¸è¿”å›æ­£åˆ™åˆ†ç»„åŒ¹é…ç»“æœ</td>
</tr>
<tr>
<td><code>return_chars</code></td>
<td>å¦‚æœè®¾ä¸º <code>False</code>ï¼Œä¸è¿”å›åŒ¹é…å­—ç¬¦çš„å­—ç¬¦å¯¹è±¡åˆ—è¡¨</td>
</tr>
<tr>
<td><code>layout</code></td>
<td>ä¸ <code>.extract_text()</code> çš„ layout å‚æ•°ç›¸åŒï¼Œæ˜¯å¦æŒ‰å¸ƒå±€æ–¹å¼åˆ†ææ–‡æœ¬</td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td>å…¶ä»–ä¼ ç»™ <code>.extract_text(layout=True, ...)</code> çš„å‚æ•°</td>
</tr>
</tbody></table>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<strong>åŒ¹é…ä¸ºç©ºå­—ç¬¦ä¸²æˆ–å…¨ç©ºæ ¼çš„ç»“æœä¼šè¢«è‡ªåŠ¨å¿½ç•¥</strong>ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æ²¡æœ‰å®é™…çš„é¡µé¢ä½ç½®ï¼ˆbboxï¼‰ã€‚</p>
</blockquote>
<p>âœ… ä½¿ç”¨ç¤ºä¾‹ï¼ˆæœç´¢â€œæ‹›æ ‡äººâ€å¹¶è¾“å‡ºå…¶ä½ç½®ä¿¡æ¯ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ PDF æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;example.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æœç´¢å…³é”®è¯â€œæ‹›æ ‡äººâ€</span></span><br><span class="line">    results = page.search(<span class="string">&quot;æ‹›æ ‡äºº&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, <span class="keyword">match</span> <span class="keyword">in</span> <span class="built_in">enumerate</span>(results):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç¬¬ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> ä¸ªåŒ¹é…ï¼š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; - åŒ¹é…æ–‡æœ¬ï¼š&quot;</span>, <span class="keyword">match</span>[<span class="string">&quot;text&quot;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; - ä½ç½®ï¼š&quot;</span>, <span class="keyword">match</span>[<span class="string">&quot;x0&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;top&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;x1&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;bottom&quot;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; - æ‰€å«å­—ç¬¦æ•°é‡ï¼š&quot;</span>, <span class="built_in">len</span>(<span class="keyword">match</span>[<span class="string">&quot;chars&quot;</span>]))</span><br></pre></td></tr></table></figure>

<p>âœ… ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤æ‚åŒ¹é…ï¼ˆå¦‚æå–â€œé¡¹ç›®åç§°ï¼šXXXâ€ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;é¡¹ç›®åç§°[ï¼š:]?\s*(\S+)&quot;</span>)</span><br><span class="line">results = page.search(pattern)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> results:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ä¸»åŒ¹é…æ–‡æœ¬ï¼š&quot;</span>, r[<span class="string">&quot;text&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åˆ™åˆ†ç»„ï¼ˆé¡¹ç›®åï¼‰ï¼š&quot;</span>, r[<span class="string">&quot;groups&quot;</span>][<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ä½ç½®ï¼š&quot;</span>, r[<span class="string">&quot;x0&quot;</span>], r[<span class="string">&quot;top&quot;</span>], r[<span class="string">&quot;x1&quot;</span>], r[<span class="string">&quot;bottom&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>ğŸ’¡ å¸¸è§ç”¨é€”åœºæ™¯ï¼š</p>
<ul>
<li>ç²¾ç¡®å®šä½å…³é”®è¯åœ¨é¡µé¢ä¸­çš„ä½ç½®ï¼ˆæ¯”å¦‚â€œå¼€æ ‡æ—¶é—´â€ã€â€œè”ç³»äººâ€ï¼‰</li>
<li>åšç»“æ„åŒ–ä¿¡æ¯æå–ï¼ˆä½¿ç”¨æ­£åˆ™æå–â€œé”®ï¼šå€¼â€ç»“æ„ï¼‰</li>
<li>åšè¡¨å•&#x2F;æ¨¡æ¿å­—æ®µåŒ¹é…ï¼ˆæ¯”å¦‚è¯†åˆ«â€œç¨å·ï¼š123456â€ï¼‰</li>
</ul>
<hr>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/pdf/" rel="tag"># pdf</a>
              <a href="/tags/pdfplumber/" rel="tag"># pdfplumber</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/05/30/PDF%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7%EF%BC%9AMinerU%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" rel="prev" title="PDFè§£æå·¥å…·ï¼šMinerUå®‰è£…ä¸ä½¿ç”¨">
                  <i class="fa fa-angle-left"></i> PDFè§£æå·¥å…·ï¼šMinerUå®‰è£…ä¸ä½¿ç”¨
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/07/CLIP%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" rel="next" title="CLIPå®‰è£…ä¸ä½¿ç”¨">
                  CLIPå®‰è£…ä¸ä½¿ç”¨ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Chr</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">279k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">16:56</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","src":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
