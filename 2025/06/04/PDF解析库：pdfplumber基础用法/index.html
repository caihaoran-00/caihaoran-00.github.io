<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"caihaoran-00.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="前言在LLM应用：结构化提取及后续思路一文中，我们使用pdfplumber的.extract_text方法，但这个方法会将全文（尤其指表格部分）当做普通文本按行读取，会完全丢失表格的格式，察觉pdfplumber库的用法有些学问，遂准备本文记录下pdfplumber的基础用法，目的是自动化的判别是普通文本还是表格，表格数据用表格提取的方式，普通文本用文本提取的方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="PDF解析库：pdfplumber基础用法">
<meta property="og:url" content="https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/index.html">
<meta property="og:site_name" content="Chr&#39;s Blog">
<meta property="og:description" content="前言在LLM应用：结构化提取及后续思路一文中，我们使用pdfplumber的.extract_text方法，但这个方法会将全文（尤其指表格部分）当做普通文本按行读取，会完全丢失表格的格式，察觉pdfplumber库的用法有些学问，遂准备本文记录下pdfplumber的基础用法，目的是自动化的判别是普通文本还是表格，表格数据用表格提取的方式，普通文本用文本提取的方法。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-06-04T01:31:48.000Z">
<meta property="article:modified_time" content="2025-06-07T11:16:32.080Z">
<meta property="article:author" content="Chr">
<meta property="article:tag" content="pdf">
<meta property="article:tag" content="pdfplumber">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/","path":"2025/06/04/PDF解析库：pdfplumber基础用法/","title":"PDF解析库：pdfplumber基础用法"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>PDF解析库：pdfplumber基础用法 | Chr's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Chr's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Record and Share</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-number">2.</span> <span class="nav-text">基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80-Page-chars"><span class="nav-number">2.1.</span> <span class="nav-text">一 Page.chars</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C-im-draw-rect-%E2%80%A6"><span class="nav-number">2.2.</span> <span class="nav-text">二 im.draw_rect(…)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89-%E6%96%87%E6%9C%AC%E6%8F%90%E5%8F%96"><span class="nav-number">2.3.</span> <span class="nav-text">三 文本提取</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Page-extract-text-%E2%80%A6"><span class="nav-number">2.3.1.</span> <span class="nav-text">1. Page.extract_text(…)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-extract-words-%E2%80%A6"><span class="nav-number">2.3.2.</span> <span class="nav-text">2. extract_words(…)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-extract-text-lines-%E2%80%A6"><span class="nav-number">2.3.3.</span> <span class="nav-text">3. extract_text_lines(…)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-search-%E2%80%A6"><span class="nav-number">2.3.4.</span> <span class="nav-text">4. search(…)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B-%E8%A1%A8%E6%A0%BC%E6%8F%90%E5%8F%96"><span class="nav-number">2.4.</span> <span class="nav-text">四 表格提取</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-extract-tables-%E2%80%A6"><span class="nav-number">2.4.1.</span> <span class="nav-text">1. extract_tables(…)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-find-tables-%E2%80%A6"><span class="nav-number">2.4.2.</span> <span class="nav-text">2. find_tables(…)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%AF%B9%E6%AF%94"><span class="nav-number">2.4.3.</span> <span class="nav-text">3. 对比</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94-Page-crop-%E2%80%A6"><span class="nav-number">2.5.</span> <span class="nav-text">五 Page.crop(…)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%9C%85%E6%AD%A3%E6%96%87"><span class="nav-number">3.</span> <span class="nav-text">✅正文</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%B7%E5%90%88%E8%A1%A8%E6%A0%BC-%E6%96%87%E6%9C%AC"><span class="nav-number">3.1.</span> <span class="nav-text">混合表格&#x2F;文本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85%E7%95%99%E5%9D%91"><span class="nav-number">3.2.</span> <span class="nav-text">✅留坑</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%84%E5%BD%95"><span class="nav-number">4.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-page-extract-text"><span class="nav-number">4.1.</span> <span class="nav-text">1 page.extract_text</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%AC%AC%E4%BA%8C%E9%A1%B5-%E7%AC%AC%E4%B8%89%E9%A1%B5"><span class="nav-number">4.2.</span> <span class="nav-text">2 第二页+第三页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-layout-True"><span class="nav-number">4.3.</span> <span class="nav-text">3 layout&#x3D;True</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-table-settings"><span class="nav-number">4.4.</span> <span class="nav-text">4 table_settings</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-extract-words-%E2%80%A6"><span class="nav-number">4.5.</span> <span class="nav-text">5 extract_words(…)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-extract-words-vs-extract-text-lines"><span class="nav-number">4.6.</span> <span class="nav-text">6 extract_words() vs extract_text_lines()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-search"><span class="nav-number">4.7.</span> <span class="nav-text">7 search</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chr</p>
  <div class="site-description" itemprop="description">Welcome to my little world</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">90</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:1299964565@qq.com" title="E-Mail → mailto:1299964565@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://caihaoran-00.github.io/2025/06/04/PDF%E8%A7%A3%E6%9E%90%E5%BA%93%EF%BC%9Apdfplumber%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chr">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chr's Blog">
      <meta itemprop="description" content="Welcome to my little world">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="PDF解析库：pdfplumber基础用法 | Chr's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PDF解析库：pdfplumber基础用法
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-04 09:31:48" itemprop="dateCreated datePublished" datetime="2025-06-04T09:31:48+08:00">2025-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-06-07 19:16:32" itemprop="dateModified" datetime="2025-06-07T19:16:32+08:00">2025-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>16k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>57 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在<a href="https://caihaoran-00.github.io/2025/05/29/LLM%E5%BA%94%E7%94%A8%EF%BC%9A%E7%BB%93%E6%9E%84%E5%8C%96%E6%8F%90%E5%8F%96%E5%8F%8A%E5%90%8E%E7%BB%AD%E6%80%9D%E8%B7%AF/#more">LLM应用：结构化提取及后续思路</a>一文中，我们使用<code>pdfplumber</code>的<code>.extract_text</code>方法，但这个方法会将全文（尤其指表格部分）当做普通文本按行读取，会完全丢失表格的格式，察觉<code>pdfplumber</code>库的用法有些学问，遂准备本文记录下<code>pdfplumber</code>的基础用法，目的是自动化的判别是普通文本还是表格，表格数据用表格提取的方式，普通文本用文本提取的方法。</p>
<span id="more"></span>

<hr>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="一-Page-chars"><a href="#一-Page-chars" class="headerlink" title="一 Page.chars"></a>一 Page.chars</h3><p>我们从官方给的基本示例开始看起，打印第一页的第一个字符：</p>
<figure class="highlight python"><figcaption><span>pdfplumber_basic_chars.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    first_page = pdf.pages[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(first_page.chars[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p><strong>输出：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&#x27;matrix&#x27;</span>: (1, 0, 0, 1, 303.75000763, 37.94699858999995), </span><br><span class="line"><span class="string">&#x27;fontname&#x27;</span>: <span class="string">&#x27;FAAAAH+TimesNewRomanPSMT&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;adv&#x27;</span>: 4.5,</span><br><span class="line"><span class="string">&#x27;upright&#x27;</span>: True,</span><br><span class="line"><span class="string">&#x27;x0&#x27;</span>: 303.75000763,</span><br><span class="line"><span class="string">&#x27;y0&#x27;</span>: 36.00299858999995,</span><br><span class="line"><span class="string">&#x27;x1&#x27;</span>: 308.25000763,</span><br><span class="line"><span class="string">&#x27;y1&#x27;</span>: 45.00299858999995,</span><br><span class="line"><span class="string">&#x27;width&#x27;</span>: 4.5,</span><br><span class="line"><span class="string">&#x27;height&#x27;</span>: 9.0,</span><br><span class="line"><span class="string">&#x27;size&#x27;</span>: 9.0,</span><br><span class="line"><span class="string">&#x27;mcid&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;tag&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;object_type&#x27;</span>: <span class="string">&#x27;char&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;page_number&#x27;</span>: 1, </span><br><span class="line"><span class="string">&#x27;ncs&#x27;</span>: <span class="string">&#x27;DeviceGray&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;stroking_color&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;stroking_pattern&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;non_stroking_color&#x27;</span>: (0,), </span><br><span class="line"><span class="string">&#x27;non_stroking_pattern&#x27;</span>: None,</span><br><span class="line"><span class="string">&#x27;top&#x27;</span>: 746.99700141,</span><br><span class="line"><span class="string">&#x27;bottom&#x27;</span>: 755.99700141,</span><br><span class="line"><span class="string">&#x27;doctop&#x27;</span>: 746.99700141</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>各字段&#x2F;属性名的说明如下：</strong></p>
<table>
<thead>
<tr>
<th align="center">属性名</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">matrix</td>
<td align="center">字符的当前变换矩阵（Current Transformation Matrix）</td>
</tr>
<tr>
<td align="center">fontname</td>
<td align="center">字体名称</td>
</tr>
<tr>
<td align="center">adv</td>
<td align="center">文字宽度 × 字体大小 × 缩放因子</td>
</tr>
<tr>
<td align="center">upright</td>
<td align="center">字符是否直立</td>
</tr>
<tr>
<td align="center">x0</td>
<td align="center">字符左边到页面左边的距离</td>
</tr>
<tr>
<td align="center">y0</td>
<td align="center">字符底部到页面底部的距离</td>
</tr>
<tr>
<td align="center">x1</td>
<td align="center">字符右边到页面左边的距离</td>
</tr>
<tr>
<td align="center">y1</td>
<td align="center">字符顶部到页面底部的距离</td>
</tr>
<tr>
<td align="center">width</td>
<td align="center">字符宽度</td>
</tr>
<tr>
<td align="center">height</td>
<td align="center">字符高度</td>
</tr>
<tr>
<td align="center">size</td>
<td align="center">字体大小</td>
</tr>
<tr>
<td align="center">mcid</td>
<td align="center">字符所属的标记内容段 ID（如果有，否则为 None），实验性属性</td>
</tr>
<tr>
<td align="center">tag</td>
<td align="center">字符所属的标记内容段标签（如果有，否则为 None），实验性属性</td>
</tr>
<tr>
<td align="center">object_type</td>
<td align="center">对象类型，固定为 “char”</td>
</tr>
<tr>
<td align="center">page_number</td>
<td align="center">字符所在的页码</td>
</tr>
<tr>
<td align="center">ncs</td>
<td align="center">TKTK（待补充）</td>
</tr>
<tr>
<td align="center">text</td>
<td align="center">字符本身，例如：”z”、”Z” 或空格</td>
</tr>
<tr>
<td align="center">stroking_color</td>
<td align="center">字符轮廓颜色（描边色），详见 docs&#x2F;colors.md</td>
</tr>
<tr>
<td align="center">stroking_pattern</td>
<td align="center">TKTK（待补充）</td>
</tr>
<tr>
<td align="center">non_stroking_color</td>
<td align="center">字符内部颜色（填充色），详见 docs&#x2F;colors.md</td>
</tr>
<tr>
<td align="center">non_stroking_pattern</td>
<td align="center">TKTK（待补充）</td>
</tr>
<tr>
<td align="center">top</td>
<td align="center">字符顶部到页面顶部的距离</td>
</tr>
<tr>
<td align="center">bottom</td>
<td align="center">字符底部到页面顶部的距离</td>
</tr>
<tr>
<td align="center">doctop</td>
<td align="center">字符顶部到整个文档顶部的距离</td>
</tr>
</tbody></table>
<p>好的，话说回来，<code>&#39;text&#39;: &#39;1&#39;?</code>哪里有1😳</p>


<p>不会是页面最下面中间的那个像0和1重叠的页码吧？不行，我要把这页的所有字符都打印出来看一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    first_page = pdf.pages[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(first_page.chars):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;字符 <span class="subst">&#123;i&#125;</span>: 文本=&#x27;<span class="subst">&#123;char[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&#x27;, 位置=(x0=<span class="subst">&#123;char[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, y0=<span class="subst">&#123;char[<span class="string">&#x27;y0&#x27;</span>]&#125;</span>, x1=<span class="subst">&#123;char[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, y1=<span class="subst">&#123;char[<span class="string">&#x27;y1&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>输出：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">字符 0: 文本=<span class="string">&#x27;1&#x27;</span>, 位置=(x0=303.75000763, y0=36.00299858999995, x1=308.25000763, y1=45.00299858999995)</span><br><span class="line">字符 1: 文本=<span class="string">&#x27;0&#x27;</span>, 位置=(x0=303.75, y0=36.00299858999995, x1=308.25, y1=45.00299858999995)</span><br><span class="line">字符 2: 文本=<span class="string">&#x27;杭&#x27;</span>, 位置=(x0=113.23200226, y0=606.64799768, x1=137.23200226, y1=630.64799768)</span><br><span class="line">字符 3: 文本=<span class="string">&#x27;州&#x27;</span>, 位置=(x0=137.32800226, y0=606.64799768, x1=161.32800226, y1=630.64799768)</span><br><span class="line">字符 4: 文本=<span class="string">&#x27;市&#x27;</span>, 位置=(x0=161.42400226, y0=606.64799768, x1=185.42400226, y1=630.64799768)</span><br><span class="line">字符 5: 文本=<span class="string">&#x27;房&#x27;</span>, 位置=(x0=185.52000226, y0=606.64799768, x1=209.52000226, y1=630.64799768)</span><br><span class="line">字符 6: 文本=<span class="string">&#x27;屋&#x27;</span>, 位置=(x0=209.61600226000002, y0=606.64799768, x1=233.61600226000002, y1=630.64799768)</span><br><span class="line">字符 7: 文本=<span class="string">&#x27;建&#x27;</span>, 位置=(x0=233.71200226000002, y0=606.64799768, x1=257.71200226, y1=630.64799768)</span><br><span class="line">字符 8: 文本=<span class="string">&#x27;筑&#x27;</span>, 位置=(x0=257.80800226, y0=606.64799768, x1=281.80800226, y1=630.64799768)</span><br><span class="line">字符 9: 文本=<span class="string">&#x27;和&#x27;</span>, 位置=(x0=281.90400226, y0=606.64799768, x1=305.90400226, y1=630.64799768)</span><br><span class="line">字符 10: 文本=<span class="string">&#x27;市&#x27;</span>, 位置=(x0=306.00000226000003, y0=606.64799768, x1=330.00000226000003, y1=630.64799768)</span><br><span class="line">字符 11: 文本=<span class="string">&#x27;政&#x27;</span>, 位置=(x0=330.09600226000003, y0=606.64799768, x1=354.09600226000003, y1=630.64799768)</span><br><span class="line">字符 12: 文本=<span class="string">&#x27;基&#x27;</span>, 位置=(x0=354.19200226000004, y0=606.64799768, x1=378.19200226000004, y1=630.64799768)</span><br><span class="line">字符 13: 文本=<span class="string">&#x27;础&#x27;</span>, 位置=(x0=378.28800226000004, y0=606.64799768, x1=402.28800226000004, y1=630.64799768)</span><br><span class="line">字符 14: 文本=<span class="string">&#x27;设&#x27;</span>, 位置=(x0=402.38400226000005, y0=606.64799768, x1=426.38400226000005, y1=630.64799768)</span><br><span class="line">字符 15: 文本=<span class="string">&#x27;施&#x27;</span>, 位置=(x0=426.48000226000005, y0=606.64799768, x1=450.48000226000005, y1=630.64799768)</span><br><span class="line">字符 16: 文本=<span class="string">&#x27;项&#x27;</span>, 位置=(x0=450.57600226000005, y0=606.64799768, x1=474.57600226000005, y1=630.64799768)</span><br><span class="line">字符 17: 文本=<span class="string">&#x27;目&#x27;</span>, 位置=(x0=474.67200226000006, y0=606.64799768, x1=498.67200226000006, y1=630.64799768)</span><br><span class="line">字符 18: 文本=<span class="string">&#x27; &#x27;</span>, 位置=(x0=498.76800226000006, y0=606.64799768, x1=510.76800226000006, y1=630.64799768)</span><br><span class="line">字符 19: 文本=<span class="string">&#x27;设&#x27;</span>, 位置=(x0=185.51999665, y0=544.39799768, x1=209.51999665, y1=568.39799768)</span><br><span class="line">字符 20: 文本=<span class="string">&#x27;计&#x27;</span>, 位置=(x0=209.61599665, y0=544.39799768, x1=233.61599665, y1=568.39799768)</span><br><span class="line">字符 21: 文本=<span class="string">&#x27;招&#x27;</span>, 位置=(x0=233.71199665, y0=544.39799768, x1=257.71199665, y1=568.39799768)</span><br><span class="line">字符 22: 文本=<span class="string">&#x27;标&#x27;</span>, 位置=(x0=257.80799665, y0=544.39799768, x1=281.80799665, y1=568.39799768)</span><br><span class="line">字符 23: 文本=<span class="string">&#x27;文&#x27;</span>, 位置=(x0=281.90399665, y0=544.39799768, x1=305.90399665, y1=568.39799768)</span><br><span class="line">字符 24: 文本=<span class="string">&#x27;件&#x27;</span>, 位置=(x0=305.99999665, y0=544.39799768, x1=329.99999665, y1=568.39799768)</span><br><span class="line">字符 25: 文本=<span class="string">&#x27;示&#x27;</span>, 位置=(x0=330.09599665, y0=544.39799768, x1=354.09599665, y1=568.39799768)</span><br><span class="line">字符 26: 文本=<span class="string">&#x27;范&#x27;</span>, 位置=(x0=354.19199665, y0=544.39799768, x1=378.19199665, y1=568.39799768)</span><br><span class="line">字符 27: 文本=<span class="string">&#x27;文&#x27;</span>, 位置=(x0=378.28799665, y0=544.39799768, x1=402.28799665, y1=568.39799768)</span><br><span class="line">字符 28: 文本=<span class="string">&#x27;本&#x27;</span>, 位置=(x0=402.38399665000003, y0=544.39799768, x1=426.38399665000003, y1=568.39799768)</span><br><span class="line">字符 29: 文本=<span class="string">&#x27;（&#x27;</span>, 位置=(x0=251.78400421999999, y0=496.86800394999995, x1=269.78400422, y1=514.86800395)</span><br><span class="line">字符 30: 文本=<span class="string">&#x27;资&#x27;</span>, 位置=(x0=269.85600422, y0=496.86800394999995, x1=287.85600422, y1=514.86800395)</span><br><span class="line">字符 31: 文本=<span class="string">&#x27;格&#x27;</span>, 位置=(x0=287.92800422, y0=496.86800394999995, x1=305.92800422, y1=514.86800395)</span><br><span class="line">字符 32: 文本=<span class="string">&#x27;后&#x27;</span>, 位置=(x0=306.00000422, y0=496.86800394999995, x1=324.00000422, y1=514.86800395)</span><br><span class="line">字符 33: 文本=<span class="string">&#x27;审&#x27;</span>, 位置=(x0=324.07200422, y0=496.86800394999995, x1=342.07200422, y1=514.86800395)</span><br><span class="line">字符 34: 文本=<span class="string">&#x27;）&#x27;</span>, 位置=(x0=342.14400422, y0=496.86800394999995, x1=360.14400422, y1=514.86800395)</span><br><span class="line">字符 35: 文本=<span class="string">&#x27;（&#x27;</span>, 位置=(x0=251.71199799, y0=453.12900554, x1=269.71199799, y1=471.12900554)</span><br><span class="line">字符 36: 文本=<span class="string">&#x27;2&#x27;</span>, 位置=(x0=269.78399799, y0=453.12900554, x1=278.78399799, y1=471.12900554)</span><br><span class="line">字符 37: 文本=<span class="string">&#x27;0&#x27;</span>, 位置=(x0=278.85599799, y0=453.12900554, x1=287.85599799, y1=471.12900554)</span><br><span class="line">字符 38: 文本=<span class="string">&#x27;1&#x27;</span>, 位置=(x0=287.92799799, y0=453.12900554, x1=296.92799799, y1=471.12900554)</span><br><span class="line">字符 39: 文本=<span class="string">&#x27;9&#x27;</span>, 位置=(x0=296.99999799, y0=453.12900554, x1=305.99999799, y1=471.12900554)</span><br><span class="line">字符 40: 文本=<span class="string">&#x27;年&#x27;</span>, 位置=(x0=306.07199799, y0=453.12900554, x1=324.07199799, y1=471.12900554)</span><br><span class="line">字符 41: 文本=<span class="string">&#x27;版&#x27;</span>, 位置=(x0=324.14399799, y0=453.12900554, x1=342.14399799, y1=471.12900554)</span><br><span class="line">字符 42: 文本=<span class="string">&#x27;）&#x27;</span>, 位置=(x0=342.21599799, y0=453.12900554, x1=360.21599799, y1=471.12900554)</span><br><span class="line">字符 43: 文本=<span class="string">&#x27;杭&#x27;</span>, 位置=(x0=206.60399628, y0=149.65998087999998, x1=224.60399628, y1=167.65998087999998)</span><br><span class="line">字符 44: 文本=<span class="string">&#x27;州&#x27;</span>, 位置=(x0=224.67599628, y0=149.65998087999998, x1=242.67599628, y1=167.65998087999998)</span><br><span class="line">字符 45: 文本=<span class="string">&#x27;市&#x27;</span>, 位置=(x0=242.74799628, y0=149.65998087999998, x1=260.74799628, y1=167.65998087999998)</span><br><span class="line">字符 46: 文本=<span class="string">&#x27;城&#x27;</span>, 位置=(x0=260.81999628, y0=149.65998087999998, x1=278.81999628, y1=167.65998087999998)</span><br><span class="line">字符 47: 文本=<span class="string">&#x27;乡&#x27;</span>, 位置=(x0=278.89199628, y0=149.65998087999998, x1=296.89199628, y1=167.65998087999998)</span><br><span class="line">字符 48: 文本=<span class="string">&#x27;建&#x27;</span>, 位置=(x0=296.96399628, y0=149.65998087999998, x1=314.96399628, y1=167.65998087999998)</span><br><span class="line">字符 49: 文本=<span class="string">&#x27;设&#x27;</span>, 位置=(x0=315.03599628, y0=149.65998087999998, x1=333.03599628, y1=167.65998087999998)</span><br><span class="line">字符 50: 文本=<span class="string">&#x27;委&#x27;</span>, 位置=(x0=333.10799628, y0=149.65998087999998, x1=351.10799628, y1=167.65998087999998)</span><br><span class="line">字符 51: 文本=<span class="string">&#x27;员&#x27;</span>, 位置=(x0=351.17999628, y0=149.65998087999998, x1=369.17999628, y1=167.65998087999998)</span><br><span class="line">字符 52: 文本=<span class="string">&#x27;会&#x27;</span>, 位置=(x0=369.25199628, y0=149.65998087999998, x1=387.25199628, y1=167.65998087999998)</span><br><span class="line">字符 53: 文本=<span class="string">&#x27;制&#x27;</span>, 位置=(x0=387.32399628, y0=149.65998087999998, x1=405.32399628, y1=167.65998087999998)</span><br><span class="line">字符 54: 文本=<span class="string">&#x27;二&#x27;</span>, 位置=(x0=247.24800873, y0=126.31598674000004, x1=265.24800873000004, y1=144.31598674000003)</span><br><span class="line">字符 55: 文本=<span class="string">&#x27;0&#x27;</span>, 位置=(x0=265.32000873, y0=126.31598674000004, x1=274.32000873, y1=144.31598674000003)</span><br><span class="line">字符 56: 文本=<span class="string">&#x27;二&#x27;</span>, 位置=(x0=274.39200873, y0=126.31598674000004, x1=292.39200873, y1=144.31598674000003)</span><br><span class="line">字符 57: 文本=<span class="string">&#x27;五&#x27;</span>, 位置=(x0=292.46400873, y0=126.31598674000004, x1=310.46400873, y1=144.31598674000003)</span><br><span class="line">字符 58: 文本=<span class="string">&#x27;年&#x27;</span>, 位置=(x0=310.53600873, y0=126.31598674000004, x1=328.53600873, y1=144.31598674000003)</span><br><span class="line">字符 59: 文本=<span class="string">&#x27;四&#x27;</span>, 位置=(x0=328.60800873000005, y0=126.31598674000004, x1=346.60800873000005, y1=144.31598674000003)</span><br><span class="line">字符 60: 文本=<span class="string">&#x27;月&#x27;</span>, 位置=(x0=346.68000873000005, y0=126.31598674000004, x1=364.68000873000005, y1=144.31598674000003)</span><br></pre></td></tr></table></figure>

<p>好像确实是那个页码，但为什么是先从最后读取呢，有些奇怪，不行，我想再确切的确认下到底是不是页码。</p>
<hr>
<h3 id="二-im-draw-rect-…"><a href="#二-im-draw-rect-…" class="headerlink" title="二 im.draw_rect(…)"></a>二 im.draw_rect(…)</h3><table>
<thead>
<tr>
<th align="center">单对象方法</th>
<th align="center">批量方法</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">im.draw_rect(<br />bbox_or_obj, <br />fill&#x3D;{color},<br /> stroke&#x3D;{color}, stroke_width&#x3D;1)</td>
<td align="center">im.draw_rects(list_of_rects, **kwargs)</td>
<td align="center">从矩形对象、字符对象等，或一个四元组形式的边界框中绘制矩形。</td>
</tr>
</tbody></table>
<p>解释：</p>
<ul>
<li><code>im.draw_rect(...)</code>：绘制单个矩形，可传入一个矩形对象或四元组边界框。</li>
<li><code>im.draw_rects(...)</code>：绘制多个矩形，参数为矩形列表。其他绘图参数可通过 <code>**kwargs</code> 传入，例如填充颜色、描边颜色和描边宽度。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    first_page = pdf.pages[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取页面图像</span></span><br><span class="line">    im = first_page.to_image(resolution=<span class="number">150</span>)  <span class="comment"># 分辨率 150 DPI</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 标记前两个字符的位置</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> first_page.chars[<span class="number">0</span>:<span class="number">2</span>]:</span><br><span class="line">        x0, y0, x1, y1 = char[<span class="string">&#x27;x0&#x27;</span>], char[<span class="string">&#x27;top&#x27;</span>], char[<span class="string">&#x27;x1&#x27;</span>], char[<span class="string">&#x27;bottom&#x27;</span>]</span><br><span class="line">        im.draw_rect((x0, y0, x1, y1), fill=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">50</span>), stroke=<span class="string">&quot;red&quot;</span>, stroke_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示图像</span></span><br><span class="line">    im.show()</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">变量名</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">fill</td>
<td align="center">填充色</td>
</tr>
<tr>
<td align="center">stoke</td>
<td align="center">框框的颜色</td>
</tr>
<tr>
<td align="center">stroke_width</td>
<td align="center">框框的宽度</td>
</tr>
</tbody></table>
<blockquote>
<p><code>fill=(255, 255, 0, 50)</code> 表示一种带透明度的填充颜色，具体含义是：</p>
<ul>
<li><code>(255, 255, 0)</code> 是 RGB 颜色值，对应纯黄色（红255，绿255，蓝0）</li>
<li><code>50</code> 是 alpha 通道值，表示透明度，范围通常是 0~255，50 表示比较透明（约 20% 不透明）</li>
</ul>
<p>所以这是一种半透明的黄色填充色，颜色比较浅，带有一定透明效果。</p>
</blockquote>
<p><strong>输出：</strong></p>


<p>可以看到，<code>0,1</code>确实是页码位置。</p>
<hr>
<p>回归正文，我们的目标是表格数据用表格提取的方式，普通文本用文本提取的方法，那我们就需要先单独体验下文本提取和表格提取的方法，先从文本提取开始吧：</p>
<h3 id="三-文本提取"><a href="#三-文本提取" class="headerlink" title="三 文本提取"></a>三 文本提取</h3><h4 id="1-Page-extract-text-…"><a href="#1-Page-extract-text-…" class="headerlink" title="1. Page.extract_text(…)"></a>1. Page.extract_text(…)</h4><table>
<thead>
<tr>
<th>方法名</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>.extract_text(x_tolerance=3, x_tolerance_ratio=None, y_tolerance=3, layout=False, x_density=7.25, y_density=13, line_dir_render=None, char_dir_render=None, **kwargs)</code></td>
<td>将页面上的所有字符对象整理为一个单一的字符串。<br><br><strong>当 <code>layout=False</code> 时：</strong><br>若前一个字符的 <code>x1</code> 与下一个字符的 <code>x0</code> 之间的差值大于 <code>x_tolerance</code>，则插入空格。（如果设置了 <code>x_tolerance_ratio</code>，则使用动态的 <code>x_tolerance</code>，其值为 <code>x_tolerance_ratio * 上一个字符的 size</code>。）若一个字符的 <code>doctop</code> 与下一个字符的 <code>doctop</code> 之间的差值大于 <code>y_tolerance</code>，则插入换行符。<br><br><strong>当 <code>layout=True</code> 时（实验性功能）：</strong><br>尝试模拟 PDF 页面上文本的结构布局。通过 <code>x_density</code> 和 <code>y_density</code> 来判断每个 PDF 坐标点（单位）上至少应有的字符数或换行数。<br>你可以传入 <code>line_dir_render=&quot;ttb&quot;/&quot;btt&quot;/&quot;ltr&quot;/&quot;rtl&quot;</code> 和&#x2F;或 <code>char_dir_render=&quot;ttb&quot;/&quot;btt&quot;/&quot;ltr&quot;/&quot;rtl&quot;</code> 来改变默认的行或字符输出方向（例如：从上到下、从右到左等）。<br>其余所有的 <code>**kwargs</code> 参数都会传递给 <code>.extract_words(...)</code> 方法（见下文），该方法是进行布局计算的第一步。</td>
</tr>
</tbody></table>
<blockquote>
<p><code>ttb</code>：top-to-bottom（从上到下）</p>
<p><code>btt</code>：bottom-to-top（从下到上）</p>
<p><code>ltr</code>：left-to-right（从左到右）</p>
<p><code>rtl</code>：right-to-left（从右到左）。</p>
</blockquote>
<p><strong>更详细的介绍请看附录1</strong>，使用<code>.extract_text</code>读取文件的前三页并打印：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换为你的 PDF 文件路径</span></span><br><span class="line">pdf_path = <span class="string">&quot;../../招标文件修订-1.pdf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">3</span>, <span class="built_in">len</span>(pdf.pages))):  <span class="comment"># 最多读取前三页</span></span><br><span class="line">        page = pdf.pages[i]</span><br><span class="line">        text = page.extract_text(</span><br><span class="line">            x_tolerance=<span class="number">3</span>,</span><br><span class="line">            y_tolerance=<span class="number">3</span>,</span><br><span class="line">            layout=<span class="literal">False</span>  <span class="comment"># 或设置为 True 以尝试还原排版结构</span></span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;--- 第 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> 页 ---\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(text <span class="keyword">or</span> <span class="string">&quot;[该页无可提取文本]&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;-&quot;</span>*<span class="number">40</span> + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>我觉得有必要把第二页和第三页也贴出来，为了不占用正文位置，贴在<strong>附录2</strong>了，有两点需要关注的：</p>
<ol>
<li>第三页是表格</li>
<li>页码有问题（均以1打底，看附录2你就明白了）</li>
</ol>
<p><strong>输出：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">--- 第 1 页 ---</span><br><span class="line"></span><br><span class="line">杭州市房屋建筑和市政基础设施项目</span><br><span class="line">设计招标文件示范文本</span><br><span class="line">（资格后审）</span><br><span class="line">（2019年版）</span><br><span class="line">杭州市城乡建设委员会制</span><br><span class="line">二0二五年四月</span><br><span class="line">01</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- 第 2 页 ---</span><br><span class="line"></span><br><span class="line">奥体街（扬帆路-养正巷）设计</span><br><span class="line">（招标编号：A3301080120526863001221）</span><br><span class="line">招标文件</span><br><span class="line">（☑资格后审□邀请招标）</span><br><span class="line">招标人：杭州滨江奥体博览城开发建设运营管理有限公司 （盖单位章）</span><br><span class="line">招标代理机构：浙江华耀建设咨询有限公司 （盖单位章）</span><br><span class="line">2025年05月15日</span><br><span class="line">11</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- 第 3 页 ---</span><br><span class="line"></span><br><span class="line">第二章 投标人须知</span><br><span class="line">投标人须知前附表</span><br><span class="line">条款号 条款名称 编列内容</span><br><span class="line">名称：杭州滨江奥体博览城开发建</span><br><span class="line">设运营管理有限公司</span><br><span class="line">地址：浙江省杭州市滨江区浦沿街</span><br><span class="line">1.1.2 招标人</span><br><span class="line">道滨安路1338号三楼</span><br><span class="line">联系人：翁栎超</span><br><span class="line">电话：13600511926</span><br><span class="line">名称： 浙江华耀建设咨询有限公司</span><br><span class="line">地址：杭州市上城区佰富时代中心3幢13楼</span><br><span class="line">1.1.3 招标代理机构</span><br><span class="line">联系人：潘正阳、陈瑶</span><br><span class="line">电话：13758171369、18757567243</span><br><span class="line">奥体街（扬帆路-养正巷）设计</span><br><span class="line">1.1.4 工程名称</span><br><span class="line">杭州市滨江区</span><br><span class="line">1.1.5 建设地点</span><br><span class="line">见招标公告</span><br><span class="line">1.1.6 建设规模</span><br><span class="line">本项目投资估算为22798万元</span><br><span class="line">1.1.7 投资估算</span><br><span class="line">国有100%</span><br><span class="line">1.2.1 资金来源及比例</span><br><span class="line">已落实</span><br><span class="line">1.2.2 资金落实情况</span><br><span class="line">☑方案设计、初步设计（含概算编制和调整）和施工图设计（☑BIM设计</span><br><span class="line">服务）</span><br><span class="line">招标内容具体包括:工程设计服务内容： 包括但不限于：</span><br><span class="line">（1）可研编制（含估算编制）、方案设计及深化、初步设计（含概算</span><br><span class="line">编制）、施工图设计【含BIM（若有）】、管线综合、交改设计（若</span><br><span class="line">有，含主体项目交改以及其他配套交改设计）、雨污水管线迁改（若</span><br><span class="line">有）、基坑设计、报批审查配合、按审查和招标人意见对整个设计过程</span><br><span class="line">的修改、深化整合等优化设计；</span><br><span class="line">1.3.1 招标范围</span><br><span class="line">（2）按招标文件要求提供纸质和电子图纸；</span><br><span class="line">（3）设计补图和工程施工阶段的变更联系单；</span><br><span class="line">（4）施工配合、验收配合、竣工图编制配合等相关服务；</span><br><span class="line">（5）根据工程实际需要提供现场服务等。</span><br><span class="line">各阶段设计成果应符合国家规定的图纸编制深度要求及相关出图标准要</span><br><span class="line">求且应满足发包人的相关要求，并应及时完成招标人和相关审查部门的</span><br><span class="line">阶段性审查意见所提出的修改工作等，特别是相关部门不计次数的优化</span><br><span class="line">修改要求等。阶段性审查包括方案评审、初步设计审查和施工图审查</span><br><span class="line">12</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br></pre></td></tr></table></figure>

<blockquote>
<p>layout&#x3D;True的贴在附录3了，感觉也没有格式信息（猛地一看像是有格式信息）。</p>
</blockquote>
<p>可以看出：</p>
<ol>
<li>每页的最后有一个数字，分别是01,11,12，为页码</li>
<li>第三页是表格，<code>extract_text</code>依旧会将其当做普通文本按行读取，即失去段落结构了</li>
</ol>
<hr>
<h4 id="2-extract-words-…"><a href="#2-extract-words-…" class="headerlink" title="2. extract_words(…)"></a>2. extract_words(…)</h4><p>关于<code>extract_words</code>参数的详细讲解见<strong>附录5</strong>，<strong>代码1（基础用法）：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">3</span>, <span class="built_in">len</span>(pdf.pages))):  <span class="comment"># 只解析前 3 页（或文件页数更少时自动适配）</span></span><br><span class="line">        page = pdf.pages[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n--- 第 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> 页 ---&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 提取单词列表（默认容差设置）</span></span><br><span class="line">        words = page.extract_words()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 打印前几个单词的信息（太多可以裁剪）</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words[:<span class="number">10</span>]:  <span class="comment"># 每页前 10 个单词</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;词：<span class="subst">&#123;word[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  ↪ 坐标：(<span class="subst">&#123;word[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>可以看出，extract_words相当于在extract_text的基础上加上坐标输出（虽然[第二章 投标人须知]被分开为两份了）：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">--- 第 1 页 ---</span><br><span class="line">词：杭州市房屋建筑和市政基础设施项目</span><br><span class="line">  ↪ 坐标：(113.23200226, 161.35200232, 498.67200226000006, 185.35200232)</span><br><span class="line">词：设计招标文件示范文本</span><br><span class="line">  ↪ 坐标：(185.51999665, 223.60200232, 426.38399665000003, 247.60200232)</span><br><span class="line">词：（资格后审）</span><br><span class="line">  ↪ 坐标：(251.78400421999999, 277.13199605, 360.14400422, 295.13199605000005)</span><br><span class="line">词：（2019年版）</span><br><span class="line">  ↪ 坐标：(251.71199799, 320.87099446, 360.21599799, 338.87099446)</span><br><span class="line">词：杭州市城乡建设委员会制</span><br><span class="line">  ↪ 坐标：(206.60399628, 624.3400191200001, 405.32399628, 642.3400191200001)</span><br><span class="line">词：二0二五年四月</span><br><span class="line">  ↪ 坐标：(247.24800873, 647.68401326, 364.68000873000005, 665.6840132599999)</span><br><span class="line">词：01</span><br><span class="line">  ↪ 坐标：(303.75, 746.99700141, 308.25000763, 755.99700141)</span><br><span class="line"></span><br><span class="line">--- 第 2 页 ---</span><br><span class="line">词：奥体街（扬帆路-养正巷）设计</span><br><span class="line">  ↪ 坐标：(204.31200457999998, 95.86200049000013, 394.0400045800001, 109.86200049000013)</span><br><span class="line">词：（招标编号：A3301080120526863001221）</span><br><span class="line">  ↪ 坐标：(188.40000153, 129.73200037000004, 445.9440015299999, 143.73200037000004)</span><br><span class="line">词：招标文件</span><br><span class="line">  ↪ 坐标：(253.97500458999997, 219.91299402000004, 357.97500458999997, 245.91299402000004)</span><br><span class="line">词：（☑资格后审□邀请招标）</span><br><span class="line">  ↪ 坐标：(175.49999849, 259.70200610999996, 436.44199849, 284.12200611)</span><br><span class="line">词：招标人：杭州滨江奥体博览城开发建设运营管理有限公司</span><br><span class="line">  ↪ 坐标：(84.15000192, 524.49500181, 434.15000192, 538.49500181)</span><br><span class="line">词：（盖单位章）</span><br><span class="line">  ↪ 坐标：(444.00600192, 524.49500181, 528.00600192, 538.49500181)</span><br><span class="line">词：招标代理机构：浙江华耀建设咨询有限公司</span><br><span class="line">  ↪ 坐标：(120.15000001, 551.7290106, 386.15000001, 565.7290106)</span><br><span class="line">词：（盖单位章）</span><br><span class="line">  ↪ 坐标：(408.00400000999997, 551.7290106, 492.00400000999997, 565.7290106)</span><br><span class="line">词：2025年05月15日</span><br><span class="line">  ↪ 坐标：(310.00000763, 602.28399088, 408.00000763, 616.28399088)</span><br><span class="line">词：11</span><br><span class="line">  ↪ 坐标：(303.75, 746.99700141, 308.25000763, 755.99700141)</span><br><span class="line"></span><br><span class="line">--- 第 3 页 ---</span><br><span class="line">词：第二章</span><br><span class="line">  ↪ 坐标：(228.69999695, 92.72899985999993, 294.87599695, 114.72899985999993)</span><br><span class="line">词：投标人须知</span><br><span class="line">  ↪ 坐标：(306.05199695, 92.72899985999993, 416.40399694999996, 114.72899985999993)</span><br><span class="line">词：投标人须知前附表</span><br><span class="line">  ↪ 坐标：(238.89399719, 126.88100191000001, 367.34199719, 142.88100191)</span><br><span class="line">词：条款号</span><br><span class="line">  ↪ 坐标：(64.62499905, 171.73550296999997, 96.20899905, 182.23550296999997)</span><br><span class="line">词：条款名称</span><br><span class="line">  ↪ 坐标：(147.31599999, 171.73550296999997, 189.44199999, 182.23550296999997)</span><br><span class="line">词：编列内容</span><br><span class="line">  ↪ 坐标：(358.14099653999995, 171.73550296999997, 400.2669965399999, 182.23550296999997)</span><br><span class="line">词：名称：杭州滨江奥体博览城开发建</span><br><span class="line">  ↪ 坐标：(219.87500239, 193.33550335999996, 377.37500238999996, 203.83550335999996)</span><br><span class="line">词：设运营管理有限公司</span><br><span class="line">  ↪ 坐标：(219.87500239, 208.93550374000006, 314.37500238999996, 219.43550374000006)</span><br><span class="line">词：地址：浙江省杭州市滨江区浦沿街</span><br><span class="line">  ↪ 坐标：(220.02200238999998, 230.03550411999993, 377.52200239, 240.53550411999993)</span><br><span class="line">词：1.1.2</span><br><span class="line">  ↪ 坐标：(73.75, 236.08550145000004, 100.0, 246.58550145000004)</span><br></pre></td></tr></table></figure>

<p><strong>代码二（指定return_chars&#x3D;True）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(<span class="number">3</span>, <span class="built_in">len</span>(pdf.pages))):  <span class="comment"># 只解析前 3 页（或文件页数更少时自动适配）</span></span><br><span class="line">        page = pdf.pages[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n--- 第 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> 页 ---&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 提取单词列表，并包含组成每个单词的字符详情</span></span><br><span class="line">        words = page.extract_words(return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 打印前几个单词的信息（太多可以裁剪）</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words[:<span class="number">10</span>]:  <span class="comment"># 每页前 10 个单词</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;词：<span class="subst">&#123;word[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  ↪ 坐标：(<span class="subst">&#123;word[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;  ↪ 字符组成：&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> word[<span class="string">&quot;chars&quot;</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    - 字符：<span class="subst">&#123;char[<span class="string">&#x27;text&#x27;</span>]&#125;</span>, 坐标：(<span class="subst">&#123;char[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>), 字体：<span class="subst">&#123;char.get(<span class="string">&#x27;fontname&#x27;</span>)&#125;</span>, 大小：<span class="subst">&#123;char.get(<span class="string">&#x27;size&#x27;</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>内容太长，这里仅展示第一页，可以看出指定return_chars&#x3D;True后就相当于在不指定的基础上加上.chars方法：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"> --- 第 1 页 ---</span><br><span class="line">词：杭州市房屋建筑和市政基础设施项目</span><br><span class="line">  ↪ 坐标：(113.23200226, 161.35200232, 498.67200226000006, 185.35200232)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：杭, 坐标：(113.23200226, 161.35200232, 137.23200226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：州, 坐标：(137.32800226, 161.35200232, 161.32800226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：市, 坐标：(161.42400226, 161.35200232, 185.42400226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：房, 坐标：(185.52000226, 161.35200232, 209.52000226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：屋, 坐标：(209.61600226000002, 161.35200232, 233.61600226000002, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：建, 坐标：(233.71200226000002, 161.35200232, 257.71200226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：筑, 坐标：(257.80800226, 161.35200232, 281.80800226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：和, 坐标：(281.90400226, 161.35200232, 305.90400226, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：市, 坐标：(306.00000226000003, 161.35200232, 330.00000226000003, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：政, 坐标：(330.09600226000003, 161.35200232, 354.09600226000003, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：基, 坐标：(354.19200226000004, 161.35200232, 378.19200226000004, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：础, 坐标：(378.28800226000004, 161.35200232, 402.28800226000004, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：设, 坐标：(402.38400226000005, 161.35200232, 426.38400226000005, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：施, 坐标：(426.48000226000005, 161.35200232, 450.48000226000005, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：项, 坐标：(450.57600226000005, 161.35200232, 474.57600226000005, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：目, 坐标：(474.67200226000006, 161.35200232, 498.67200226000006, 185.35200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">词：设计招标文件示范文本</span><br><span class="line">  ↪ 坐标：(185.51999665, 223.60200232, 426.38399665000003, 247.60200232)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：设, 坐标：(185.51999665, 223.60200232, 209.51999665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：计, 坐标：(209.61599665, 223.60200232, 233.61599665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：招, 坐标：(233.71199665, 223.60200232, 257.71199665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：标, 坐标：(257.80799665, 223.60200232, 281.80799665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：文, 坐标：(281.90399665, 223.60200232, 305.90399665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：件, 坐标：(305.99999665, 223.60200232, 329.99999665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：示, 坐标：(330.09599665, 223.60200232, 354.09599665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：范, 坐标：(354.19199665, 223.60200232, 378.19199665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：文, 坐标：(378.28799665, 223.60200232, 402.28799665, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">    - 字符：本, 坐标：(402.38399665000003, 223.60200232, 426.38399665000003, 247.60200232), 字体：FAAABA+SimSun,Bold, 大小：24.0</span><br><span class="line">词：（资格后审）</span><br><span class="line">  ↪ 坐标：(251.78400421999999, 277.13199605, 360.14400422, 295.13199605000005)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：（, 坐标：(251.78400421999999, 277.13199605, 269.78400422, 295.13199605000005), 字体：FAAABA+SimSun,Bold, 大小：18.000000000000057</span><br><span class="line">    - 字符：资, 坐标：(269.85600422, 277.13199605, 287.85600422, 295.13199605000005), 字体：FAAABA+SimSun,Bold, 大小：18.000000000000057</span><br><span class="line">    - 字符：格, 坐标：(287.92800422, 277.13199605, 305.92800422, 295.13199605000005), 字体：FAAABA+SimSun,Bold, 大小：18.000000000000057</span><br><span class="line">    - 字符：后, 坐标：(306.00000422, 277.13199605, 324.00000422, 295.13199605000005), 字体：FAAABA+SimSun,Bold, 大小：18.000000000000057</span><br><span class="line">    - 字符：审, 坐标：(324.07200422, 277.13199605, 342.07200422, 295.13199605000005), 字体：FAAABA+SimSun,Bold, 大小：18.000000000000057</span><br><span class="line">    - 字符：）, 坐标：(342.14400422, 277.13199605, 360.14400422, 295.13199605000005), 字体：FAAABA+SimSun,Bold, 大小：18.000000000000057</span><br><span class="line">词：（2019年版）</span><br><span class="line">  ↪ 坐标：(251.71199799, 320.87099446, 360.21599799, 338.87099446)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：（, 坐标：(251.71199799, 320.87099446, 269.71199799, 338.87099446), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：2, 坐标：(269.78399799, 320.87099446, 278.78399799, 338.87099446), 字体：FAAABE+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：0, 坐标：(278.85599799, 320.87099446, 287.85599799, 338.87099446), 字体：FAAABE+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：1, 坐标：(287.92799799, 320.87099446, 296.92799799, 338.87099446), 字体：FAAABE+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：9, 坐标：(296.99999799, 320.87099446, 305.99999799, 338.87099446), 字体：FAAABE+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：年, 坐标：(306.07199799, 320.87099446, 324.07199799, 338.87099446), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：版, 坐标：(324.14399799, 320.87099446, 342.14399799, 338.87099446), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：）, 坐标：(342.21599799, 320.87099446, 360.21599799, 338.87099446), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">词：杭州市城乡建设委员会制</span><br><span class="line">  ↪ 坐标：(206.60399628, 624.3400191200001, 405.32399628, 642.3400191200001)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：杭, 坐标：(206.60399628, 624.3400191200001, 224.60399628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：州, 坐标：(224.67599628, 624.3400191200001, 242.67599628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：市, 坐标：(242.74799628, 624.3400191200001, 260.74799628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：城, 坐标：(260.81999628, 624.3400191200001, 278.81999628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：乡, 坐标：(278.89199628, 624.3400191200001, 296.89199628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：建, 坐标：(296.96399628, 624.3400191200001, 314.96399628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：设, 坐标：(315.03599628, 624.3400191200001, 333.03599628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：委, 坐标：(333.10799628, 624.3400191200001, 351.10799628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：员, 坐标：(351.17999628, 624.3400191200001, 369.17999628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：会, 坐标：(369.25199628, 624.3400191200001, 387.25199628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">    - 字符：制, 坐标：(387.32399628, 624.3400191200001, 405.32399628, 642.3400191200001), 字体：FAAABA+SimSun,Bold, 大小：18.0</span><br><span class="line">词：二0二五年四月</span><br><span class="line">  ↪ 坐标：(247.24800873, 647.68401326, 364.68000873000005, 665.6840132599999)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：二, 坐标：(247.24800873, 647.68401326, 265.24800873000004, 665.6840132599999), 字体：FAAABA+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">    - 字符：0, 坐标：(265.32000873, 647.68401326, 274.32000873, 665.6840132599999), 字体：FAAABE+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">    - 字符：二, 坐标：(274.39200873, 647.68401326, 292.39200873, 665.6840132599999), 字体：FAAABA+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">    - 字符：五, 坐标：(292.46400873, 647.68401326, 310.46400873, 665.6840132599999), 字体：FAAABA+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">    - 字符：年, 坐标：(310.53600873, 647.68401326, 328.53600873, 665.6840132599999), 字体：FAAABA+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">    - 字符：四, 坐标：(328.60800873000005, 647.68401326, 346.60800873000005, 665.6840132599999), 字体：FAAABA+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">    - 字符：月, 坐标：(346.68000873000005, 647.68401326, 364.68000873000005, 665.6840132599999), 字体：FAAABA+SimSun,Bold, 大小：17.999999999999986</span><br><span class="line">词：01</span><br><span class="line">  ↪ 坐标：(303.75, 746.99700141, 308.25000763, 755.99700141)</span><br><span class="line">  ↪ 字符组成：</span><br><span class="line">    - 字符：0, 坐标：(303.75, 746.99700141, 308.25, 755.99700141), 字体：FAAAAH+TimesNewRomanPSMT, 大小：9.0</span><br><span class="line">    - 字符：1, 坐标：(303.75000763, 746.99700141, 308.25000763, 755.99700141), 字体：FAAAAH+TimesNewRomanPSMT, 大小：9.0</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="3-extract-text-lines-…"><a href="#3-extract-text-lines-…" class="headerlink" title="3. extract_text_lines(…)"></a>3. extract_text_lines(…)</h4><p>那如果不想使用<code>extract_words</code>这种细粒度的方法，只想按行去提取文本怎么办呢，可以用<code>extract_text_lines</code>方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">2</span>]  <span class="comment"># 读取第1页</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取文本行（实验功能）</span></span><br><span class="line">    lines = page.extract_text_lines(return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印前几行的内容和位置</span></span><br><span class="line">    <span class="keyword">for</span> i, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(lines[:<span class="number">5</span>]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n🔹 第 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> 行：<span class="subst">&#123;line[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   ➤ 边界框：(<span class="subst">&#123;line[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;line[<span class="string">&#x27;top&#x27;</span>]&#125;</span>, <span class="subst">&#123;line[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;line[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   ➤ 字符数：<span class="subst">&#123;<span class="built_in">len</span>(line[<span class="string">&#x27;chars&#x27;</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> line[<span class="string">&#x27;chars&#x27;</span>][:<span class="number">3</span>]:  <span class="comment"># 显示前三个字符</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;     - 字符：<span class="subst">&#123;char[<span class="string">&#x27;text&#x27;</span>]&#125;</span>，位置：(<span class="subst">&#123;char[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;top&#x27;</span>]&#125;</span>，<span class="subst">&#123;char[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;char[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>输出：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">🔹 第 1 行：第二章 投标人须知</span><br><span class="line">   ➤ 边界框：(228.69999695, 92.72899985999993, 416.40399694999996, 114.72899985999993)</span><br><span class="line">   ➤ 字符数：8</span><br><span class="line">     - 字符：第，位置：(228.69999695, 92.72899985999993，250.69999695, 114.72899985999993)</span><br><span class="line">     - 字符：二，位置：(250.78799695, 92.72899985999993，272.78799695, 114.72899985999993)</span><br><span class="line">     - 字符：章，位置：(272.87599695, 92.72899985999993，294.87599695, 114.72899985999993)</span><br><span class="line"></span><br><span class="line">🔹 第 2 行：投标人须知前附表</span><br><span class="line">   ➤ 边界框：(238.89399719, 126.88100191000001, 367.34199719, 142.88100191)</span><br><span class="line">   ➤ 字符数：8</span><br><span class="line">     - 字符：投，位置：(238.89399719, 126.88100191000001，254.89399719, 142.88100191)</span><br><span class="line">     - 字符：标，位置：(254.95799719, 126.88100191000001，270.95799719, 142.88100191)</span><br><span class="line">     - 字符：人，位置：(271.02199719, 126.88100191000001，287.02199719, 142.88100191)</span><br><span class="line"></span><br><span class="line">🔹 第 3 行：条款号 条款名称 编列内容</span><br><span class="line">   ➤ 边界框：(64.62499905, 171.73550296999997, 400.2669965399999, 182.23550296999997)</span><br><span class="line">   ➤ 字符数：11</span><br><span class="line">     - 字符：条，位置：(64.62499905, 171.73550296999997，75.12499905, 182.23550296999997)</span><br><span class="line">     - 字符：款，位置：(75.16699905, 171.73550296999997，85.66699905, 182.23550296999997)</span><br><span class="line">     - 字符：号，位置：(85.70899905, 171.73550296999997，96.20899905, 182.23550296999997)</span><br><span class="line"></span><br><span class="line">🔹 第 4 行：名称：杭州滨江奥体博览城开发建</span><br><span class="line">   ➤ 边界框：(219.87500239, 193.33550335999996, 377.37500238999996, 203.83550335999996)</span><br><span class="line">   ➤ 字符数：15</span><br><span class="line">     - 字符：名，位置：(219.87500239, 193.33550335999996，230.37500239, 203.83550335999996)</span><br><span class="line">     - 字符：称，位置：(230.37500239, 193.33550335999996，240.87500239, 203.83550335999996)</span><br><span class="line">     - 字符：：，位置：(240.87500239, 193.33550335999996，251.37500239, 203.83550335999996)</span><br><span class="line"></span><br><span class="line">🔹 第 5 行：设运营管理有限公司</span><br><span class="line">   ➤ 边界框：(219.87500239, 208.93550374000006, 314.37500238999996, 219.43550374000006)</span><br><span class="line">   ➤ 字符数：9</span><br><span class="line">     - 字符：设，位置：(219.87500239, 208.93550374000006，230.37500239, 219.43550374000006)</span><br><span class="line">     - 字符：运，位置：(230.37500239, 208.93550374000006，240.87500239, 219.43550374000006)</span><br><span class="line">     - 字符：营，位置：(240.87500239, 208.93550374000006，251.37500239, 219.43550374000006)</span><br></pre></td></tr></table></figure>

<p><strong>关于extract_words与extract_text_lines的比较见附录6。</strong></p>
<hr>
<h4 id="4-search-…"><a href="#4-search-…" class="headerlink" title="4. search(…)"></a>4. search(…)</h4><p>高亮第三页的<strong>招标人：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 搜索关键词“招标人”，并包含字符对象</span></span><br><span class="line">    matches = page.search(<span class="string">&quot;招标人&quot;</span>, return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成页面图像对象</span></span><br><span class="line">    im = page.to_image(resolution=<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 高亮每一个匹配到的文本区域</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        bbox = (<span class="keyword">match</span>[<span class="string">&quot;x0&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;top&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;x1&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;bottom&quot;</span>])</span><br><span class="line">        im.draw_rect(bbox, stroke=<span class="string">&quot;red&quot;</span>, stroke_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 展示图像</span></span><br><span class="line">    im.show()</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="四-表格提取"><a href="#四-表格提取" class="headerlink" title="四 表格提取"></a>四 表格提取</h3><table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>.find_tables(table_settings=&#123;&#125;)</code></td>
<td>返回多个 <code>Table</code> 对象。<code>Table</code> 对象提供 <code>.cells</code>, <code>.rows</code>, <code>.columns</code>, <code>.bbox</code> 属性以及 <code>.extract(x_tolerance=3, y_tolerance=3)</code> 方法。</td>
</tr>
<tr>
<td><code>.find_table(table_settings=&#123;&#125;)</code></td>
<td>类似于 <code>.find_tables(...)</code>，但只返回页面中<strong>最大的表格</strong>（按单元格数量衡量）。如果多个表格大小相同，则返回离页面顶部最近的一个。</td>
</tr>
<tr>
<td><code>.extract_tables(table_settings=&#123;&#125;)</code></td>
<td>返回页面中所有表格的文本内容，格式为列表嵌套列表嵌套列表：<code>表格 -&gt; 行 -&gt; 单元格</code>。</td>
</tr>
<tr>
<td><code>.extract_table(table_settings=&#123;&#125;)</code></td>
<td>返回页面中最大表格的文本内容，格式为：<code>行 -&gt; 单元格</code>。</td>
</tr>
<tr>
<td><code>.debug_tablefinder(table_settings=&#123;&#125;)</code></td>
<td>返回 <code>TableFinder</code> 类实例，可访问 <code>.edges</code>, <code>.intersections</code>, <code>.cells</code>, <code>.tables</code> 属性。</td>
</tr>
</tbody></table>
<blockquote>
<p>默认情况下，<code>.extract_tables()</code> 使用页面的水平与垂直线（包括矩形边）作为单元格边界。但你可以通过 <code>table_settings</code> 自定义策略和阈值。详细介绍见附录4。</p>
</blockquote>
<h4 id="1-extract-tables-…"><a href="#1-extract-tables-…" class="headerlink" title="1. extract_tables(…)"></a>1. extract_tables(…)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="comment"># 设置要提取的页码（注意：pdfplumber 的页码从 0 开始）</span></span><br><span class="line">    pages_to_extract = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>)) + <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">14</span>, <span class="number">17</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 遍历选中的页面</span></span><br><span class="line">    <span class="keyword">for</span> page_number <span class="keyword">in</span> pages_to_extract:</span><br><span class="line">        page = pdf.pages[page_number]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n🔹 第 <span class="subst">&#123;page_number + <span class="number">1</span>&#125;</span> 页的表格内容：&quot;</span>)</span><br><span class="line"></span><br><span class="line">        tables = page.extract_tables()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果有表格</span></span><br><span class="line">        <span class="keyword">if</span> tables:</span><br><span class="line">            <span class="keyword">for</span> table_index, table <span class="keyword">in</span> <span class="built_in">enumerate</span>(tables):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n  ➤ 表格 <span class="subst">&#123;table_index + <span class="number">1</span>&#125;</span>:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> row <span class="keyword">in</span> table:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;    &quot;</span>, row)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;  ❌ 没有找到表格。&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">🔹 第 1 页的表格内容：</span><br><span class="line">  ❌ 没有找到表格。</span><br><span class="line"></span><br><span class="line">🔹 第 2 页的表格内容：</span><br><span class="line">  ❌ 没有找到表格。</span><br><span class="line"></span><br><span class="line">🔹 第 3 页的表格内容：</span><br><span class="line"></span><br><span class="line">  ➤ 表格 1:</span><br><span class="line">     [<span class="string">&#x27;条款号&#x27;</span>, <span class="string">&#x27;条款名称&#x27;</span>, <span class="string">&#x27;编列内容&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.2&#x27;</span>, <span class="string">&#x27;招标人&#x27;</span>, <span class="string">&#x27;名称：杭州滨江奥体博览城开发建\n设运营管理有限公司\n地址：浙江省杭州市滨江区浦沿街\n道滨安路1338号三楼\n联系人：翁栎超\n电话：13600511926&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.3&#x27;</span>, <span class="string">&#x27;招标代理机构&#x27;</span>, <span class="string">&#x27;名称： 浙江华耀建设咨询有限公司\n地址：杭州市上城区佰富时代中心3幢13楼\n联系人：潘正阳、陈瑶\n电话：13758171369、18757567243&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.4&#x27;</span>, <span class="string">&#x27;工程名称&#x27;</span>, <span class="string">&#x27;奥体街（扬帆路-养正巷）设计&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.5&#x27;</span>, <span class="string">&#x27;建设地点&#x27;</span>, <span class="string">&#x27;杭州市滨江区&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.6&#x27;</span>, <span class="string">&#x27;建设规模&#x27;</span>, <span class="string">&#x27;见招标公告&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.1.7&#x27;</span>, <span class="string">&#x27;投资估算&#x27;</span>, <span class="string">&#x27;本项目投资估算为22798万元&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.2.1&#x27;</span>, <span class="string">&#x27;资金来源及比例&#x27;</span>, <span class="string">&#x27;国有100%&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.2.2&#x27;</span>, <span class="string">&#x27;资金落实情况&#x27;</span>, <span class="string">&#x27;已落实&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1.3.1&#x27;</span>, <span class="string">&#x27;招标范围&#x27;</span>, <span class="string">&#x27;☑方案设计、初步设计（含概算编制和调整）和施工图设计（☑BIM设计\n服务）\n招标内容具体包括:工程设计服务内容： 包括但不限于：\n（1）可研编制（含估算编制）、方案设计及深化、初步设计（含概算\n编制）、施工图设计【含BIM（若有）】、管线综合、交改设计（若\n有，含主体项目交改以及其他配套交改设计）、雨污水管线迁改（若\n有）、基坑设计、报批审查配合、按审查和招标人意见对整个设计过程\n的修改、深化整合等优化设计；\n（2）按招标文件要求提供纸质和电子图纸；\n（3）设计补图和工程施工阶段的变更联系单；\n（4）施工配合、验收配合、竣工图编制配合等相关服务；\n（5）根据工程实际需要提供现场服务等。\n各阶段设计成果应符合国家规定的图纸编制深度要求及相关出图标准要\n求且应满足发包人的相关要求，并应及时完成招标人和相关审查部门的\n阶段性审查意见所提出的修改工作等，特别是相关部门不计次数的优化\n修改要求等。阶段性审查包括方案评审、初步设计审查和施工图审查&#x27;</span>]</span><br><span class="line"></span><br><span class="line">🔹 第 15 页的表格内容：</span><br><span class="line"></span><br><span class="line">  ➤ 表格 1:</span><br><span class="line">     [<span class="string">&#x27;评审因素&#x27;</span>, <span class="string">&#x27;评审内容&#x27;</span>, <span class="string">&#x27;分值&#x27;</span>]</span><br><span class="line"></span><br><span class="line">🔹 第 16 页的表格内容：</span><br><span class="line"></span><br><span class="line">  ➤ 表格 1:</span><br><span class="line">     [<span class="string">&#x27;类似工程业\n绩&#x27;</span>, <span class="string">&#x27;企业业绩：投标人自投标截止日之前5年（含）内（以合\n同签订时间为准）承接过的类似业绩：\n①单个设计合同金额260万元（含）以上的市政道路工程\n设计合同业绩，每一个得1.5分，本项最多得1.5分；\n②单个设计合同包含长度200米（含）以上城市隧道(隧\n道长度含U型槽段)的市政道路工程设计合同业绩，每一\n个得1.5分，本项最多得1.5分。\n（证明材料：设计合同、中标通知书复印件加盖公章，合\n同中必须体现项目属性、时间等项目特征表述；如不能体\n现，不得分。）&#x27;</span>, <span class="string">&#x27;0-3分&#x27;</span>]</span><br><span class="line">     [None, <span class="string">&#x27;项目负责人业绩：投标人自投标截止日之前5年（含）内\n（以合同签订时间为准），拟派项目负责人以项目负责人\n身份负责过的类似业绩：\n①单个设计合同金额260万元（含）以上的市政道路工程\n设计合同业绩，每一个得2分，本项最多得2分；\n② 单个设计合同金额200（含）-260万元市政道路工程\n设计合同业绩，每一个得1分，本项最多得2分。\n（证明材料：设计合同、中标通知书复印件加盖公章，合\n同中必须体现项目属性、时间、项目负责人名字等项目特\n征表述；如不能体现，不得分。）&#x27;</span>, <span class="string">&#x27;0-2分&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;信用评价&#x27;</span>, <span class="string">&#x27;建设行政主管部门信用评价&#x27;</span>, <span class="string">&#x27;0-2分&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;团队配备&#x27;</span>, <span class="string">&#x27;（1）项目班子人员全部满足招标文件人员配备要求（具\n体要求见《附表：项目负责人及人员配备表》）得2分，\n每有一项不满足扣0.5分（最少0分）。\n（2）道路、隧道、给排水、电气专业设计师，具有对应\n专业注册执业资格【如注册土木工程师（岩土）资格、注\n册公用设备工程师（给排水）资格、注册电气工程师（供\n配电）资格】的，提供一个得0.3分，两个得0.6分，三\n个得1分，最高得1分。\n注：项目设计团队中各专业不可兼任。\n(有效证明材料：提供执业资格证书，职称证书，本单位\n近三个月的社保证明（至投标截止时间上溯6个月中任意\n连续3个月的社保缴纳证明），复印件加盖公章。如职称\n证书无法证明专业，以毕业证专业为准。)&#x27;</span>, <span class="string">&#x27;0-3分&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  ➤ 表格 2:</span><br><span class="line">     [<span class="string">&#x27;序号&#x27;</span>, <span class="string">&#x27;职务名称&#x27;</span>, <span class="string">&#x27;最少配备\n数量\n（人）&#x27;</span>, <span class="string">&#x27;职称或职业资格&#x27;</span>, <span class="string">&#x27;备注&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;项目负责人&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有市政公用工程或隧道工程&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br><span class="line"></span><br><span class="line">🔹 第 17 页的表格内容：</span><br><span class="line"></span><br><span class="line">  ➤ 表格 1:</span><br><span class="line">     [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;类高级工程师及以上职称&#x27;</span>, <span class="string">&#x27;&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;道路专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;隧道专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;给排水专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;电气专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;园林专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br><span class="line">     [<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;造价专业负责人&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有注册一级造价师资格&#x27;</span>, <span class="string">&#x27;全过程&#x27;</span>]</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="2-find-tables-…"><a href="#2-find-tables-…" class="headerlink" title="2. find_tables(…)"></a>2. find_tables(…)</h4><p><strong>直接上代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;../../招标文件修订-1.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    <span class="comment"># 定义页码范围（注意：页码从 0 开始）</span></span><br><span class="line">    target_pages = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>)) + <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">14</span>, <span class="number">17</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> page_num <span class="keyword">in</span> target_pages:</span><br><span class="line">        <span class="keyword">if</span> page_num &gt;= <span class="built_in">len</span>(pdf.pages):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;⚠️ 页码 <span class="subst">&#123;page_num + <span class="number">1</span>&#125;</span> 超出 PDF 页数范围。&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n================ 📄 第 <span class="subst">&#123;page_num + <span class="number">1</span>&#125;</span> 页 ================&quot;</span>)</span><br><span class="line">        page = pdf.pages[page_num]</span><br><span class="line">        tables = page.find_tables()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> tables:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;❌ 没有找到表格。&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i, table <span class="keyword">in</span> <span class="built_in">enumerate</span>(tables):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n🔹 表格 <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>:&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 1. 表格边界框</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;📏 bbox 边界框:&quot;</span>, table.bbox)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 2. 单元格</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;🧱 cells（共 <span class="subst">&#123;<span class="built_in">len</span>(table.cells)&#125;</span> 个单元格）:&quot;</span>)</span><br><span class="line">                <span class="comment"># 获取前两个和最后两个</span></span><br><span class="line">                cells_to_show = table.cells[:<span class="number">2</span>] + table.cells[-<span class="number">2</span>:] <span class="keyword">if</span> <span class="built_in">len</span>(table.cells) &gt; <span class="number">4</span> <span class="keyword">else</span> table.cells</span><br><span class="line">                <span class="keyword">for</span> idx, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(cells_to_show, <span class="number">1</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  → 第 <span class="subst">&#123;idx&#125;</span> 个单元格: <span class="subst">&#123;cell&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 3. 行（完整打印每个单元格）</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;📋 rows（共 <span class="subst">&#123;<span class="built_in">len</span>(table.rows)&#125;</span> 行）:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> row_idx, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(table.rows):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  ⬇ 第 <span class="subst">&#123;row_idx + <span class="number">1</span>&#125;</span> 行:&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> col_idx, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(row.cells):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;     → 第 <span class="subst">&#123;col_idx + <span class="number">1</span>&#125;</span> 列单元格内容: <span class="subst">&#123;cell&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 4. 列（完整打印每个单元格）</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;📊 columns（共 <span class="subst">&#123;<span class="built_in">len</span>(table.columns)&#125;</span> 列）:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> col_idx, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(table.columns):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  ⬅ 第 <span class="subst">&#123;col_idx + <span class="number">1</span>&#125;</span> 列:&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> row_idx, cell <span class="keyword">in</span> <span class="built_in">enumerate</span>(col.cells):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;     → 第 <span class="subst">&#123;row_idx + <span class="number">1</span>&#125;</span> 行单元格内容: <span class="subst">&#123;cell&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 5. 提取文本形式的表格</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;📄 表格内容（使用 extract 提取）:&quot;</span>)</span><br><span class="line">                extracted = table.extract(x_tolerance=<span class="number">3</span>, y_tolerance=<span class="number">3</span>)</span><br><span class="line">                <span class="keyword">for</span> row <span class="keyword">in</span> extracted:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;   &quot;</span>, row)</span><br></pre></td></tr></table></figure>

<p><strong>输出（这里仅以前三页为例进行说明）：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">================ 📄 第 1 页 ================</span><br><span class="line">❌ 没有找到表格。</span><br><span class="line"></span><br><span class="line">================ 📄 第 2 页 ================</span><br><span class="line">❌ 没有找到表格。</span><br><span class="line"></span><br><span class="line">================ 📄 第 3 页 ================</span><br><span class="line"></span><br><span class="line">🔹 表格 1:</span><br><span class="line">📏 bbox 边界框: (51.42499924, 166.80000305, 543.87501145, 761.84999084)</span><br><span class="line">🧱 cells（共 30 个单元格）:</span><br><span class="line">  → 第 1 个单元格: (51.42499924, 166.80000305, 122.32500077, 184.95000267)</span><br><span class="line">  → 第 2 个单元格: (51.42499924, 184.95000267, 122.32500077, 297.55000305)</span><br><span class="line">  → 第 3 个单元格: (214.47500228999996, 487.84999084, 543.87501145, 511.74998474)</span><br><span class="line">  → 第 4 个单元格: (214.47500228999996, 511.74998474, 543.87501145, 761.84999084)</span><br><span class="line">📋 rows（共 10 行）:</span><br><span class="line">  ⬇ 第 1 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 166.80000305, 122.32500077, 184.95000267)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 166.80000305, 214.47500228999996, 184.95000267)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 166.80000305, 543.87501145, 184.95000267)</span><br><span class="line">  ⬇ 第 2 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 184.95000267, 122.32500077, 297.55000305)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 184.95000267, 214.47500228999996, 297.55000305)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 184.95000267, 543.87501145, 297.55000305)</span><br><span class="line">  ⬇ 第 3 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 297.55000305, 122.32500077, 368.05000305)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 297.55000305, 214.47500228999996, 368.05000305)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 297.55000305, 543.87501145, 368.05000305)</span><br><span class="line">  ⬇ 第 4 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 368.05000305, 122.32500077, 392.1000061)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 368.05000305, 214.47500228999996, 392.1000061)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 368.05000305, 543.87501145, 392.1000061)</span><br><span class="line">  ⬇ 第 5 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 392.1000061, 122.32500077, 416.0)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 392.1000061, 214.47500228999996, 416.0)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 392.1000061, 543.87501145, 416.0)</span><br><span class="line">  ⬇ 第 6 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 416.0, 122.32500077, 439.90000914999996)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 416.0, 214.47500228999996, 439.90000914999996)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 416.0, 543.87501145, 439.90000914999996)</span><br><span class="line">  ⬇ 第 7 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 439.90000914999996, 122.32500077, 463.80000305)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 439.90000914999996, 214.47500228999996, 463.80000305)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 439.90000914999996, 543.87501145, 463.80000305)</span><br><span class="line">  ⬇ 第 8 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 463.80000305, 122.32500077, 487.84999084)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 463.80000305, 214.47500228999996, 487.84999084)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 463.80000305, 543.87501145, 487.84999084)</span><br><span class="line">  ⬇ 第 9 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 487.84999084, 122.32500077, 511.74998474)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 487.84999084, 214.47500228999996, 511.74998474)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 487.84999084, 543.87501145, 511.74998474)</span><br><span class="line">  ⬇ 第 10 行:</span><br><span class="line">     → 第 1 列单元格内容: (51.42499924, 511.74998474, 122.32500077, 761.84999084)</span><br><span class="line">     → 第 2 列单元格内容: (122.32500077, 511.74998474, 214.47500228999996, 761.84999084)</span><br><span class="line">     → 第 3 列单元格内容: (214.47500228999996, 511.74998474, 543.87501145, 761.84999084)</span><br><span class="line">📊 columns（共 3 列）:</span><br><span class="line">  ⬅ 第 1 列:</span><br><span class="line">     → 第 1 行单元格内容: (51.42499924, 166.80000305, 122.32500077, 184.95000267)</span><br><span class="line">     → 第 2 行单元格内容: (51.42499924, 184.95000267, 122.32500077, 297.55000305)</span><br><span class="line">     → 第 3 行单元格内容: (51.42499924, 297.55000305, 122.32500077, 368.05000305)</span><br><span class="line">     → 第 4 行单元格内容: (51.42499924, 368.05000305, 122.32500077, 392.1000061)</span><br><span class="line">     → 第 5 行单元格内容: (51.42499924, 392.1000061, 122.32500077, 416.0)</span><br><span class="line">     → 第 6 行单元格内容: (51.42499924, 416.0, 122.32500077, 439.90000914999996)</span><br><span class="line">     → 第 7 行单元格内容: (51.42499924, 439.90000914999996, 122.32500077, 463.80000305)</span><br><span class="line">     → 第 8 行单元格内容: (51.42499924, 463.80000305, 122.32500077, 487.84999084)</span><br><span class="line">     → 第 9 行单元格内容: (51.42499924, 487.84999084, 122.32500077, 511.74998474)</span><br><span class="line">     → 第 10 行单元格内容: (51.42499924, 511.74998474, 122.32500077, 761.84999084)</span><br><span class="line">  ⬅ 第 2 列:</span><br><span class="line">     → 第 1 行单元格内容: (122.32500077, 166.80000305, 214.47500228999996, 184.95000267)</span><br><span class="line">     → 第 2 行单元格内容: (122.32500077, 184.95000267, 214.47500228999996, 297.55000305)</span><br><span class="line">     → 第 3 行单元格内容: (122.32500077, 297.55000305, 214.47500228999996, 368.05000305)</span><br><span class="line">     → 第 4 行单元格内容: (122.32500077, 368.05000305, 214.47500228999996, 392.1000061)</span><br><span class="line">     → 第 5 行单元格内容: (122.32500077, 392.1000061, 214.47500228999996, 416.0)</span><br><span class="line">     → 第 6 行单元格内容: (122.32500077, 416.0, 214.47500228999996, 439.90000914999996)</span><br><span class="line">     → 第 7 行单元格内容: (122.32500077, 439.90000914999996, 214.47500228999996, 463.80000305)</span><br><span class="line">     → 第 8 行单元格内容: (122.32500077, 463.80000305, 214.47500228999996, 487.84999084)</span><br><span class="line">     → 第 9 行单元格内容: (122.32500077, 487.84999084, 214.47500228999996, 511.74998474)</span><br><span class="line">     → 第 10 行单元格内容: (122.32500077, 511.74998474, 214.47500228999996, 761.84999084)</span><br><span class="line">  ⬅ 第 3 列:</span><br><span class="line">     → 第 1 行单元格内容: (214.47500228999996, 166.80000305, 543.87501145, 184.95000267)</span><br><span class="line">     → 第 2 行单元格内容: (214.47500228999996, 184.95000267, 543.87501145, 297.55000305)</span><br><span class="line">     → 第 3 行单元格内容: (214.47500228999996, 297.55000305, 543.87501145, 368.05000305)</span><br><span class="line">     → 第 4 行单元格内容: (214.47500228999996, 368.05000305, 543.87501145, 392.1000061)</span><br><span class="line">     → 第 5 行单元格内容: (214.47500228999996, 392.1000061, 543.87501145, 416.0)</span><br><span class="line">     → 第 6 行单元格内容: (214.47500228999996, 416.0, 543.87501145, 439.90000914999996)</span><br><span class="line">     → 第 7 行单元格内容: (214.47500228999996, 439.90000914999996, 543.87501145, 463.80000305)</span><br><span class="line">     → 第 8 行单元格内容: (214.47500228999996, 463.80000305, 543.87501145, 487.84999084)</span><br><span class="line">     → 第 9 行单元格内容: (214.47500228999996, 487.84999084, 543.87501145, 511.74998474)</span><br><span class="line">     → 第 10 行单元格内容: (214.47500228999996, 511.74998474, 543.87501145, 761.84999084)</span><br><span class="line">📄 表格内容（使用 extract 提取）:</span><br><span class="line">    [<span class="string">&#x27;条款号&#x27;</span>, <span class="string">&#x27;条款名称&#x27;</span>, <span class="string">&#x27;编列内容&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.2&#x27;</span>, <span class="string">&#x27;招标人&#x27;</span>, <span class="string">&#x27;名称：杭州滨江奥体博览城开发建\n设运营管理有限公司\n地址：浙江省杭州市滨江区浦沿街\n道滨安路1338号三楼\n联系人：翁栎超\n电话：13600511926&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.3&#x27;</span>, <span class="string">&#x27;招标代理机构&#x27;</span>, <span class="string">&#x27;名称： 浙江华耀建设咨询有限公司\n地址：杭州市上城区佰富时代中心3幢13楼\n联系人：潘正阳、陈瑶\n电话：13758171369、18757567243&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.4&#x27;</span>, <span class="string">&#x27;工程名称&#x27;</span>, <span class="string">&#x27;奥体街（扬帆路-养正巷）设计&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.5&#x27;</span>, <span class="string">&#x27;建设地点&#x27;</span>, <span class="string">&#x27;杭州市滨江区&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.6&#x27;</span>, <span class="string">&#x27;建设规模&#x27;</span>, <span class="string">&#x27;见招标公告&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.1.7&#x27;</span>, <span class="string">&#x27;投资估算&#x27;</span>, <span class="string">&#x27;本项目投资估算为22798万元&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.2.1&#x27;</span>, <span class="string">&#x27;资金来源及比例&#x27;</span>, <span class="string">&#x27;国有100%&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.2.2&#x27;</span>, <span class="string">&#x27;资金落实情况&#x27;</span>, <span class="string">&#x27;已落实&#x27;</span>]</span><br><span class="line">    [<span class="string">&#x27;1.3.1&#x27;</span>, <span class="string">&#x27;招标范围&#x27;</span>, <span class="string">&#x27;☑方案设计、初步设计（含概算编制和调整）和施工图设计（☑BIM设计\n服务）\n招标内容具体包括:工程设计服务内容： 包括但不限于：\n（1）可研编制（含估算编制）、方案设计及深化、初步设计（含概算\n编制）、施工图设计【含BIM（若有）】、管线综合、交改设计（若\n有，含主体项目交改以及其他配套交改设计）、雨污水管线迁改（若\n有）、基坑设计、报批审查配合、按审查和招标人意见对整个设计过程\n的修改、深化整合等优化设计；\n（2）按招标文件要求提供纸质和电子图纸；\n（3）设计补图和工程施工阶段的变更联系单；\n（4）施工配合、验收配合、竣工图编制配合等相关服务；\n（5）根据工程实际需要提供现场服务等。\n各阶段设计成果应符合国家规定的图纸编制深度要求及相关出图标准要\n求且应满足发包人的相关要求，并应及时完成招标人和相关审查部门的\n阶段性审查意见所提出的修改工作等，特别是相关部门不计次数的优化\n修改要求等。阶段性审查包括方案评审、初步设计审查和施工图审查&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><strong>说明：</strong></p>
<ol>
<li><p>上方的坐标单位是”points”(pt)，也叫PDF单位。</p>
<blockquote>
<p>1 point &#x3D; 1&#x2F;72 inch，72 pt &#x3D; 1 英寸 ≈ 2.54 cm</p>
</blockquote>
</li>
<li><p>上方的四个坐标均为(x0, top, x1, bottom)</p>
<table>
<thead>
<tr>
<th align="center">标志</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">x0</td>
<td align="center">左边框到页面左边框距离</td>
</tr>
<tr>
<td align="center">top</td>
<td align="center">上边框到页面上边框的距离</td>
</tr>
<tr>
<td align="center">x1</td>
<td align="center">右边框到页面左边框的距离</td>
</tr>
<tr>
<td align="center">bottom</td>
<td align="center">下边框到页面上边框的距离</td>
</tr>
</tbody></table>
</li>
<li><p>bbox 边界框: (51.42499924, 166.80000305, 543.87501145, 761.84999084)表示当前整个表格的坐标位置，左边框距离页面左边缘51.42 pt，上边框距离页面上边缘166.80 pt，右边框距离页面左边缘543.88 pt，下边框距离页面上边缘761.85 pt。</p>
</li>
<li><p>cells表示当前表格有多少各单元格，顺序为从上到下，从左到右，这里只打印出了前两个和最后两个，可以看出第一个单元格的前两位与最后一个单元格的后两位组合即为bbox边界框。</p>
</li>
<li><p>row表示按行读取，可以看出对于同一行来说，top和bottom是一样的。</p>
</li>
<li><p>columns表示按列读取，可以看出对于同一列，x0和x1是一样的。</p>
</li>
<li><p>最终extract提取的内容和extract_tables()提取的内容一样。</p>
</li>
</ol>
<h4 id="3-对比"><a href="#3-对比" class="headerlink" title="3. 对比"></a>3. 对比</h4><p>比较下上面提到的两种方式：</p>
<ul>
<li><code>.find_tables()</code> ➕ <code>.extract()</code></li>
<li><code>.extract_tables()</code></li>
</ul>
<p>本质上都是为了提取表格内容，但它们在使用方式和控制粒度上<strong>有所区别</strong>。下面是详细解释：</p>
<p>✅ <code>.find_tables() + .extract()</code> 的特点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tables = page.find_tables()</span><br><span class="line"><span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">    data = table.extract()</span><br></pre></td></tr></table></figure>

<p><strong>优势</strong>：</p>
<ul>
<li>返回的是 <code>Table</code> 对象，可以访问更多属性：<ul>
<li><code>.cells</code>: 表格所有单元格（包含位置和内容）</li>
<li><code>.bbox</code>: 表格边界框</li>
<li><code>.rows</code>, <code>.columns</code>: 每行每列的单元格</li>
</ul>
</li>
<li>更适合<strong>需要对表格结构进行进一步分析或可视化</strong>的场景。</li>
<li>可以在提取前对每个表格单独处理，例如筛选特定大小或位置的表格。</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>稍微复杂一些，不适合只想快速提取文本的简单场景。</li>
</ul>
<p>✅ <code>.extract_tables()</code> 的特点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tables = page.extract_tables()</span><br></pre></td></tr></table></figure>

<p><strong>优势</strong>：</p>
<ul>
<li>更<strong>快速、直接</strong>，返回的是一个<strong>嵌套列表结构</strong>：<ul>
<li>结构：<code>[table1, table2, ...]</code>，每个 table 是一个 <code>[[cell1, cell2, ...], [...], ...]</code></li>
</ul>
</li>
<li>更适合<strong>快速获取纯文本表格</strong>内容并打印或导出。</li>
<li>实际内部就是调用了 <code>find_tables(...).extract()</code> 的封装。</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>不返回 <code>Table</code> 对象，因此<strong>无法访问单元格位置、表格边界等高级信息</strong>。</li>
<li>无法对表格结构进行更多控制。</li>
</ul>
<p>📌 总结对比表</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>返回类型</th>
<th>能访问结构信息</th>
<th>操作复杂度</th>
<th>适合场景</th>
</tr>
</thead>
<tbody><tr>
<td><code>.find_tables() + .extract()</code></td>
<td><code>Table</code> 对象 + 列表</td>
<td>✅ 是</td>
<td>稍复杂</td>
<td>表格结构分析、自定义过滤</td>
</tr>
<tr>
<td><code>.extract_tables()</code></td>
<td>嵌套列表</td>
<td>❌ 否</td>
<td>简单</td>
<td>快速提取所有表格纯文本内容</td>
</tr>
</tbody></table>
<p>✅ 建议使用方式</p>
<ul>
<li><strong>只想提取表格内容文本</strong> → <code>extract_tables()</code> 更快更方便；</li>
<li><strong>想进一步分析表格结构、位置或可视化</strong> → 使用 <code>find_tables()</code> 和 <code>.extract()</code> 更灵活。</li>
</ul>
<hr>
<h3 id="五-Page-crop-…"><a href="#五-Page-crop-…" class="headerlink" title="五 Page.crop(…)"></a>五 Page.crop(…)</h3><table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>.crop(bounding_box, relative&#x3D;False, strict&#x3D;True)</td>
<td>返回一个<strong>裁剪到指定边界框</strong>（bounding box）的页面版本。边界框应表示为一个 4 元组，格式为 <code>(x0, top, x1, bottom)</code>。裁剪后的页面<strong>保留那些至少部分位于边界框内的对象</strong>。如果某个对象<strong>只有一部分位于边界框内</strong>，那么它的尺寸将被截取以适应这个边界框。如果设置 <code>relative=True</code>，则边界框的坐标将<strong>相对于页面左上角进行偏移计算</strong>（而不是使用绝对位置）。（详见 <a target="_blank" rel="noopener" href="https://github.com/jsvine/pdfplumber/issues/245">Issue #245</a> 以获取图示和解释。）当 <code>strict=True</code>（默认值）时，要求<strong>裁剪边界框必须完全位于页面边界框之内</strong>，否则将引发错误。</td>
</tr>
</tbody></table>
<p>按上面<code>find_tables</code>一节中第17页输出的<code>bbox</code>坐标信息提取表格并保存下来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># PDF 路径和裁剪区域（bbox）</span></span><br><span class="line">pdf_path = <span class="string">&quot;../../招标文件修订-1.pdf&quot;</span></span><br><span class="line">page_number = <span class="number">16</span>  <span class="comment"># 第17业</span></span><br><span class="line">crop_bbox = (<span class="number">88.1</span>, <span class="number">72.25</span>, <span class="number">516.05</span>, <span class="number">226.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 并处理指定页面</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[page_number]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 裁剪指定区域</span></span><br><span class="line">    cropped_page = page.crop(crop_bbox)</span><br><span class="line">    tables = cropped_page.extract_tables()</span><br><span class="line">    <span class="comment"># 如果有表格</span></span><br><span class="line">    <span class="keyword">if</span> tables:</span><br><span class="line">        <span class="keyword">for</span> table_index, table <span class="keyword">in</span> <span class="built_in">enumerate</span>(tables):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n  ➤ 表格 <span class="subst">&#123;table_index + <span class="number">1</span>&#125;</span>:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> table:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;    &quot;</span>, row)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  ❌ 没有找到表格。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 渲染为图像（默认 resolution=72 dpi，可调高提升清晰度）</span></span><br><span class="line">    image = cropped_page.to_image(resolution=<span class="number">150</span>)  <span class="comment"># 150 或 200 更清晰</span></span><br><span class="line"></span><br><span class="line">    image.save(<span class="string">&quot;table.png&quot;</span>, <span class="built_in">format</span>=<span class="string">&quot;PNG&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>输出：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➤ 表格 1:</span><br><span class="line">   [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;类高级工程师及以上职称&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;道路专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;隧道专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;给排水专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;电气专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;园林专业设计师&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有工程师及以上职称&#x27;</span>]</span><br><span class="line">   [<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;造价专业负责人&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;具有注册一级造价师资格&#x27;</span>]</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="✅正文"><a href="#✅正文" class="headerlink" title="✅正文"></a>✅正文</h2><h3 id="混合表格-文本"><a href="#混合表格-文本" class="headerlink" title="混合表格&#x2F;文本"></a>混合表格&#x2F;文本</h3><p>如果使用<code>extract_text_line()</code>会将所有内容按行读取，会丢失表格的结构，故表格需用<code>find_tables()+extract()</code>提取（因为单纯的<code>extract_tables()</code>拿不到坐标信息）,合理运用<code>extract_text_line</code>+<code>find_tables+extract</code>+<code>crop</code>是解析混合表格+普通文本的PDF文件的关键。</p>
<p>思路：</p>
<ul>
<li>先提取所有表格，记录他们的<code>bounding boxes</code></li>
<li>再提取所有文本行，排除那些出现在表格中的行</li>
</ul>
<p><strong>万丈高楼平地起，咱们一个问题一个问题的解决，先从最基本的代码来看：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_text_and_tables</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 提取文本行（按视觉顺序）</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                result.append(&#123;</span><br><span class="line">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 提取表格（按每页顺序）</span></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> page.find_tables():</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    result.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../招标文件修订-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_output.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_text_and_tables(pdf_path, max_pages=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;已完成提取并保存至：<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>此时的问题：表格内容读取两次，解决方式：通过坐标判断text是否属于table范围</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_in_any_table</span>(<span class="params">line, table_bboxes</span>):</span><br><span class="line">    y = line[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x0, top, x1, bottom <span class="keyword">in</span> table_bboxes:</span><br><span class="line">        <span class="keyword">if</span> top &lt;= y &lt;= bottom:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_text_and_tables</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: 提取表格及其位置</span></span><br><span class="line">            tables = page.find_tables()</span><br><span class="line">            table_bboxes = [t.bbox <span class="keyword">for</span> t <span class="keyword">in</span> tables]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    result.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: 提取非表格文本行</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> is_in_any_table(line, table_bboxes):</span><br><span class="line">                    result.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../招标文件修订-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_clean.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_text_and_tables(pdf_path, max_pages=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;提取完成，结果已保存至：<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>此时的问题：虽然表格只读取一次了，但顺序不对，总是先写入table内容再写入text内容，解决办法：写入到result之前先按坐标排序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_in_any_table</span>(<span class="params">line, table_bboxes</span>):</span><br><span class="line">    y = line[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x0, top, x1, bottom <span class="keyword">in</span> table_bboxes:</span><br><span class="line">        <span class="keyword">if</span> top &lt;= y &lt;= bottom:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_ordered_content</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            items_on_page = []</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: 提取表格及其bbox</span></span><br><span class="line">            tables = page.find_tables()</span><br><span class="line">            table_bboxes = [t.bbox <span class="keyword">for</span> t <span class="keyword">in</span> tables]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    <span class="comment"># 使用表格的 bbox.top 作为排序依据</span></span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: table.bbox[<span class="number">1</span>],  <span class="comment"># bbox = (x0, top, x1, bottom)</span></span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: 提取非表格文本行</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> is_in_any_table(line, table_bboxes):</span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: line[<span class="string">&quot;top&quot;</span>],</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 3: 按 top 坐标排序，模拟阅读顺序</span></span><br><span class="line">            items_on_page.sort(key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;top&quot;</span>])</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> items_on_page:</span><br><span class="line">                <span class="keyword">del</span> item[<span class="string">&quot;top&quot;</span>]  <span class="comment"># 删除坐标，只保留内容</span></span><br><span class="line">                result.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../招标文件修订-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_ordered.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_ordered_content(pdf_path, max_pages=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;提取完成，顺序已处理，结果已保存至：<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>现在顺序对了，但是需对续表增加一点处理，对于下面的续表，应将内容附加到上一页对应位置的末尾</strong></p>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_in_any_table</span>(<span class="params">line, table_bboxes</span>):</span><br><span class="line">    y = line[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x0, top, x1, bottom <span class="keyword">in</span> table_bboxes:</span><br><span class="line">        <span class="keyword">if</span> top &lt;= y &lt;= bottom:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_pdf_ordered_content_merged</span>(<span class="params">pdf_path, max_pages=<span class="literal">None</span></span>):</span><br><span class="line">    result = []</span><br><span class="line">    last_table_ref = <span class="literal">None</span>  <span class="comment"># 用于存储上一页的表格引用</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(pdf_path) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="keyword">for</span> i, page <span class="keyword">in</span> <span class="built_in">enumerate</span>(pdf.pages):</span><br><span class="line">            <span class="keyword">if</span> max_pages <span class="keyword">and</span> i &gt;= max_pages:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            items_on_page = []</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: 提取表格及其bbox</span></span><br><span class="line">            tables = page.find_tables()</span><br><span class="line">            table_bboxes = [t.bbox <span class="keyword">for</span> t <span class="keyword">in</span> tables]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">                table_data = table.extract()</span><br><span class="line">                <span class="keyword">if</span> table_data:</span><br><span class="line">                    <span class="comment"># 检查是否为续表的首行（第一列为空字符串）</span></span><br><span class="line">                    <span class="keyword">if</span> table_data <span class="keyword">and</span> table_data[<span class="number">0</span>] <span class="keyword">and</span> table_data[<span class="number">0</span>][<span class="number">0</span>].strip() == <span class="string">&quot;&quot;</span> <span class="keyword">and</span> last_table_ref:</span><br><span class="line">                        <span class="comment"># 合并到上一页的最后一行</span></span><br><span class="line">                        last_row = last_table_ref[-<span class="number">1</span>]</span><br><span class="line">                        new_row = table_data[<span class="number">0</span>]</span><br><span class="line">                        <span class="comment"># 将续表行的每个非空单元格合并到 last_row</span></span><br><span class="line">                        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(new_row)):</span><br><span class="line">                            <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(last_row) <span class="keyword">and</span> new_row[j].strip():</span><br><span class="line">                                last_row[j] += new_row[j]</span><br><span class="line">                        <span class="comment"># 删除首行</span></span><br><span class="line">                        table_data = table_data[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># 添加当前表格</span></span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: table.bbox[<span class="number">1</span>],</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: table_data</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># 更新 last_table_ref（只存储表格数据部分）</span></span><br><span class="line">                    last_table_ref = table_data</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: 提取非表格文本行</span></span><br><span class="line">            lines = page.extract_text_lines()</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> is_in_any_table(line, table_bboxes):</span><br><span class="line">                    items_on_page.append(&#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;top&quot;</span>: line[<span class="string">&quot;top&quot;</span>],</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: line[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">                    &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 3: 排序并清理</span></span><br><span class="line">            items_on_page.sort(key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;top&quot;</span>])</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> items_on_page:</span><br><span class="line">                <span class="keyword">del</span> item[<span class="string">&quot;top&quot;</span>]</span><br><span class="line">                result.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pdf_path = <span class="string">&quot;../../招标文件修订-1.pdf&quot;</span></span><br><span class="line">    output_path = <span class="string">&quot;mixed_content_ordered.json&quot;</span></span><br><span class="line"></span><br><span class="line">    content = extract_pdf_ordered_content_merged(pdf_path, max_pages=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(content, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;提取完成，顺序已处理，结果已保存至：<span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>到这里完成了基本的表格&#x2F;文本混合格式的pdf文件的解析，这里展示下第三页的解析结果：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;第二章 投标人须知&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;投标人须知前附表&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;table&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;条款号&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;条款名称&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;编列内容&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;招标人&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;名称：杭州滨江奥体博览城开发建\n设运营管理有限公司\n地址：浙江省杭州市滨江区浦沿街\n道滨安路1338号三楼\n联系人：翁栎超\n电话：13600511926&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;招标代理机构&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;名称： 浙江华耀建设咨询有限公司\n地址：杭州市上城区佰富时代中心3幢13楼\n联系人：潘正阳、陈瑶\n电话：13758171369、18757567243&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.4&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;工程名称&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;奥体街（扬帆路-养正巷）设计&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;建设地点&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;杭州市滨江区&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.6&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;建设规模&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;见招标公告&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.1.7&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;投资估算&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;本项目投资估算为22798万元&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.2.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;资金来源及比例&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;国有100%&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.2.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;资金落实情况&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;已落实&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="punctuation">[</span></span><br><span class="line">       <span class="string">&quot;1.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;招标范围&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="string">&quot;☑方案设计、初步设计（含概算编制和调整）和施工图设计（☑BIM设计\n服务）\n招标内容具体包括:工程设计服务内容： 包括但不限于：\n（1）可研编制（含估算编制）、方案设计及深化、初步设计（含概算\n编制）、施工图设计【含BIM（若有）】、管线综合、交改设计（若\n有，含主体项目交改以及其他配套交改设计）、雨污水管线迁改（若\n有）、基坑设计、报批审查配合、按审查和招标人意见对整个设计过程\n的修改、深化整合等优化设计；\n（2）按招标文件要求提供纸质和电子图纸；\n（3）设计补图和工程施工阶段的变更联系单；\n（4）施工配合、验收配合、竣工图编制配合等相关服务；\n（5）根据工程实际需要提供现场服务等。\n各阶段设计成果应符合国家规定的图纸编制深度要求及相关出图标准要\n求且应满足发包人的相关要求，并应及时完成招标人和相关审查部门的\n阶段性审查意见所提出的修改工作等，特别是相关部门不计次数的优化\n修改要求等。阶段性审查包括方案评审、初步设计审查和施工图审查等。设计单位提供给招标人的设计成果必须保证其完整性和准确性。&quot;</span></span><br><span class="line">     <span class="punctuation">]</span></span><br><span class="line">   <span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;12&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<h3 id="✅留坑"><a href="#✅留坑" class="headerlink" title="✅留坑"></a>✅留坑</h3><p>留个坑，下面的优化方向是更好的格式化，比如以章节分类，表格内容中将表头信息写进去等等…现在先去玩下clip(另一个项目可能要用)。</p>
<hr>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="1-page-extract-text"><a href="#1-page-extract-text" class="headerlink" title="1 page.extract_text"></a>1 page.extract_text</h3><p>设想你有一页 PDF，其内容如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello   world!</span><br><span class="line">This    is   a    <span class="built_in">test</span>.</span><br></pre></td></tr></table></figure>

<p>PDF 中字符的位置是精确坐标排布的，字符之间<strong>不一定有真正的空格字符</strong>，它们可能只是间隔了一段距离。在这种情况下，你希望把字符<strong>正确拼接成有空格、有换行</strong>的文本，就需要依赖 <code>.extract_text()</code> 的各个参数来帮你控制提取逻辑。</p>
<p>✅ 示例：如何作用的？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">page.extract_text(</span><br><span class="line">    x_tolerance=<span class="number">3</span>,</span><br><span class="line">    y_tolerance=<span class="number">3</span>,</span><br><span class="line">    layout=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>x_tolerance=3</code></td>
<td>两个字符之间水平距离（下一个字符的 <code>x0</code> - 当前字符的 <code>x1</code>）超过 3，就认为它们之间有空格。太小会漏掉空格，太大可能乱加空格。</td>
</tr>
<tr>
<td><code>y_tolerance=3</code></td>
<td>两个字符的垂直位置（<code>doctop</code>）相差超过 3，就认为要换行。</td>
</tr>
<tr>
<td><code>layout=False</code></td>
<td>不考虑页面的原始排版，只按字符间距和垂直差距插入空格或换行。</td>
</tr>
</tbody></table>
<p>🔁 加入 <code>x_tolerance_ratio</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">page.extract_text(</span><br><span class="line">    x_tolerance=<span class="literal">None</span>,</span><br><span class="line">    x_tolerance_ratio=<span class="number">0.4</span>,</span><br><span class="line">    layout=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>x_tolerance_ratio=0.4</code></td>
<td>设置一个相对间隔阈值。比如当前字符字体大小是 <code>10</code>，那只要两个字符横向间距 &gt; <code>10 * 0.4 = 4</code> 就认为它们之间应该加空格。用于应对不同字号的情况。</td>
</tr>
</tbody></table>
<p>🧱 使用 <code>layout=True</code> 模拟原始排版</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">page.extract_text(</span><br><span class="line">    layout=<span class="literal">True</span>,</span><br><span class="line">    x_density=<span class="number">5</span>,</span><br><span class="line">    y_density=<span class="number">10</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>layout=True</code></td>
<td>按页面结构提取文本，不只是纯拼接字符，会尝试还原换行、列、段落。适合有表格或双栏内容的 PDF。</td>
</tr>
<tr>
<td><code>x_density=5</code></td>
<td>控制水平方向密度。值越小，认为字符间隔“正常”的阈值越小，字符更容易被断开成不同“列”。</td>
</tr>
<tr>
<td><code>y_density=10</code></td>
<td>控制垂直方向密度。值越小，换行更频繁。</td>
</tr>
</tbody></table>
<p>↕️ 字符&#x2F;行方向控制</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python复制编辑page.extract_text(</span><br><span class="line">    <span class="attribute">layout</span>=<span class="literal">True</span>,</span><br><span class="line">    <span class="attribute">line_dir_render</span>=<span class="string">&quot;ttb&quot;</span>,      # 行从上到下</span><br><span class="line">    <span class="attribute">char_dir_render</span>=<span class="string">&quot;ltr&quot;</span>       # 字从左到右</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>这两个参数用于控制输出文本的方向，适用于例如竖排日文、繁体中文文档的布局解析。</p>
<hr>
<h3 id="2-第二页-第三页"><a href="#2-第二页-第三页" class="headerlink" title="2 第二页+第三页"></a>2 第二页+第三页</h3><p><strong>第二页：</strong></p>


<p><strong>第三页：</strong></p>


<hr>
<h3 id="3-layout-True"><a href="#3-layout-True" class="headerlink" title="3 layout&#x3D;True"></a>3 layout&#x3D;True</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line">--- 第 1 页 ---</span><br><span class="line"></span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                杭州市房屋建筑和市政基础设施项目                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                          设计招标文件示范文本                                                </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                   （资格后审）                                           </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                   （2019年版）                                         </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                            杭州市城乡建设委员会制                                             </span><br><span class="line">                                                                                    </span><br><span class="line">                                  二0二五年四月                                           </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                          01                                        </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- 第 2 页 ---</span><br><span class="line"></span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                            奥体街（扬帆路-养正巷）设计                                          </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                          （招标编号：A3301080120526863001221）                            </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                   招标文件                                             </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                        （☑资格后审□邀请招标）                                                </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">            招标人：杭州滨江奥体博览城开发建设运营管理有限公司                        （盖单位章）                 </span><br><span class="line">                                                                                    </span><br><span class="line">                 招标代理机构：浙江华耀建设咨询有限公司                    （盖单位章）                      </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                           2025年05月15日                              </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line">                                          11                                        </span><br><span class="line">                                                                                    </span><br><span class="line">                                                                                    </span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">--- 第 3 页 ---</span><br><span class="line"></span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                第二章       投标人须知                                   </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                 投标人须知前附表                                         </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">         条款号        条款名称                         编列内容                             </span><br><span class="line">                                                                                  </span><br><span class="line">                              名称：杭州滨江奥体博览城开发建                                     </span><br><span class="line">                              设运营管理有限公司                                           </span><br><span class="line">                                                                                  </span><br><span class="line">                              地址：浙江省杭州市滨江区浦沿街                                     </span><br><span class="line">          1.1.2      招标人                                                          </span><br><span class="line">                              道滨安路1338号三楼                                         </span><br><span class="line">                              联系人：翁栎超                                             </span><br><span class="line">                              电话：13600511926                                      </span><br><span class="line">                              名称：  浙江华耀建设咨询有限公司                                   </span><br><span class="line">                                                                                  </span><br><span class="line">                              地址：杭州市上城区佰富时代中心3幢13楼                                </span><br><span class="line">          1.1.3    招标代理机构                                                         </span><br><span class="line">                               联系人：潘正阳、陈瑶                                         </span><br><span class="line">                              电话：13758171369、18757567243                          </span><br><span class="line">                                  奥体街（扬帆路-养正巷）设计                                  </span><br><span class="line">          1.1.4     工程名称                                                          </span><br><span class="line">                              杭州市滨江区                                              </span><br><span class="line">          1.1.5     建设地点                                                          </span><br><span class="line">                              见招标公告                                               </span><br><span class="line">          1.1.6     建设规模                                                          </span><br><span class="line">                              本项目投资估算为22798万元                                     </span><br><span class="line">          1.1.7     投资估算                                                          </span><br><span class="line">                              国有100%                                              </span><br><span class="line">          1.2.1   资金来源及比例                                                         </span><br><span class="line">                              已落实                                                 </span><br><span class="line">          1.2.2    资金落实情况                                                         </span><br><span class="line">                              ☑方案设计、初步设计（含概算编制和调整）和施工图设计（☑BIM设计                   </span><br><span class="line">                              服务）                                                 </span><br><span class="line">                              招标内容具体包括:工程设计服务内容：        包括但不限于：                   </span><br><span class="line">                              （1）可研编制（含估算编制）、方案设计及深化、初步设计（含概算                     </span><br><span class="line">                              编制）、施工图设计【含BIM（若有）】、管线综合、交改设计（若                     </span><br><span class="line">                              有，含主体项目交改以及其他配套交改设计）、雨污水管线迁改（若                      </span><br><span class="line">                              有）、基坑设计、报批审查配合、按审查和招标人意见对整个设计过程                     </span><br><span class="line">                              的修改、深化整合等优化设计；                                      </span><br><span class="line">          1.3.1     招标范围                                                          </span><br><span class="line">                              （2）按招标文件要求提供纸质和电子图纸；                                </span><br><span class="line">                              （3）设计补图和工程施工阶段的变更联系单；                               </span><br><span class="line">                              （4）施工配合、验收配合、竣工图编制配合等相关服务；                          </span><br><span class="line">                              （5）根据工程实际需要提供现场服务等。                                 </span><br><span class="line">                              各阶段设计成果应符合国家规定的图纸编制深度要求及相关出图标准要                     </span><br><span class="line">                              求且应满足发包人的相关要求，并应及时完成招标人和相关审查部门的                     </span><br><span class="line">                              阶段性审查意见所提出的修改工作等，特别是相关部门不计次数的优化                     </span><br><span class="line">                                                                                  </span><br><span class="line">                              修改要求等。阶段性审查包括方案评审、初步设计审查和施工图审查                      </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line">                                         12                                       </span><br><span class="line">                                                                                  </span><br><span class="line">                                                                                  </span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-table-settings"><a href="#4-table-settings" class="headerlink" title="4 table_settings"></a>4 table_settings</h3><p><strong>⚙️ 表格提取设置（<code>table_settings</code>）</strong></p>
<p>默认情况下，<code>.extract_tables()</code> 使用页面的水平与垂直线（包括矩形边）作为单元格边界。但你可以通过 <code>table_settings</code> 自定义策略和阈值。示例设置及默认值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;vertical_strategy&quot;</span>: <span class="string">&quot;lines&quot;</span>,</span><br><span class="line">  <span class="string">&quot;horizontal_strategy&quot;</span>: <span class="string">&quot;lines&quot;</span>,</span><br><span class="line">  <span class="string">&quot;explicit_vertical_lines&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;explicit_horizontal_lines&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;snap_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;snap_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;snap_y_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;join_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;join_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;join_y_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;edge_min_length&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;min_words_vertical&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;min_words_horizontal&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;intersection_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;intersection_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;intersection_y_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;text_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;text_x_tolerance&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;text_y_tolerance&quot;</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>🧾 每个参数说明：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>vertical_strategy</code>, <code>horizontal_strategy</code></td>
<td>可选：<code>&quot;lines&quot;</code>, <code>&quot;lines_strict&quot;</code>, <code>&quot;text&quot;</code>, <code>&quot;explicit&quot;</code>，见下文策略解释。</td>
</tr>
<tr>
<td><code>explicit_vertical_lines</code>, <code>explicit_horizontal_lines</code></td>
<td>显式指定用于表格的垂直&#x2F;水平线列表，可为数字或线条对象。</td>
</tr>
<tr>
<td><code>snap_*_tolerance</code></td>
<td>平行线在该范围内将被“吸附”到相同位置。</td>
</tr>
<tr>
<td><code>join_*_tolerance</code></td>
<td>共线线段若端点间距小于此值将被合并为一条线段。</td>
</tr>
<tr>
<td><code>edge_min_length</code></td>
<td>忽略短于此值的线段。</td>
</tr>
<tr>
<td><code>min_words_vertical</code>, <code>min_words_horizontal</code></td>
<td>使用 <code>&quot;text&quot;</code> 策略时，需有多少单词对齐才能推断出线。</td>
</tr>
<tr>
<td><code>intersection_*_tolerance</code></td>
<td>组合边成单元格时，判断是否交叉的容差范围。</td>
</tr>
<tr>
<td><code>text_*</code></td>
<td>控制从表格中提取文字的参数，支持所有 <code>.extract_text(...)</code> 中的参数。</td>
</tr>
</tbody></table>
<p>🧠 表格提取策略解释：</p>
<table>
<thead>
<tr>
<th>策略</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>&quot;lines&quot;</code></td>
<td>使用图形线条（包括矩形边）作为单元格边界。</td>
</tr>
<tr>
<td><code>&quot;lines_strict&quot;</code></td>
<td>使用图形线条（不包括矩形边）作为单元格边界。</td>
</tr>
<tr>
<td><code>&quot;text&quot;</code></td>
<td>根据文字的左&#x2F;中&#x2F;右对齐（垂直策略）或顶部对齐（水平策略）推断出虚拟线条作为单元格边界。</td>
</tr>
<tr>
<td><code>&quot;explicit&quot;</code></td>
<td>仅使用显式定义的线条（<code>explicit_*_lines</code> 参数提供）。</td>
</tr>
</tbody></table>
<p>📝 说明</p>
<ul>
<li>在提取表格前使用 <code>Page.crop(...)</code> 裁剪页面，往往可以提高精度。</li>
</ul>
<hr>
<h3 id="5-extract-words-…"><a href="#5-extract-words-…" class="headerlink" title="5 extract_words(…)"></a>5 extract_words(…)</h3><p><code>.extract_words()</code> 方法说明</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.extract_words(</span><br><span class="line">    x_tolerance=<span class="number">3</span>,</span><br><span class="line">    x_tolerance_ratio=<span class="literal">None</span>,</span><br><span class="line">    y_tolerance=<span class="number">3</span>,</span><br><span class="line">    keep_blank_chars=<span class="literal">False</span>,</span><br><span class="line">    use_text_flow=<span class="literal">False</span>,</span><br><span class="line">    line_dir=<span class="string">&quot;ttb&quot;</span>,</span><br><span class="line">    char_dir=<span class="string">&quot;ltr&quot;</span>,</span><br><span class="line">    line_dir_rotated=<span class="string">&quot;ttb&quot;</span>,</span><br><span class="line">    char_dir_rotated=<span class="string">&quot;ltr&quot;</span>,</span><br><span class="line">    extra_attrs=[],</span><br><span class="line">    split_at_punctuation=<span class="literal">False</span>,</span><br><span class="line">    expand_ligatures=<span class="literal">True</span>,</span><br><span class="line">    return_chars=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>该方法返回一个 <strong>所有“看起来像单词”的文本及其边界框</strong> 的列表。</p>
<p>🔍 单词识别逻辑</p>
<ul>
<li><strong>通常字符（upright）</strong>：若一个字符的 <code>x1</code> 与下一个字符的 <code>x0</code> 之间的距离 ≤ <code>x_tolerance</code>，且两者的 <code>doctop</code> 差值 ≤ <code>y_tolerance</code>，则被视为同一个单词的一部分。</li>
<li><strong>若设置了 <code>x_tolerance_ratio</code></strong>，则 <code>x_tolerance</code> 会根据字符尺寸动态调整：<br> <code>x_tolerance = x_tolerance_ratio * previous_character[&quot;size&quot;]</code></li>
<li><strong>非正立字符</strong>（例如旋转过的文字）：采用垂直距离而非水平距离进行判断。</li>
</ul>
<p>⚙️ 参数说明</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>x_tolerance</code></td>
<td>同一行字符在水平方向上间距的容差。</td>
</tr>
<tr>
<td><code>x_tolerance_ratio</code></td>
<td>动态容差比值，基于字符大小计算。若不为 None，则覆盖 <code>x_tolerance</code>。</td>
</tr>
<tr>
<td><code>y_tolerance</code></td>
<td>判断字符是否在同一行的垂直容差。</td>
</tr>
<tr>
<td><code>keep_blank_chars</code></td>
<td>是否保留空格字符为单词的一部分（默认否）。设为 <code>True</code> 表示空格也视为字符，不将其作为单词分隔符。</td>
</tr>
<tr>
<td><code>use_text_flow</code></td>
<td>是否依据 PDF 内部的字符流顺序排列与分组文本（模拟文本拖选效果），而不是按坐标位置排序。</td>
</tr>
<tr>
<td><code>line_dir</code></td>
<td>期望的行排列方向： <code>&quot;ttb&quot;</code>（上到下）、<code>&quot;btt&quot;</code>（下到上）。</td>
</tr>
<tr>
<td><code>char_dir</code></td>
<td>期望的字符排列方向： <code>&quot;ltr&quot;</code>（左到右）、<code>&quot;rtl&quot;</code>（右到左）。</td>
</tr>
<tr>
<td><code>line_dir_rotated</code></td>
<td>旋转文本的行排列方向。</td>
</tr>
<tr>
<td><code>char_dir_rotated</code></td>
<td>旋转文本的字符排列方向。</td>
</tr>
<tr>
<td><code>extra_attrs</code></td>
<td>限定单词必须由具有完全相同属性的字符组成，如 <code>[&quot;fontname&quot;, &quot;size&quot;]</code>。提取结果中会包含这些属性。</td>
</tr>
<tr>
<td><code>split_at_punctuation</code></td>
<td>是否在标点处分词，设为 <code>True</code> 表示在标点处强制切词。也可传入一个字符串，如 <code>&#39;!.,;&#39;</code> 自定义标点。</td>
</tr>
<tr>
<td><code>expand_ligatures</code></td>
<td>是否将连字（如 <code>ﬁ</code>）拆为其组成字母（如 <code>f</code> 和 <code>i</code>）。默认 <code>True</code>。</td>
</tr>
<tr>
<td><code>return_chars</code></td>
<td>是否在每个单词字典中添加构成它的字符列表（作为 <code>&quot;chars&quot;</code> 字段）。</td>
</tr>
</tbody></table>
<p>📦 返回值结构（列表中的每个元素是一个字典）</p>
<p>每个“单词”包含如下字段：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;text&quot;</span>: <span class="string">&quot;单词内容&quot;</span>,</span><br><span class="line">  <span class="string">&quot;x0&quot;</span>: 100.0,</span><br><span class="line">  <span class="string">&quot;x1&quot;</span>: 130.5,</span><br><span class="line">  <span class="string">&quot;top&quot;</span>: 90.2,</span><br><span class="line">  <span class="string">&quot;bottom&quot;</span>: 103.6,</span><br><span class="line">  <span class="string">&quot;doctop&quot;</span>: 290.2,</span><br><span class="line">  <span class="string">&quot;chars&quot;</span>: [ &#123;...&#125;, &#123;...&#125; ]  <span class="comment"># 仅当 return_chars=True 时提供</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>✅ 示例用法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;example.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">0</span>]</span><br><span class="line">    words = page.extract_words(x_tolerance=<span class="number">2</span>, y_tolerance=<span class="number">2</span>, return_chars=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;单词: <span class="subst">&#123;word[<span class="string">&#x27;text&#x27;</span>]&#125;</span>, 位置: (<span class="subst">&#123;word[<span class="string">&#x27;x0&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;top&#x27;</span>]&#125;</span>) - (<span class="subst">&#123;word[<span class="string">&#x27;x1&#x27;</span>]&#125;</span>, <span class="subst">&#123;word[<span class="string">&#x27;bottom&#x27;</span>]&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-extract-words-vs-extract-text-lines"><a href="#6-extract-words-vs-extract-text-lines" class="headerlink" title="6 extract_words() vs extract_text_lines()"></a>6 extract_words() vs extract_text_lines()</h3><p><code>.extract_text_lines()</code> 和 <code>.extract_words()</code> <strong>在输出结构上有相似之处</strong>，但它们关注的<strong>粒度和应用场景不同</strong>：</p>
<p>🆚 <code>.extract_words()</code> vs <code>.extract_text_lines()</code></p>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>.extract_words()</code></th>
<th><code>.extract_text_lines()</code></th>
</tr>
</thead>
<tbody><tr>
<td>📦 粒度</td>
<td><strong>按单词</strong>划分</td>
<td><strong>按文本行</strong>划分</td>
</tr>
<tr>
<td>📐 坐标</td>
<td>每个词的 <code>x0, top, x1, bottom</code></td>
<td>每行文本的 <code>x0, top, x1, bottom</code></td>
</tr>
<tr>
<td>🔠 内容组织</td>
<td>每个词是一个独立对象</td>
<td>每行是一个整体（包含多个字符或词）</td>
</tr>
<tr>
<td>🔍 可选内容</td>
<td>可加 <code>return_chars=True</code> 返回组成词的字符</td>
<td>默认可返回每行字符（同样用 <code>return_chars=True</code>）</td>
</tr>
<tr>
<td>🧭 排序依据</td>
<td>主要靠字符之间的水平&#x2F;垂直距离（默认 <code>x/y_tolerance</code>）</td>
<td>可选择 layout 方式，依赖版式流（<code>layout=True</code>）</td>
</tr>
<tr>
<td>🧩 应用场景</td>
<td>提取关键字段、词级处理、搜索</td>
<td>精准还原行结构、逐行处理、OCR 后处理</td>
</tr>
</tbody></table>
<p>✅ 举例说明差别</p>
<p>假设你有一页 PDF 内容是：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">项目名称：XX工程项目</span><br><span class="line">招标人：YY公司</span><br></pre></td></tr></table></figure>

<p>用 <code>.extract_words()</code> 输出（指定<code>split_at_punctuation=True</code>）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;项目名称&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., <span class="string">&#x27;top&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;：&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;XX工程项目&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;招标人&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;：&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;,</span><br><span class="line">  &#123;<span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;YY公司&#x27;</span>, <span class="string">&#x27;x0&#x27;</span>:..., ...&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>👉 你得到的是<strong>词级</strong>切分，适合做关键词匹配或结构化提取。</p>
<p>用 <code>.extract_text_lines()</code> 输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;项目名称：XX工程项目&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;chars&#x27;</span>: [...],  <span class="comment"># 所有字符详细位置</span></span><br><span class="line">    <span class="string">&#x27;x0&#x27;</span>: ..., <span class="string">&#x27;top&#x27;</span>: ..., ...</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;招标人：YY公司&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;chars&#x27;</span>: [...],</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>👉 你得到的是<strong>整行信息</strong>，非常适合做：</p>
<ul>
<li>OCR结果还原</li>
<li>按行分组处理（比如”招标人”是 key，”YY公司”是 value）</li>
</ul>
<p>🎯 总结建议</p>
<table>
<thead>
<tr>
<th>目标</th>
<th>推荐方法</th>
</tr>
</thead>
<tbody><tr>
<td>关键词定位、字段抽取</td>
<td><code>.extract_words()</code></td>
</tr>
<tr>
<td>保持 PDF 原有排版顺序、行级处理</td>
<td><code>.extract_text_lines()</code></td>
</tr>
<tr>
<td>精细字符位置分析</td>
<td>任意方法 + <code>return_chars=True</code></td>
</tr>
</tbody></table>
<hr>
<h3 id="7-search"><a href="#7-search" class="headerlink" title="7 search"></a>7 search</h3><p>📘 <code>.search()</code> 方法说明</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page.search(pattern, regex=<span class="literal">True</span>, <span class="keyword">case</span>=<span class="literal">True</span>, main_group=<span class="number">0</span>,</span><br><span class="line">            return_groups=<span class="literal">True</span>, return_chars=<span class="literal">True</span>,</span><br><span class="line">            layout=<span class="literal">False</span>, **kwargs)</span><br></pre></td></tr></table></figure>

<p>这是一个<strong>实验性功能</strong>，用于在页面中搜索匹配的文本，返回所有匹配项的列表。</p>
<p>📌 参数说明：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>pattern</code></td>
<td>查询字符串或正则表达式，可以是编译或未编译的 regex，也可以是普通字符串</td>
</tr>
<tr>
<td><code>regex</code></td>
<td>如果为 <code>False</code>，则 <code>pattern</code> 被当作普通字符串处理（非正则表达式）</td>
</tr>
<tr>
<td><code>case</code></td>
<td>为 <code>False</code> 时忽略大小写</td>
</tr>
<tr>
<td><code>main_group</code></td>
<td>指定主返回的正则分组（默认 <code>0</code> 表示整体匹配）</td>
</tr>
<tr>
<td><code>return_groups</code></td>
<td>如果设为 <code>False</code>，将不返回正则分组匹配结果</td>
</tr>
<tr>
<td><code>return_chars</code></td>
<td>如果设为 <code>False</code>，不返回匹配字符的字符对象列表</td>
</tr>
<tr>
<td><code>layout</code></td>
<td>与 <code>.extract_text()</code> 的 layout 参数相同，是否按布局方式分析文本</td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td>其他传给 <code>.extract_text(layout=True, ...)</code> 的参数</td>
</tr>
</tbody></table>
<blockquote>
<p>⚠️ 注意：<strong>匹配为空字符串或全空格的结果会被自动忽略</strong>，因为它们通常没有实际的页面位置（bbox）。</p>
</blockquote>
<p>✅ 使用示例（搜索“招标人”并输出其位置信息）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pdfplumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开 PDF 文件</span></span><br><span class="line"><span class="keyword">with</span> pdfplumber.<span class="built_in">open</span>(<span class="string">&quot;example.pdf&quot;</span>) <span class="keyword">as</span> pdf:</span><br><span class="line">    page = pdf.pages[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 搜索关键词“招标人”</span></span><br><span class="line">    results = page.search(<span class="string">&quot;招标人&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, <span class="keyword">match</span> <span class="keyword">in</span> <span class="built_in">enumerate</span>(results):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;第 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> 个匹配：&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; - 匹配文本：&quot;</span>, <span class="keyword">match</span>[<span class="string">&quot;text&quot;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; - 位置：&quot;</span>, <span class="keyword">match</span>[<span class="string">&quot;x0&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;top&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;x1&quot;</span>], <span class="keyword">match</span>[<span class="string">&quot;bottom&quot;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; - 所含字符数量：&quot;</span>, <span class="built_in">len</span>(<span class="keyword">match</span>[<span class="string">&quot;chars&quot;</span>]))</span><br></pre></td></tr></table></figure>

<p>✅ 使用正则表达式进行复杂匹配（如提取“项目名称：XXX”）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;项目名称[：:]?\s*(\S+)&quot;</span>)</span><br><span class="line">results = page.search(pattern)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> results:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;主匹配文本：&quot;</span>, r[<span class="string">&quot;text&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正则分组（项目名）：&quot;</span>, r[<span class="string">&quot;groups&quot;</span>][<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;位置：&quot;</span>, r[<span class="string">&quot;x0&quot;</span>], r[<span class="string">&quot;top&quot;</span>], r[<span class="string">&quot;x1&quot;</span>], r[<span class="string">&quot;bottom&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>💡 常见用途场景：</p>
<ul>
<li>精确定位关键词在页面中的位置（比如“开标时间”、“联系人”）</li>
<li>做结构化信息提取（使用正则提取“键：值”结构）</li>
<li>做表单&#x2F;模板字段匹配（比如识别“税号：123456”）</li>
</ul>
<hr>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/pdf/" rel="tag"># pdf</a>
              <a href="/tags/pdfplumber/" rel="tag"># pdfplumber</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/05/30/PDF%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7%EF%BC%9AMinerU%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" rel="prev" title="PDF解析工具：MinerU安装与使用">
                  <i class="fa fa-angle-left"></i> PDF解析工具：MinerU安装与使用
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/07/CLIP%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" rel="next" title="CLIP安装与使用">
                  CLIP安装与使用 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Chr</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">279k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">16:56</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","src":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
