<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"caihaoran-00.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="前言本文记录在本地ubuntu电脑上（一张4090）用LLamaFactory微调Qwen2.5 VL，用做笔记及分享。">
<meta property="og:type" content="article">
<meta property="og:title" content="LLamaFactory微调Qwen2.5VL">
<meta property="og:url" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/index.html">
<meta property="og:site_name" content="Chr&#39;s Blog">
<meta property="og:description" content="前言本文记录在本地ubuntu电脑上（一张4090）用LLamaFactory微调Qwen2.5 VL，用做笔记及分享。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/0eb4d4ace6c1cfb48d0c523289df758.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/f070b353532642d1b4b48b4292f742f.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/image-20250219095449804.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/e6c1ceaa980c6ca5d13b41f06dafa2f.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/61d444e63e300a4f8e57636aa4aa9e0.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/60c478373b620ec976f2236e553ad14.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/abda935ed8d70e23525b287792cea49.png">
<meta property="og:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/image-20250218181054901.png">
<meta property="article:published_time" content="2025-02-18T08:05:23.000Z">
<meta property="article:modified_time" content="2025-03-24T06:54:56.345Z">
<meta property="article:author" content="Chr">
<meta property="article:tag" content="LLM">
<meta property="article:tag" content="Qwen2.5">
<meta property="article:tag" content="LLamaFactory">
<meta property="article:tag" content="Qwen2.5VL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/0eb4d4ace6c1cfb48d0c523289df758.png">


<link rel="canonical" href="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/","path":"2025/02/18/LLamaFactory微调Qwen2-5VL/","title":"LLamaFactory微调Qwen2.5VL"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LLamaFactory微调Qwen2.5VL | Chr's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Chr's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Record and Share</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85LLamaFactory"><span class="nav-number">2.</span> <span class="nav-text">安装LLamaFactory</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E6%A8%A1%E5%9E%8B%E6%96%87%E4%BB%B6%EF%BC%88%E4%BD%BF%E7%94%A8%E9%AD%94%E6%90%AD%E6%96%B9%E6%B3%95%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">下载模型文件（使用魔搭方法）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E5%A7%8B%E6%A8%A1%E5%9E%8B%E7%9B%B4%E6%8E%A5%E6%8E%A8%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">原始模型直接推理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">5.</span> <span class="nav-text">自定义数据集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8ELoRA%E7%9A%84sft%E6%8C%87%E4%BB%A4%E5%BE%AE%E8%B0%83"><span class="nav-number">6.</span> <span class="nav-text">基于LoRA的sft指令微调</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%90%88%E5%B9%B6LoRA%E7%9A%84%E6%8E%A8%E7%90%86"><span class="nav-number">7.</span> <span class="nav-text">动态合并LoRA的推理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E8%A7%A3%E6%9E%90"><span class="nav-number">8.</span> <span class="nav-text">数据集解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81alpaca-%E6%8C%87%E4%BB%A4%E7%9B%91%E7%9D%A3%E5%BE%AE%E8%B0%83%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">8.1.</span> <span class="nav-text">一、alpaca 指令监督微调数据集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E5%8F%98%E4%BD%931"><span class="nav-number">8.1.1.</span> <span class="nav-text">小变体1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E5%8F%98%E4%BD%932"><span class="nav-number">8.1.2.</span> <span class="nav-text">小变体2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81sharegpt-%E6%8C%87%E4%BB%A4%E7%9B%91%E7%9D%A3%E5%BE%AE%E8%B0%83%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">8.2.</span> <span class="nav-text">二、sharegpt 指令监督微调数据集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E5%8F%98%E4%BD%931-1"><span class="nav-number">8.2.1.</span> <span class="nav-text">小变体1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E5%8F%98%E4%BD%932-1"><span class="nav-number">8.2.2.</span> <span class="nav-text">小变体2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E5%8F%98%E4%BD%933"><span class="nav-number">8.2.3.</span> <span class="nav-text">小变体3</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81sharegpt-%E5%81%8F%E5%A5%BD%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">8.3.</span> <span class="nav-text">三、sharegpt 偏好数据集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81alpaca-%E5%81%8F%E5%A5%BD%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">8.4.</span> <span class="nav-text">四、alpaca 偏好数据集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81sharegpt-KTO%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">8.5.</span> <span class="nav-text">五、sharegpt KTO数据集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81alpaca%E9%A2%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">8.6.</span> <span class="nav-text">六、alpaca预训练数据集</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%84%E4%BC%B0"><span class="nav-number">9.</span> <span class="nav-text">评估</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%84%E5%BD%95"><span class="nav-number">10.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Pre-Training%EF%BC%88%E9%A2%84%E8%AE%AD%E7%BB%83%EF%BC%89%E2%80%94%E2%80%94-%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0"><span class="nav-number">10.1.</span> <span class="nav-text">Pre-Training（预训练）—— 基础学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SFT%EF%BC%88Supervised-Fine-Tuning%EF%BC%8C%E7%9B%91%E7%9D%A3%E5%BE%AE%E8%B0%83%EF%BC%89%E2%80%94%E2%80%94-%E5%AD%A6%E4%BC%9A%E5%90%AC%E4%BA%BA%E8%AF%9D"><span class="nav-number">10.2.</span> <span class="nav-text">SFT（Supervised Fine-Tuning，监督微调）—— 学会听人话</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reward-Modeling%EF%BC%88%E5%A5%96%E5%8A%B1%E5%BB%BA%E6%A8%A1%EF%BC%89%E2%80%94%E2%80%94-%E8%AE%AD%E7%BB%83-AI-%E8%AF%84%E5%88%A4%E5%A5%BD%E5%9D%8F"><span class="nav-number">10.3.</span> <span class="nav-text">Reward Modeling（奖励建模）—— 训练 AI 评判好坏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PPO%EF%BC%88Proximal-Policy-Optimization%EF%BC%8C%E8%BF%91%E7%AB%AF%E7%AD%96%E7%95%A5%E4%BC%98%E5%8C%96%EF%BC%89%E2%80%94%E2%80%94-%E8%AE%A9-AI-%E7%94%9F%E6%88%90%E9%AB%98%E5%88%86%E7%AD%94%E6%A1%88"><span class="nav-number">10.4.</span> <span class="nav-text">PPO（Proximal Policy Optimization，近端策略优化）—— 让 AI 生成高分答案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DPO%EF%BC%88Direct-Preference-Optimization%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%81%8F%E5%A5%BD%E4%BC%98%E5%8C%96%EF%BC%89%E2%80%94%E2%80%94-%E8%AE%A9-AI-%E7%9B%B4%E6%8E%A5%E5%AD%A6%E4%BC%9A%E4%BA%BA%E7%B1%BB%E5%81%8F%E5%A5%BD"><span class="nav-number">10.5.</span> <span class="nav-text">DPO（Direct Preference Optimization，直接偏好优化）—— 让 AI 直接学会人类偏好</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#KTO%EF%BC%88KL-regularized-Transformer-Optimization%EF%BC%8CKL-%E6%AD%A3%E5%88%99%E5%8C%96-Transformer-%E4%BC%98%E5%8C%96%EF%BC%89%E2%80%94%E2%80%94-%E8%AE%A9-AI-%E4%BC%98%E5%8C%96%E5%81%8F%E5%A5%BD%E4%BD%86%E4%B8%8D%E8%B7%91%E5%81%8F"><span class="nav-number">10.6.</span> <span class="nav-text">KTO（KL-regularized Transformer Optimization，KL 正则化 Transformer 优化）—— 让 AI 优化偏好但不跑偏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ORPO%EF%BC%88Offline-Reinforcement-Preference-Optimization%EF%BC%8C%E7%A6%BB%E7%BA%BF%E5%BC%BA%E5%8C%96%E5%81%8F%E5%A5%BD%E4%BC%98%E5%8C%96%EF%BC%89%E2%80%94%E2%80%94-%E7%94%A8%E7%8E%B0%E6%88%90%E6%95%B0%E6%8D%AE%E4%BC%98%E5%8C%96-AI"><span class="nav-number">10.7.</span> <span class="nav-text">ORPO（Offline Reinforcement Preference Optimization，离线强化偏好优化）—— 用现成数据优化 AI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SimPO%EF%BC%88Simple-Preference-Optimization%EF%BC%8C%E7%AE%80%E5%8D%95%E5%81%8F%E5%A5%BD%E4%BC%98%E5%8C%96%EF%BC%89%E2%80%94%E2%80%94-%E6%9B%B4%E7%AE%80%E5%8D%95%E7%9A%84-DPO"><span class="nav-number">10.8.</span> <span class="nav-text">SimPO（Simple Preference Optimization，简单偏好优化）—— 更简单的 DPO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%EF%BC%88%E7%94%A8%E7%AE%80%E5%8D%95%E7%9A%84%E8%AF%9D%E5%AF%B9%E6%AF%94%E8%BF%99%E4%BA%9B%E6%A6%82%E5%BF%B5%EF%BC%89"><span class="nav-number">10.9.</span> <span class="nav-text">总结（用简单的话对比这些概念）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%A0%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E9%80%89%EF%BC%9F"><span class="nav-number">10.10.</span> <span class="nav-text">你应该怎么选？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gradio%E8%BF%90%E8%A1%8CLLamaFactory%EF%BC%88TODO%EF%BC%89"><span class="nav-number">11.</span> <span class="nav-text">Gradio运行LLamaFactory（TODO）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="nav-number">12.</span> <span class="nav-text">参考链接</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chr</p>
  <div class="site-description" itemprop="description">Welcome to my little world</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:1299964565@qq.com" title="E-Mail → mailto:1299964565@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://caihaoran-00.github.io/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chr">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chr's Blog">
      <meta itemprop="description" content="Welcome to my little world">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="LLamaFactory微调Qwen2.5VL | Chr's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LLamaFactory微调Qwen2.5VL
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-02-18 16:05:23" itemprop="dateCreated datePublished" datetime="2025-02-18T16:05:23+08:00">2025-02-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-24 14:54:56" itemprop="dateModified" datetime="2025-03-24T14:54:56+08:00">2025-03-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>13k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>47 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文记录在本地ubuntu电脑上（一张4090）用LLamaFactory微调Qwen2.5 VL，用做笔记及分享。</p>
<span id="more"></span>

<hr>
<h2 id="安装LLamaFactory"><a href="#安装LLamaFactory" class="headerlink" title="安装LLamaFactory"></a>安装LLamaFactory</h2><p><a target="_blank" rel="noopener" href="https://github.com/hiyouga/LLaMA-Factory/blob/main/README_zh.md#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8">参考</a>，运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/hiyouga/LLaMA-Factory.git</span><br><span class="line"><span class="built_in">cd</span> LLaMA-Factory</span><br><span class="line"></span><br><span class="line">conda create -n llamafactory  python=3.10</span><br><span class="line">conda activate llamafactory</span><br><span class="line">pip install -e <span class="string">&quot;.[torch,metrics]&quot;</span></span><br></pre></td></tr></table></figure>

<p>经过漫长等待即可完成环境下载。</p>
<p>注意后面微调时会提示<code>KeyError:&#39;qwen2_5_vl&#39;</code>，解决办法，<a target="_blank" rel="noopener" href="https://github.com/hiyouga/LLaMA-Factory/issues/6784#issuecomment-2647135280">参考</a>：</p>
<ol>
<li><p>源码构建方式安装transforms：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install git+https://github.com/huggingface/transformers.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>注释掉src&#x2F;llamafactory&#x2F;extras&#x2F;misc.py的第97行：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># check_version(<span class="string">&quot;transformers&gt;=4.41.2,&lt;=4.48.3,!=4.46.0,!=4.46.1,!=4.46.2,!=4.46.3,!=4.47.0,!=4.47.1,!=4.48.0&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="下载模型文件（使用魔搭方法）"><a href="#下载模型文件（使用魔搭方法）" class="headerlink" title="下载模型文件（使用魔搭方法）"></a>下载模型文件（使用魔搭方法）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://www.modelscope.cn/Qwen/Qwen2.5-VL-7B-Instruct.git</span><br></pre></td></tr></table></figure>

<p>其他模型可在这个<a target="_blank" rel="noopener" href="https://modelscope.cn/models">页面</a>查找及下载。下载完成后（漫长等待），打开这个<a target="_blank" rel="noopener" href="https://modelscope.cn/models/Qwen/Qwen2.5-VL-7B-Instruct/files">页面</a>肉眼对比下文件数量和大小。</p>
<hr>
<h2 id="原始模型直接推理"><a href="#原始模型直接推理" class="headerlink" title="原始模型直接推理"></a>原始模型直接推理</h2><p>运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llamafactory-cli webchat examples/inference/qwen2_5_vl.yaml</span><br></pre></td></tr></table></figure>

<p><code>examples/inference/qwen2_5_vl.yaml</code> 的配置示例如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model_name_or_path: /home/chr/桌面/llamafactory/Qwen2.5-VL-7B-Instruct</span><br><span class="line">template: qwen2_vl</span><br><span class="line">infer_backend: huggingface <span class="comment">#choices： [huggingface, vllm]</span></span><br><span class="line">trust_remote_code: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/0eb4d4ace6c1cfb48d0c523289df758.png" class="" title="0eb4d4ace6c1cfb48d0c523289df758">

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/f070b353532642d1b4b48b4292f742f.png" class="" title="f070b353532642d1b4b48b4292f742f">

<hr>
<h2 id="自定义数据集"><a href="#自定义数据集" class="headerlink" title="自定义数据集"></a>自定义数据集</h2><p>LLamafactory目前支持alpaca和sharegpt两种格式，以alpaca为例，整个数据集是一个json对象的list，具体数据格式为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;用户指令（必填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;用户输入（选填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型回答（必填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;系统提示词（选填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;history&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">[</span><span class="string">&quot;第一轮指令（选填）&quot;</span><span class="punctuation">,</span> <span class="string">&quot;第一轮回答（选填）&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">[</span><span class="string">&quot;第二轮指令（选填）&quot;</span><span class="punctuation">,</span> <span class="string">&quot;第二轮回答（选填）&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>比如单轮（alpaca_data_zh_51k.json 中的例子, 数据集在data&#x2F;dataset_info.json中注册为alpaca_zh）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;写一个有效的比较语句&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;篮球和足球&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;篮球和足球都是受欢迎的运动。&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>和多轮 （oaast_sft_zh.json 中的例子, 数据集在data&#x2F;dataset_info.json中注册为oaast_sft_zh）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;谢谢&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;不用谢! 很高兴我提供的信息能够帮助到你! 如果还有什么其他问题也可以向我提问。&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;history&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;请你给我写一个面试准备计划，我想要去面试微软的程序员岗位&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;首先，你可以去微软官网寻找招聘信息并申请面试。\n其次，您可以在社交媒体平台寻找微软公司对程序员的面试问题，并做好准备。\n最后，您可以自己对面试过程进行模拟，熟悉话题并减少紧张感。\n我希望你能面试成功。&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>所以我们训练的数据最好也转换成这种格式，然后在 data&#x2F;dataset_info.json中<strong>进行注册</strong>（如果不做字段名称转换，则需要在注册的时候在 columns字段中做两个数据的映射配置）</p>
<p><strong>接下来，我们使用两个具体的例子来说明数据集的使用</strong></p>
<p>第一个是系统自带的identity.json数据集(已默认在data&#x2F;dataset_info.json 注册为identity)，对应文件已经在data目录下，我们通过操作系统的文本编辑器的替换功能，可以替换其中的NAME 和 AUTHOR ，换成我们需要的内容。如果是linux系统，可以使用<strong>sed</strong> 完成快速替换。比如助手的名称修改为PetNet， 由fy开发：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/&#123;&#123;name&#125;&#125;/PetNet/g&#x27;</span>  data/identity.json </span><br><span class="line">sed -i <span class="string">&#x27;s/&#123;&#123;author&#125;&#125;/fy/g&#x27;</span>  data/identity.json</span><br></pre></td></tr></table></figure>

<p>替换前：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Who are you?&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hello! I am &#123;&#123;name&#125;&#125;, an AI assistant developed by &#123;&#123;author&#125;&#125;. How can I assist you today?&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>替换后：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Who are you?&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;I am PetNet, an AI assistant developed by fy. How can I assist you today?&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>第二个是一个商品文案生成数据集，<a target="_blank" rel="noopener" href="https://cloud.tsinghua.edu.cn/f/b3f119a008264b1cabd1/?dl=1">原始链接</a></p>
<p>原始格式如下，很明显，训练目标是输入content （也就是prompt）, 输出 summary （对应response）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;类型#裤*版型#宽松*风格#性感*图案#线条*裤型#阔腿裤&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;宽松的阔腿裤这两年真的吸粉不少，明星时尚达人的心头爱。毕竟好穿时尚，谁都能穿出腿长2米的效果宽松的裤腿，当然是遮肉小能手啊。上身随性自然不拘束，面料亲肤舒适贴身体验感棒棒哒。系带部分增加设计看点，还让单品的设计感更强。腿部线条若隐若现的，性感撩人。颜色敲温柔的，与裤子本身所呈现的风格有点反差萌。&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>想将该自定义数据集放到我们的系统中使用，则需要进行如下两步操作：</p>
<ol>
<li><p>复制该数据集到 data目录下</p>
</li>
<li><p>修改 data&#x2F;dataset_info.json 新加内容完成注册, 该注册同时完成了3件事</p>
<ul>
<li><p>自定义数据集的名称为adgen_local，后续训练的时候就使用这个名称来找到该数据集</p>
</li>
<li><p>指定了数据集具体文件位置</p>
</li>
<li><p>定义了原数据集的输入输出和我们所需要的格式之间的映射关系</p>
</li>
</ul>
<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/image-20250219095449804.png" class="" title="image-20250219095449804"></li>
</ol>
<hr>
<h2 id="基于LoRA的sft指令微调"><a href="#基于LoRA的sft指令微调" class="headerlink" title="基于LoRA的sft指令微调"></a>基于LoRA的sft指令微调</h2><p>现在准备好数据集了，可以开始训练了，我们的目的是让原来的Qwen2.5 VL模型学会我们定义的“你是谁”，同时学会我们希望的商品文案的生成。</p>
<p>我们先从命令行版本做训练，以便于学习其中的相关原理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 llamafactory-cli train \</span><br><span class="line">    --stage sft \</span><br><span class="line">    --do_train \</span><br><span class="line">    --model_name_or_path /home/chr/桌面/llamafactory/Qwen2.5-VL-7B-Instruct \</span><br><span class="line">    --dataset alpaca_gpt4_zh,identity,adgen_local \</span><br><span class="line">    --dataset_dir ./data \</span><br><span class="line">    --template qwen2_vl \</span><br><span class="line">    --finetuning_type lora \</span><br><span class="line">    --output_dir ./saves/Qwen2.5-VL-7B-Instruct/lora/sft \</span><br><span class="line">    --overwrite_cache \</span><br><span class="line">    --overwrite_output_dir \</span><br><span class="line">    --cutoff_len 1024 \</span><br><span class="line">    --preprocessing_num_workers 16 \</span><br><span class="line">    --per_device_train_batch_size 2 \</span><br><span class="line">    --per_device_eval_batch_size 1 \</span><br><span class="line">    --gradient_accumulation_steps 8 \</span><br><span class="line">    --lr_scheduler_type cosine \</span><br><span class="line">    --logging_steps 50 \</span><br><span class="line">    --warmup_steps 20 \</span><br><span class="line">    --save_steps 100 \</span><br><span class="line">    --eval_steps 50 \</span><br><span class="line">    --evaluation_strategy steps \</span><br><span class="line">    --load_best_model_at_end \</span><br><span class="line">    --learning_rate 5e-5 \</span><br><span class="line">    --num_train_epochs 5.0 \</span><br><span class="line">    --max_samples 1000 \</span><br><span class="line">    --val_size 0.1 \</span><br><span class="line">    --plot_loss</span><br></pre></td></tr></table></figure>

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/e6c1ceaa980c6ca5d13b41f06dafa2f.png" class="" title="e6c1ceaa980c6ca5d13b41f06dafa2f">

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/61d444e63e300a4f8e57636aa4aa9e0.png" class="" title="61d444e63e300a4f8e57636aa4aa9e0">

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/60c478373b620ec976f2236e553ad14.png" class="" title="60c478373b620ec976f2236e553ad14">

<hr>
<h2 id="动态合并LoRA的推理"><a href="#动态合并LoRA的推理" class="headerlink" title="动态合并LoRA的推理"></a>动态合并LoRA的推理</h2><p>我们基于LoRA的训练进程结束后，想做下动态验证，与上文的原始模型直接推理相比，唯一的区别是需要通过finetuning_type参数告诉系统，我们使用了LoRA训练，然后将LoRA的模型位置通过 adapter_name_or_path参数即可。</p>
<p><code>qwen2_5_vl_lora.yaml</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">model_name_or_path: /home/chr/桌面/llamafactory/Qwen2.5-VL-7B-Instruct</span><br><span class="line">template: qwen2_vl</span><br><span class="line">adapter_name_or_path: ./saves/Qwen2.5-VL-7B-Instruct/lora/sft</span><br><span class="line">finetuning_type: lora</span><br><span class="line">infer_backend: huggingface <span class="comment">#choices： [huggingface, vllm]</span></span><br><span class="line">trust_remote_code: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llamafactory-cli webchat examples/inferece/qwen2_5_vl_lora.yaml</span><br></pre></td></tr></table></figure>

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/abda935ed8d70e23525b287792cea49.png" class="" title="abda935ed8d70e23525b287792cea49">

<p>好了，可以看出微调是有效的。</p>
<hr>
<h2 id="数据集解析"><a href="#数据集解析" class="headerlink" title="数据集解析"></a>数据集解析</h2><p>上面略微解释了自定义数据集，本节着重归纳总结下数据集的格式。</p>
<p>首先，看下LLamaFactory官方对<code>dataset_info.json</code>文件的定义规范：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;数据集名称&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;hf_hub_url&quot;</span>: <span class="string">&quot;Hugging Face 的数据集仓库地址（若指定，则忽略 script_url 和 file_name）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ms_hub_url&quot;</span>: <span class="string">&quot;ModelScope 的数据集仓库地址（若指定，则忽略 script_url 和 file_name）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;script_url&quot;</span>: <span class="string">&quot;包含数据加载脚本的本地文件夹名称（若指定，则忽略 file_name）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;file_name&quot;</span>: <span class="string">&quot;该目录下数据集文件夹或文件的名称（若上述参数未指定，则此项必需）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;formatting&quot;</span>: <span class="string">&quot;数据集格式（可选，默认：alpaca，可以为 alpaca 或 sharegpt）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ranking&quot;</span>: <span class="string">&quot;是否为偏好数据集（可选，默认：False）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;subset&quot;</span>: <span class="string">&quot;数据集子集的名称（可选，默认：None）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;split&quot;</span>: <span class="string">&quot;所使用的数据集切分（可选，默认：train）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;folder&quot;</span>: <span class="string">&quot;Hugging Face 仓库的文件夹名称（可选，默认：None）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;num_samples&quot;</span>: <span class="string">&quot;该数据集所使用的样本数量。（可选，默认：None）&quot;</span>,</span><br><span class="line">  <span class="string">&quot;columns（可选）&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;prompt&quot;</span>: <span class="string">&quot;数据集代表提示词的表头名称（默认：instruction）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;query&quot;</span>: <span class="string">&quot;数据集代表请求的表头名称（默认：input）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: <span class="string">&quot;数据集代表回答的表头名称（默认：output）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;history&quot;</span>: <span class="string">&quot;数据集代表历史对话的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;messages&quot;</span>: <span class="string">&quot;数据集代表消息列表的表头名称（默认：conversations）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;system&quot;</span>: <span class="string">&quot;数据集代表系统提示的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tools&quot;</span>: <span class="string">&quot;数据集代表工具描述的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;images&quot;</span>: <span class="string">&quot;数据集代表图像输入的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;videos&quot;</span>: <span class="string">&quot;数据集代表视频输入的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;audios&quot;</span>: <span class="string">&quot;数据集代表音频输入的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;chosen&quot;</span>: <span class="string">&quot;数据集代表更优回答的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rejected&quot;</span>: <span class="string">&quot;数据集代表更差回答的表头名称（默认：None）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;kto_tag&quot;</span>: <span class="string">&quot;数据集代表 KTO 标签的表头名称（默认：None）&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;tags（可选，用于 sharegpt 格式）&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;role_tag&quot;</span>: <span class="string">&quot;消息中代表发送者身份的键名（默认：from）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content_tag&quot;</span>: <span class="string">&quot;消息中代表文本内容的键名（默认：value）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user_tag&quot;</span>: <span class="string">&quot;消息中代表用户的 role_tag（默认：human）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;assistant_tag&quot;</span>: <span class="string">&quot;消息中代表助手的 role_tag（默认：gpt）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;observation_tag&quot;</span>: <span class="string">&quot;消息中代表工具返回结果的 role_tag（默认：observation）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;function_tag&quot;</span>: <span class="string">&quot;消息中代表工具调用的 role_tag（默认：function_call）&quot;</span>,</span><br><span class="line">    <span class="string">&quot;system_tag&quot;</span>: <span class="string">&quot;消息中代表系统提示的 role_tag（默认：system，会覆盖 system column）&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后，结合<code>dataset_info.json</code>，学习下<code>dataset_info.json</code>的写法。</p>
<h3 id="一、alpaca-指令监督微调数据集"><a href="#一、alpaca-指令监督微调数据集" class="headerlink" title="一、alpaca 指令监督微调数据集"></a>一、alpaca 指令监督微调数据集</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;identity&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;identity.json&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">identity.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;instruction&quot;</span>: <span class="string">&quot;hi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;input&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;output&quot;</span>: <span class="string">&quot;Hello! I am &#123;&#123;name&#125;&#125;, an AI assistant developed by &#123;&#123;author&#125;&#125;. How can I assist you today?&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>归纳：</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;数据集名称&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;data.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;output&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;history&quot;</span><span class="punctuation">:</span> <span class="string">&quot;history&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类指令（必填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类输入（选填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型回答（必填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;系统提示词（选填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;history&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">[</span><span class="string">&quot;第一轮指令（选填）&quot;</span><span class="punctuation">,</span> <span class="string">&quot;第一轮回答（选填）&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">[</span><span class="string">&quot;第二轮指令（选填）&quot;</span><span class="punctuation">,</span> <span class="string">&quot;第二轮回答（选填）&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>有个问题：人类指令和人类输入的区别和联系是什么：</p>
<ul>
<li>人类指令instruction是任务的核心，决定模型要做什么，通常是明确的操作或目标（必填）</li>
<li>人类输入input是任务的具体内容，为指令提供上下文或详细信息，使模型能针对特定内容生成响应，未填写则回复通用回答（选填）</li>
</ul>
<p>例：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">alpaca_zh_demo.json </span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;请根据以下文章构建一个需要回答的问题。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我不好意思，您没有提供任何信息或文章来供我根据它构建问题。 请提供相应的文章或信息，以便我能够帮助您构建问题。&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;根据下表，将每个句子分类为定义、事实或观点。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;|句子|\n|--------|\n|水果是一种通常甜味且含有种子的食物类别。|\n|苹果是一种水果。|\n|苹果是口感最好的水果。|&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;|句子|分类|\n|--------|-----|\n|水果是一种通常甜味且含有种子的食物类别。|定义|\n|苹果是一种水果。|事实|\n|苹果是口感最好的水果。|观点|&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;写一首四行诗，主题是自然。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;青山绿水美如画，\n晨霞晚霞常换档。\n花香鸟语自然谧，\n四季交替更生长。&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;输入三支篮球队的名称并生成一个适当的口号。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;输入：俄克拉荷马城雷霆队，芝加哥公牛队，布鲁克林网队。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;输出： \&quot;雷霆，公牛和网队：各显神通，角逐群雄!\&quot;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;比较以下两位著名人物，使用特征列表并以句子形式提供输出。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人物1：阿尔伯特·爱因斯坦\n人物2：斯蒂芬·霍金\n特征：智力、教育、对世界的影响&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;阿尔伯特·爱因斯坦和斯蒂芬·霍金都是拥有极其出色智力的人物。两人都取得过非常高的教育成就，他们推进了科学发展并在世界范围内产生了深远的影响。爱因斯坦以其相对论和质能关系公式而闻名，而霍金以其关于黑洞和宇宙的发现而著称。两位科学家都以其深厚的学识和非凡的贡献影响了世界。&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;生成一个算法，找到并显示两个文本字符串之间的最长公共子串。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;输入：\n字符串1：This is an example\n字符串2：This string should contain the example&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;算法：动态规划\n\n```python\ndef longest_common_substring(s1, s2):\n    m = len(s1)\n    n = len(s2)\n    result = 0\n    end = 0\n    # 创建一个(m+1)x(n+1)的二维数组来表示最长公共子串的长度\n    length = [[0] * (n + 1) for i in range(m + 1)]\n    # 填充数组\n    for i in range(1, m + 1):\n        for j in range(1, n + 1):\n            if s1[i - 1] == s2[j - 1]:\n                length[i][j] = length[i - 1][j - 1] + 1\n                if length[i][j] &gt; result:\n                    result = length[i][j]\n                    end = i - 1\n    return s1[end - result + 1:end + 1]\n\n\ns1 = &#x27;This is an example&#x27;\ns2 = &#x27;This string should contain the example&#x27;\nprint(longest_common_substring(s1, s2))\n```\n\n输出：example\n\n解释：\n\n1. 创建一个二维数组，将其所有元素初始化为0。\n2. 通过双层循环遍历两个字符串，当字符相同时在对角线上加1。\n3. 找到最大值，并记录最大值所在的行和列。\n4. 由于我们是从1开始遍历字符串的，所以结果要减一才是真正的索引。\n\n时间复杂度：O(m*n)\n\n空间复杂度：O(m*n)&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="小变体1"><a href="#小变体1" class="headerlink" title="小变体1"></a>小变体1</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;alpaca_en&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_en&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_en&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;om_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HaM/alpaca_en&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;alpaca_zh&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_zh&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_zh&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;alpaca_gpt4_en&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_gpt4_en&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_gpt4_en&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;alpaca_gpt4_zh&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_gpt4_zh&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/alpaca_gpt4_zh&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;om_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;State_Cloud/alpaca-gpt4-data-zh&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>与第一类类似，只是数据是从网站上下载，而不是从本地加载。</p>
<h4 id="小变体2"><a href="#小变体2" class="headerlink" title="小变体2"></a>小变体2</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;adgen_train&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HasturOfficial/adgen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;AI-ModelScope/adgen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;split&quot;</span><span class="punctuation">:</span> <span class="string">&quot;train&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;summary&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;adgen_eval&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HasturOfficial/adgen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;AI-ModelScope/adgen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;split&quot;</span><span class="punctuation">:</span> <span class="string">&quot;validation&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;summary&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>使用split参数指定所使用的数据集切分（可选，默认：train）。</p>
<hr>
<h3 id="二、sharegpt-指令监督微调数据集"><a href="#二、sharegpt-指令监督微调数据集" class="headerlink" title="二、sharegpt 指令监督微调数据集"></a>二、sharegpt 指令监督微调数据集</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;glaive_toolcall_zh_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glaive_toolcall_zh_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tools&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>相当于:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;glaive_toolcall_zh_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glaive_toolcall_zh_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tools&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;from&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;value&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;observation_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;observation&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;function_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;function_call&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;system_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">glaive_toolcall_zh_demo.json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我需要为John Doe生成一张发票。他购买了2个苹果，每个$1，以及3根香蕉，每根$0.5。&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;function_call&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;\&quot;name\&quot;: \&quot;generate_invoice\&quot;, \&quot;arguments\&quot;: &#123;\&quot;customer_name\&quot;: \&quot;约翰·多伊\&quot;, \&quot;items\&quot;: [&#123;\&quot;name\&quot;: \&quot;苹果\&quot;, \&quot;quantity\&quot;: 2, \&quot;price\&quot;: 1&#125;, &#123;\&quot;name\&quot;: \&quot;香蕉\&quot;, \&quot;quantity\&quot;: 3, \&quot;price\&quot;: 0.5&#125;]&#125;&#125;&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;observation&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;\&quot;invoice_id\&quot;: \&quot;INV12345\&quot;, \&quot;customer_name\&quot;: \&quot;约翰·多伊\&quot;, \&quot;items\&quot;: [&#123;\&quot;name\&quot;: \&quot;苹果\&quot;, \&quot;quantity\&quot;: 2, \&quot;price\&quot;: 1, \&quot;total\&quot;: 2&#125;, &#123;\&quot;name\&quot;: \&quot;香蕉\&quot;, \&quot;quantity\&quot;: 3, \&quot;price\&quot;: 0.5, \&quot;total\&quot;: 1.5&#125;], \&quot;total\&quot;: 3.5, \&quot;status\&quot;: \&quot;生成\&quot;&#125;&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;发票已成功生成。发票编号为INV12345。约翰·多伊的总金额为$3.5。发票包含2个苹果，总金额为$2，以及3根香蕉，总金额为$1.5。&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;[&#123;\&quot;name\&quot;: \&quot;generate_invoice\&quot;, \&quot;description\&quot;: \&quot;生成发票\&quot;, \&quot;parameters\&quot;: &#123;\&quot;type\&quot;: \&quot;object\&quot;, \&quot;properties\&quot;: &#123;\&quot;customer_name\&quot;: &#123;\&quot;type\&quot;: \&quot;string\&quot;, \&quot;description\&quot;: \&quot;客户名称\&quot;&#125;, \&quot;items\&quot;: &#123;\&quot;type\&quot;: \&quot;array\&quot;, \&quot;items\&quot;: &#123;\&quot;type\&quot;: \&quot;object\&quot;, \&quot;properties\&quot;: &#123;\&quot;name\&quot;: &#123;\&quot;type\&quot;: \&quot;string\&quot;, \&quot;description\&quot;: \&quot;The item name\&quot;&#125;, \&quot;quantity\&quot;: &#123;\&quot;type\&quot;: \&quot;integer\&quot;, \&quot;description\&quot;: \&quot;The quantity of the item\&quot;&#125;, \&quot;price\&quot;: &#123;\&quot;type\&quot;: \&quot;number\&quot;, \&quot;description\&quot;: \&quot;The price per unit\&quot;&#125;&#125;, \&quot;required\&quot;: [\&quot;name\&quot;, \&quot;quantity\&quot;, \&quot;price\&quot;]&#125;&#125;&#125;, \&quot;required\&quot;: [\&quot;customer_name\&quot;, \&quot;items\&quot;]&#125;&#125;, &#123;\&quot;name\&quot;: \&quot;generate_password\&quot;, \&quot;description\&quot;: \&quot;生成随机密码\&quot;, \&quot;parameters\&quot;: &#123;\&quot;type\&quot;: \&quot;object\&quot;, \&quot;properties\&quot;: &#123;\&quot;length\&quot;: &#123;\&quot;type\&quot;: \&quot;integer\&quot;, \&quot;description\&quot;: \&quot;密码的长度\&quot;&#125;&#125;, \&quot;required\&quot;: [\&quot;length\&quot;]&#125;&#125;]&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;假设你有一个需要随机数的Java程序，范围在0到10之间。你可以使用什么代码片段来生成这样的数字？\n\n下面是一个示例代码片段，它使用Math.random()方法来生成一个在0到1之间的随机数，然后缩放并四舍五入结果，得到一个在0到10之间的随机数：\n\n```java\nint randomNumber = (int) (Math.random() * 11);\n```\n\n在Java中是否有更有效的方法来生成随机数？你会如何修改代码以生成具有不同范围或分布的随机数？&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;您提供的代码片段是Java中生成随机数的一种常见且高效的方法。然而，如果您需要对随机数生成有更多的控制，您可以使用java.util.Random类，它提供了更多生成随机数的选项。\n\n要生成一个在不同范围内的随机数，您可以修改代码以调整缩放因子。例如，要生成一个在1到10之间的随机数，您可以使用以下代码：\n\nint randomNumber = (int) (Math.random() * 10) + 1;\n\n要生成具有不同分布的随机数，您可以使用各种技术，如正态分布、指数分布或自定义分布。生成正态分布的一种方法是使用Box-Muller变换。这里有一个代码示例，它生成具有正态分布的随机数：\n\nRandom random = new Random();\ndouble u1 = random.nextDouble();\ndouble u2 = random.nextDouble();\ndouble z = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);\ndouble mean = 5;\ndouble stdDev = 2;\nint randomNumber = (int) (z * stdDev + mean);\n\n这段代码生成一个具有均值5和标准差2的正态分布随机数。您可以调整均值和标准差来生成具有不同分布的随机数。&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你能解释一下算法分析中的大O记法概念吗？&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;是的，大O表示法是一种描述算法性能随输入数据大小增加的方法。它用于估计算法在最坏情况下的时间复杂度或空间复杂度。大O中的“O”代表“数量级”，这意味着随着输入大小的增加，算法所需的操作数以一定的速率增长。\n\n例如，如果我们有一个需要n步才能解决大小为n的问题的算法，那么时间复杂度可以表示为O(n)，这意味着操作数随着输入大小线性增长。如果我们有一个需要n^2步才能解决大小为n的问题的算法，那么时间复杂度可以表示为O(n^2)，这意味着操作数随着输入大小二次方增长。\n\n还有其他几种大O表示法，如O(log n)、O(n log n)、O(2^n)等，它们代表了随着输入大小增加的不同操作数增长速率。通过分析算法的大O表示法，我们可以比较不同算法的性能，并选择给定问题最有效的算法。\n\n您是否有关于大O表示法或算法分析的特定问题？&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;[]&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p><strong>归纳：</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;数据集名称&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;data.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tools&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类指令&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;function_call&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;工具参数&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;observation&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;工具结果&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型回答&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;系统提示词（选填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;工具描述（选填）&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="小变体1-1"><a href="#小变体1-1" class="headerlink" title="小变体1"></a>小变体1</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;mllm_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mllm_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;messages&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;images&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;role&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mllm_audio_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mllm_audio_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;messages&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;audios&quot;</span><span class="punctuation">:</span> <span class="string">&quot;audios&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;role&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mllm_video_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mllm_video_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;messages&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;videos&quot;</span><span class="punctuation">:</span> <span class="string">&quot;videos&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;role&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">mllm_demo.json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;image&gt;Who are they?&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;They&#x27;re Kane and Gretzka from Bayern Munich.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;What are they doing?&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;They are celebrating on the soccer field.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;images&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;mllm_demo_data/1.jpg&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">mllm_audio_demo.json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;audio&gt;What&#x27;s that sound?&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;It is the sound of glass shattering.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;audios&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;mllm_demo_data/1.mp3&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">mllm_video_demo.json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;video&gt;Why is this video funny?&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Because a baby is reading, and he is so cute!&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;videos&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;mllm_demo_data/1.mp4&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>此类与第二类的区别有：</p>
<ul>
<li>conversations-&gt;messages</li>
<li>没有tools，但有audio&#x2F;imag&#x2F;video</li>
<li>tag标签，role_tag默认为from，所以第二类缺省，第三类需对应<code>role</code>（其余同理）。</li>
</ul>
<h4 id="小变体2-1"><a href="#小变体2-1" class="headerlink" title="小变体2"></a>小变体2</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json </span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;glaive_toolcall_en&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/glaive_toolcall_en&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tools&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;glaive_toolcall_zh&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/glaive_toolcall_zh&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tools&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lima&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/lima&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>与前文类似，只是数据是从网上下载。</p>
<h4 id="小变体3"><a href="#小变体3" class="headerlink" title="小变体3"></a>小变体3</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;llava_1k_en&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BUAADreamer/llava-en-zh-2k&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;subset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;en&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;messages&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;images&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;role&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;llava_1k_zh&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BUAADreamer/llava-en-zh-2k&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;subset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zh&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;messages&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;images&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;role&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>通过subset选择数据集子集。</p>
<hr>
<h3 id="三、sharegpt-偏好数据集"><a href="#三、sharegpt-偏好数据集" class="headerlink" title="三、sharegpt 偏好数据集"></a>三、sharegpt 偏好数据集</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;dpo_zh_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dpo_zh_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ranking&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chosen&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rejected&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">dpo_zh_demo.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;请提供一下对香港银行业的分析以及目前面临的挑战。&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;香港银行业长期以来一直是该城市金融服务业和整体经济的重要组成部分。其特点是健全的监管框架、大量银行和资本流动的便利。以下分析涵盖了该行业面临的一些关键因素和当前挑战：\n\n1. 市场结构：香港银行业包括三类机构：持牌银行、受限牌照银行和接受存款公司。截至2021年4月，香港有160家持牌银行、19家受限牌照银行和13家接受存款公司。该行业由几家主要银行主导，汇丰银行、恒生银行、中国银行（香港）和渣打银行占据最大的市场份额。\n\n2. 监管框架：香港金融管理局负责监督银行体系的正常运作、稳定性和完整性。它通过实施法规和指导方针、监督持牌机构，并确保符合巴塞尔III等国际标准。\n\n3. 资本和流动性：香港银行保持强大的资本和流动性状况，资本比率远高于巴塞尔III标准设定的最低要求。这有助于该行业对经济冲击的稳定性和抵御能力。\n\n尽管具有这些优势，香港银行业目前面临着几个挑战：\n\n1. 经济放缓和中美贸易紧张局势：香港经济高度依赖贸易，受到中国内地经济放缓和中美贸易冲突的负面影响。这可能影响银行的贷款组合、信用质量和整体盈利能力。\n\n2. 低利率环境：由于全球经济衰退，世界各国央行一直采取宽松的货币政策，降低利率。香港银行受到影响，因为该市与美元挂钩的汇率制度导致净利差收窄和盈利能力降低。\n\n3. 地缘政治风险：香港实施国家安全法和美中紧张局势加剧引发了对该市银行业潜在影响的担忧，如制裁或国际银行撤离。\n\n4. 技术颠覆：金融科技和数字银行的兴起为香港银行业带来机遇和挑战。传统银行需要增强数字能力，投资创新技术以与新兴金融科技公司和虚拟银行竞争。\n\n5. 合规和监管变化：随着国际法规的演变，香港银行必须不断适应并遵守新规定，这可能耗时且成本高昂。此外，他们需要管理与反洗钱（AML）和打击恐怖融资（CFT）法规相关的风险。\n\n总之，香港银行业仍具有强大的基本面，但需要解决上述挑战，以在不断变化的全球格局中保持竞争力和稳定性。&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;香港的银行业面临着诸多挑战，如低利率、高房价和经济疲软。新冠疫情也给该行业带来了压力，企业和消费者都在艰难度日。一些分析师建议政府可能需要采取措施，如降低贷款利率或向陷入困境的企业提供财政援助。\n\n尽管面临这些挑战，香港的银行业仍受到良好监管，消费者和企业对其信任度高。该行业还以其强调创新和采用新技术，如移动银行和数字支付而闻名。总体而言，香港银行业的前景仍然积极，但需要谨慎管理和关注持续发展。&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>这种是sharegpt格式的偏好数据集，偏好数据集用于奖励模型训练、DPO训练、ORPO训练和SimPO训练。</p>
<p>需要在chosen列中提供更优的消息，并在rejected列中提供更差的消息。</p>
<p>归纳：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;数据集名称&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;data.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ranking&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chosen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rejected&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类指令&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型回答&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类指令&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;优质回答&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;劣质回答&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h3 id="四、alpaca-偏好数据集"><a href="#四、alpaca-偏好数据集" class="headerlink" title="四、alpaca 偏好数据集"></a>四、alpaca 偏好数据集</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;ultrafeedback&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hf_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/ultrafeedback_binarized&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ms_hub_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llamafactory/ultrafeedback_binarized&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ranking&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chosen&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rejected&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;In this task, you are given a second sentence. Your task is to generate the first sentence on the same topic but incoherent and inconsistent with the second sentence.\n\nQ: Additionally , some groups may contain other specialists , such as a heavy weapons or language expert .\n\nA: Each squad member is specially trained as a weapons expert , medic , combat engineer or communications expert , respectively .\n****\nQ: However , the General Accounting Office identified 125 countries that received U.S. training and assistance for their police forces during fiscal year 1990 at a cost of at least $117 million .\n\nA: No government agency is in charge of calculating the cost .\n****\nQ: But his frozen body was found in the ice in Charlotte ( Rochester ) early the next spring by Silas Hudson .\n\nA:&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Could you provide some context or information about what you are looking for or any particular questions you have, so I can assist better?&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;As an AI assistant, it&#x27;s essential to generate the first sentence on the same topic that may seem unrelated or inconsistent with the second sentence. Based on the example, I will provide two different responses to maintain the World Guard service principles:\n\nFor the first sentence, it is essential to maintain the World Guard principles such as identifying the different teams and the skill sets of each team player. The first sentence would be:\n\n\&quot;Intelligence gathering and operation teams consist of specialized personnel, including ghost operatives proficient in combat, communications, and espionage.\&quot;\n\nFor the second sentence, the inconsistency lies in the context of fiscal year and police training. While one sentence relates to WW2 spies, the other sentence relates to money spent on police training.\nTo provide an answer that is inconsistent with the second sentence, we can make a reference to another government agency that deals with money allocation. Thus, the WW2 spies sentence would be:\n\n\&quot;After the famous World War II event, during which spies called themselves &#x27;The World Guard,&#x27; the USA created a government agency called &#x27;The Department of Finance.&#x27; Their sole purpose was to monitor, regulate and control the fiscal year expenses made on various training and assistance programs, which help expand national capacities.\&quot;\n\nPlease let me know if you need any further assistance, and I would be happy to help!&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>这是alpaca格式的偏好数据集，归纳：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;数据集名称&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;data.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ranking&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chosen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rejected&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类指令（必填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类输入（选填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;优质回答（必填）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;劣质回答（必填）&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h3 id="五、sharegpt-KTO数据集"><a href="#五、sharegpt-KTO数据集" class="headerlink" title="五、sharegpt KTO数据集"></a>五、sharegpt KTO数据集</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;kto_en_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;kto_en_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;messages&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;kto_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;label&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;role&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;user_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;assistant_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The Federal Trade Commission is going after spyware, bits of computer code that install themselves on the computers of Internet users to track or disrupt their online activities.\nQ: Which is the best summary of this article?\nPick your answer from:\n(A). World\n(B). Sports\n(C). Business\n(D). Science/Tech\nI think the answer is&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Ooh ooh ah ah! *giggle* Let me think... Ooh ooh ah ah! *giggle* The best summary of this article is... *drumroll*... D! Science/Tech! Yay! *confetti* The Federal Trade Commission is talking about spyware, which is like a little computer bug that can watch what you do on your computer without you knowing. It&#x27;s like a secret agent, but not a nice one! *gasp* The FTC wants to stop the spyware from doing its thing, so they&#x27;re going after it! *cheer* Woohoo!&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Compare and contrast the roles of the hippocampus and the prefrontal cortex in the human brain, discussing their involvement in memory processing and decision making.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The human brain is a highly complex organ, responsible for a myriad of cognitive functions, including memory processing and decision making. Two critical regions implicated in these processes are the hippocampus and the prefrontal cortex. While both structures play significant roles in these cognitive domains, they each contribute distinct functions that work in concert to facilitate our ability to navigate the world and make informed choices.\n\nThe hippocampus, located within the medial temporal lobe, is predominantly associated with the formation, consolidation, and retrieval of memories. Specifically, it plays a crucial role in episodic memory, which encompasses the storage and recollection of autobiographical events, as well as spatial memory, which pertains to the encoding and retrieval of spatial information. The hippocampus is vital for the formation of new memories and the integration of these memories into existing knowledge structures. It has been demonstrated that damage to the hippocampus can result in anterograde amnesia, a condition characterized by an inability to form new memories, while leaving previously consolidated memories intact.\n\nIn contrast, the prefrontal cortex, situated in the anterior portion of the frontal lobes, is primarily involved in executive functions, which include higher-order cognitive processes such as decision making, planning, reasoning, and inhibitory control. The prefrontal cortex is responsible for integrating information from various sources, evaluating potential outcomes, and selecting the most advantageous course of action. It is also implicated in working memory, which refers to the temporary storage and manipulation of information necessary for complex cognitive tasks. Damage to the prefrontal cortex can result in deficits in decision making, impulsivity, and poor judgment.\n\nWhile the hippocampus and prefrontal cortex have distinct roles, they are interconnected and work synergistically to facilitate memory processing and decision making. The hippocampus provides the prefrontal cortex with contextual information and episodic memories that inform decision-making processes. Conversely, the prefrontal cortex can modulate the hippocampus&#x27;s activity during memory encoding and retrieval, influencing the salience and organization of memories. This dynamic interplay between the two regions enables individuals to adapt their decision-making strategies based on past experiences and contextual information.\n\nIn summary, the hippocampus and prefrontal cortex are integral to memory processing and decision making, albeit with distinct contributions. The hippocampus is primarily implicated in the formation, consolidation, and retrieval of episodic and spatial memories, while the prefrontal cortex is responsible for executive functions, including decision making, planning, and working memory. The interplay between these two regions allows for the integration of past experiences and contextual information in guiding informed decision making and shaping our behavior.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Discuss the mechanisms through which the prefrontal cortex modulates the hippocampus&#x27;s activity during memory encoding and retrieval.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The prefrontal cortex (PFC) and the hippocampus have a dynamic relationship that allows for the modulation of memory encoding and retrieval. This interaction is facilitated by direct and indirect neural pathways that connect the two regions, allowing for bidirectional communication.\n\nDuring memory encoding, the PFC is thought to modulate hippocampal activity through top-down control. The PFC can selectively enhance or suppress the processing of sensory information in the hippocampus based on its relevance to the task at hand. This process, known as &#x27;attentional modulation&#x27;, allows the PFC to guide the hippocampus in encoding memories that are relevant and suppressing those that are not. This is crucial for the formation of goal-directed behaviors and for the efficient use of cognitive resources.\n\nIn addition to attentional modulation, the PFC also influences the hippocampus through &#x27;working memory&#x27; operations. Working memory, a temporary storage system for information, is largely mediated by the PFC. During memory encoding, the PFC can use this working memory to provide the hippocampus with a &#x27;preview&#x27; of the information that is to be encoded, allowing the hippocampus to prepare for the incoming information and encode it more efficiently.\n\nDuring memory retrieval, the PFC again plays a modulatory role. It is thought that the PFC can initiate the retrieval process by sending a &#x27;retrieval cue&#x27; to the hippocampus. This cue triggers the reactivation of the neural patterns associated with the memory, allowing for its retrieval. The PFC can also influence the focus of retrieval, determining whether the retrieval is broad (i.e., recalling the general gist of an event) or specific (i.e., recalling specific details).\n\nFurthermore, the PFC can modulate the emotional intensity of retrieved memories through its connections with the amygdala, a region involved in emotional processing. This can influence the subjective experience of the memory, affecting how it is perceived and responded to.\n\nIn summary, the PFC modulates hippocampal activity during memory encoding and retrieval through a variety of mechanisms, including attentional modulation, working memory operations, retrieval initiation, and emotional modulation. These processes allow the PFC to guide the hippocampus in encoding and retrieving memories in a way that is adaptive and efficient.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Can you elaborate on the role of the amygdala in modulating the emotional intensity of retrieved memories, and how this interaction with the prefrontal cortex influences our perception and response to these memories?&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The amygdala plays a crucial role in the emotional processing of stored memories. It is a small almond-shaped structure situated deep within the medial temporal lobes that consists of multiple nuclei involved in different aspects of emotional processing, including the establishment of emotional associations and hedonic reactions to stimuli. The amygdala interacts extensively with both the hippocampus and the prefrontal cortex (PFC) to modulate emotional responses to retrieved memories.\n\nThe emotional component of a memory is largely encoded through the amygdala&#x27;s interaction with the hippocampus during memory formation. When an emotionally significant event occurs, the hippocampus provides contextual and spatial aspects of the memory, while the amygdala assigns an emotional value or salience to the memory. The solidification of these emotional associations ensures that emotional information associated with a given memory is readily reactivated during memory retrieval.\n\nDuring memory retrieval, the PFC receives information about the emotional intensity of the memory through reciprocal connections with the amygdala. The PFC can then modulate the impact of emotional memories on behavior and cognitive processes by using top-down control. This regulation can influence how we experience and respond to retrieved memories.\n\nFor example, the PFC can enhance or diminish the emotional intensity associated with a retrieved memory. This modulation can result in increased or decreased arousal, as well as altered subjective feelings of pleasure, discomfort, or despair. Additionally, PFC involvement can affect the context in which a memory is reactivated, leading to changes in the emotional response. The PFC can prioritize and filter information based on the current context or goal, which may result in more suitable emotional responses or the suppression of inappropriate emotional reactions.\n\nMoreover, the amygdala, PFC, and hippocampus work together in the process of emotion regulation. The anterior cingulate cortex (ACC), a region that lies within the PFC, often interacts with the amygdala to create a \&quot;circuit breaker\&quot; for emotional responses. The ACC receives input from the amygdala indicating the emotional intensity and salience of a memory, and can then engage with the amygdala to reduce the emotional response. This mechanism allows an individual to react in a more rational and appropriate manner when faced with emotionally charged situations.\n\nIn summary, the amygdala&#x27;s role in modulating the emotional intensity of retrieved memories is crucial for engaging with the world in an adaptive and meaningful way. Through its interactions with the hippocampus and, most significantly, the prefrontal cortex, the amygdala influences our perception and response to memories, contributing to our emotional experience and behavior.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p><strong>翻译版本：</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;美国联邦贸易委员会正在打击间谍软件，这些是能自行安装在互联网用户计算机上的计算机代码，用来跟踪或干扰他们的在线活动。\nQ: 哪个是这篇文章的最佳摘要？\n从以下选项中选择：\n(A). 世界\n(B). 体育\n(C). 商业\n(D). 科技\n我认为答案是&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;哦哦啊啊！*笑* 让我想想...哦哦啊啊！*笑* 这篇文章的最佳摘要是... *鼓声*... D！科技！耶！*彩带* 美国联邦贸易委员会正在讨论间谍软件，它就像一个小小的计算机病毒，可以偷偷观察你在电脑上做的事，但不是一个好心的秘密特工！*惊讶* 联邦贸易委员会想要阻止这些间谍软件做它们的坏事，所以他们正在对付它们！*欢呼* 哇哦！&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;比较和对比海马体和前额叶皮层在大脑中的作用，讨论它们在记忆处理和决策中的参与。&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类大脑是一个高度复杂的器官，负责多种认知功能，包括记忆处理和决策。海马体和前额叶皮层是两个在这些过程中的重要区域。尽管这两个结构在这些认知领域都发挥着重要作用，但它们各自的功能不同，并相互配合，帮助我们导航世界并做出明智的选择。\n\n海马体位于内侧颞叶，主要与记忆的形成、巩固和提取相关。具体来说，它在情景记忆中起着至关重要的作用，情景记忆包括自传性事件的存储和回忆，以及空间记忆，它涉及到空间信息的编码和提取。海马体对于新记忆的形成至关重要，并将这些记忆整合到现有的知识结构中。研究表明，海马体的损伤可能导致前向性健忘症，表现为无法形成新记忆，而已巩固的记忆仍然完好。\n\n相比之下，前额叶皮层位于大脑额叶的前部，主要涉及执行功能，包括更高层次的认知过程，如决策、计划、推理和抑制控制。前额叶皮层负责整合来自不同来源的信息，评估潜在结果，并选择最有利的行动方案。它还与工作记忆有关，工作记忆是指对信息的临时存储和操作，通常用于复杂的认知任务。前额叶皮层的损伤可能导致决策能力下降、冲动行为和判断力差。\n\n尽管海马体和前额叶皮层各自的功能不同，但它们是相互连接的，并且协同工作以促进记忆处理和决策。海马体向前额叶皮层提供情境信息和情景记忆，这些信息有助于决策过程。相反，前额叶皮层可以在记忆编码和提取过程中调节海马体的活动，影响记忆的显著性和组织。这种动态的相互作用使得个体能够根据过去的经验和情境信息调整决策策略。\n\n总之，海马体和前额叶皮层在记忆处理和决策中起着至关重要的作用，尽管它们各自的贡献不同。海马体主要与情景和空间记忆的形成、巩固和提取相关，而前额叶皮层则负责执行功能，包括决策、计划和工作记忆。两者之间的相互作用使得我们能够将过去的经验和情境信息结合起来，指导明智的决策和行为。&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;讨论前额叶皮层如何在记忆编码和提取过程中调节海马体的活动。&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;前额叶皮层（PFC）和海马体之间的关系是动态的，它允许在记忆编码和提取过程中对海马体的活动进行调节。这种相互作用是通过直接和间接的神经通路连接两者，允许双向的交流。\n\n在记忆编码过程中，前额叶皮层通过自上而下的控制来调节海马体的活动。前额叶皮层可以根据任务的相关性，选择性地增强或抑制海马体对感觉信息的处理。这一过程称为“注意性调节”，它允许前额叶皮层引导海马体编码与任务相关的记忆，并抑制那些不相关的记忆。这对于形成目标导向的行为以及有效利用认知资源至关重要。\n\n除了注意性调节，前额叶皮层还通过“工作记忆”操作影响海马体。工作记忆是信息的临时存储系统，主要由前额叶皮层介导。在记忆编码过程中，前额叶皮层可以利用工作记忆为海马体提供即将编码的信息“预览”，从而帮助海马体更有效地准备并编码这些信息。\n\n在记忆提取过程中，前额叶皮层再次发挥调节作用。前额叶皮层被认为可以通过向海马体发送“提取线索”来启动提取过程。这些线索触发与记忆相关的神经模式的重新激活，从而实现记忆的提取。前额叶皮层还可以影响提取的重点，决定提取是广泛的（即回忆事件的总体内容）还是具体的（即回忆事件的细节）。\n\n此外，前额叶皮层还可以通过与杏仁体的连接调节提取记忆的情绪强度，杏仁体是与情绪处理相关的区域。这会影响对记忆的主观体验，从而改变人们对记忆的感知和反应。\n\n总之，前额叶皮层通过多种机制调节海马体在记忆编码和提取过程中的活动，包括注意性调节、工作记忆操作、提取启动和情绪调节。这些过程使得前额叶皮层能够引导海马体以一种适应性和高效的方式编码和提取记忆。&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这是sharegpt格式的KTO数据集，归纳：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类指令&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型回答&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;kto_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;人类反馈 [true/false]（必填）&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;数据集名称&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;data.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;kto_tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;kto_tag&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="六、alpaca预训练数据集"><a href="#六、alpaca预训练数据集" class="headerlink" title="六、alpaca预训练数据集"></a>六、alpaca预训练数据集</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;wiki_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;wiki_demo.txt&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;c4_demo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c4_demo.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wiki_demo.txt</span><br><span class="line">Anarchism is a political philosophy and movement that is sceptical of authority and rejects all involuntary...</span><br><span class="line"></span><br><span class="line">c4_demo.json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Don’t think you need all the bells and whistles? No problem. McKinley Heating Service Experts Heating &amp; Air Conditioning offers basic air cleaners that work to improve the quality of the air in your home without breaking the bank. It is a low-cost solution that will ensure you and your family are living comfortably.\nIt’s a good idea to understand the efficiency rate of the filters, which measures what size of molecules can get through the filter. Basic air cleaners can filter some of the dust, dander and pollen that need to be removed. They are 85% efficient, and usually have a 6-inch cleaning surface.\nBasic air cleaners are not too expensive and do the job well. If you do want to hear more about upgrading from a basic air cleaner, let the NATE-certified experts at McKinley Heating Service Experts in Edmonton talk to you about their selection.\nEither way, now’s a perfect time to enhance and protect the indoor air quality in your home, for you and your loved ones.\nIf you want expert advice and quality service in Edmonton, give McKinley Heating Service Experts a call at 780-800-7092 to get your questions or concerns related to your HVAC system addressed.&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;To the apparent surprise of everyone, the Walt Disney Company has announced a deal to purchase Lucasfilm Ltd. According to the official press release, Disney has agreed to fork over $4.05 billion in cash and stock for George Lucas’ studio in a deal that brings together two of the world’s most important intellectual property libraries.\nAs you might expect, Disney is itching to take advantage of its new toys. “This transaction combines a world-class portfolio of content including Star Wars, one of the greatest family entertainment franchises of all time, with Disney’s unique and unparalleled creativity across multiple platforms, businesses, and markets to generate sustained growth and drive significant long-term value,” said Disney CEO Robert Iger in this afternoon’s announcement.\nUnder the terms of this agreement Disney will acquire control over all Lucasfilm iterations. This includes both its traditional film-making studio facilities, as well as the various technologies Lucasfilm has created over the years to further its various media properties. Thus, the gigantic Disney family now includes Lucasfilm itself, special effects house Industrial Light &amp; Magic, Skywalker Sound and LucasArts, the company’s video game creation division.\nThis acquisition alone would be huge news, but as if to pre-empt fan speculation on the future of Star Wars the same announcement also mentions that a new Star Wars movie is scheduled to appear in 2015. Though the vast majority of recent Star Wars media has been focused on the property’s various animated iterations and LEGO crossovers, this new film will be the first official cinematic continuation of George Lucas’ original Star Wars trilogy. Though very few details are offered on this film, it has officially been dubbed Star Wars: Episode VII, and barring any major catastrophes it should hit theaters at some point in 2015 (if we had to guess, we’d assume an early summer release in keeping with the tradition established by its predecessors).\nPerhaps even more intriguing however, is the announcement’s claim that Episode VII’s release will herald a new era in which new Star Wars movies hit theaters “every two to three years.” It specifically mentions Episodes VIII and IX by name, though offers no solid details on either film.\nWhile the effects of the move won’t be fully known for at least a few months, we can think of a number of a things this new union might change. For instance, currently Dark Horse Comics publishes all Star Wars comic books, but with Disney owning Marvel Comics we can’t see that agreement lasting for long. Likewise, both Disney and Lucasfilm have sizable divisions dedicated to creating video games based on their various media properties. Normally these companies have had to seek outside publishing agreements, but now that they’ve joined forces and massively expanded the number of games either company is capable of releasing in any given year, it makes a lot of sense for Disney to invest in its own games publishing wing.\nFinally, this agreement almost certainly heralds future crossovers between Disney and Lucasfilm characters. We don’t know any specifics, but it’s only a matter of time before we see toys depicting Mickey Mouse dressed as Darth Vader. Whether that sounds awesome or stomach-churningly disgusting is entirely up to your rapidly waning sense of childhood whimsy.\nUpdate: Scratch that last prediction. Apparently Disney characters dressed as Star Wars characters is already a thing.\nOur partnership with LucasFilm has produced over 20 yrs worth of stories. We have Star Wars for the near future, and hope for years to come.&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>由例子可见，预训练数据集只用于学习语言模型，目前llamafactory只支持alpaca格式的预训练集，归纳：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dataset_info.json</span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;数据集名称&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;data.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span><span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;document&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span><span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;document&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="评估"><a href="#评估" class="headerlink" title="评估"></a>评估</h2><p>llamafactory提供了通用能力评估和NLG评估，使用方法见<a target="_blank" rel="noopener" href="https://llamafactory.readthedocs.io/zh-cn/latest/getting_started/eval.html#id1">链接</a>，这里解释下什么是通用能力评估以及什么是NLG评估</p>
<ul>
<li><p>通用能力评测关注大模型在多个任务上的泛化能力，常用于衡量大模型是否具备<strong>推理、数学、知识问答、代码生成等多方面能力</strong>。LLamafactory提供了mmlu，cmmlu, ceval三个常见数据集的自动评测脚本。</p>
<table>
<thead>
<tr>
<th>数据集</th>
<th>语言</th>
<th>任务类型</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><strong>MMLU</strong></td>
<td>英文</td>
<td>多任务、多领域知识</td>
<td>评测大模型的英文知识与推理能力</td>
</tr>
<tr>
<td><strong>CMMU</strong></td>
<td>中文</td>
<td>多任务、多领域知识</td>
<td>评测大模型的中文知识与推理能力</td>
</tr>
<tr>
<td><strong>CEval</strong></td>
<td>中文</td>
<td>学术、专业知识</td>
<td>更专业的中文能力评测（涉及高难度任务）</td>
</tr>
</tbody></table>
</li>
<li><p>NLG方面提供了BLEU和ROUGE分数评价模型生成质量，<strong>BLEU</strong>（Bilingual Evaluation Understudy）：计算n-gram匹配率，常用于机器翻译评测。<strong>ROUGE</strong>（Recall-Oriented Understudy for Gisting Evaluation）：主要用于文本摘要任务，计算n-gram召回率。</p>
</li>
</ul>
<p>那如果想评估纵向领域的微调效果怎么办？</p>
<ul>
<li>用基准测试集（如 MMLU、CEval、MedQA）测准确率，提高数值指标</li>
<li>用自动指标（如 BLEU、BERTScore、FactScore）评估生成内容质量</li>
<li>结合人工评测+真实用户测试，确保专业领域的实际可用性</li>
</ul>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><ol>
<li><p>我看alpaca和sharegpt都有指令监督微调数据集和偏好数据集，那么我应该选哪个呢？</p>
<p>todo…</p>
</li>
<li><p>偏好数据集用于奖励模型训练、DPO训练、ORPO训练和SimPO训练，解释下这些术语以及Pre-train，SFT：</p>
<p>它们都是<strong>大模型训练的方法</strong>，可以理解为<strong>让 AI 变聪明的不同步骤</strong>。</p>
<p>我们可以把训练过程想象成<strong>培养一个优秀的学生</strong>，分为三个阶段：</p>
<ol>
<li><strong>基础学习</strong>（预训练 Pre-Training）</li>
<li><strong>学会听人话</strong>（SFT + 奖励建模 Reward Modeling）</li>
<li><strong>学会更符合人类喜好</strong>（PPO、DPO、KTO、ORPO、SimPO）</li>
</ol>
<hr>
<h3 id="Pre-Training（预训练）——-基础学习"><a href="#Pre-Training（预训练）——-基础学习" class="headerlink" title="Pre-Training（预训练）—— 基础学习"></a>Pre-Training（预训练）—— 基础学习</h3><blockquote>
<p>让 AI <strong>从零开始学习知识，相当于小孩上学</strong>。</p>
</blockquote>
<ul>
<li>AI 在<strong>大规模数据</strong>（比如书籍、论文、网站）上进行<strong>无监督学习</strong>，学习语法、常识、逻辑等。</li>
<li>这个阶段 AI <strong>还不会听人话</strong>，它只是学到了很多<strong>碎片化的知识</strong>。</li>
<li>例如：GPT-4、Llama-3 这些模型都经历了预训练阶段。</li>
</ul>
<p>📝 <strong>你可以理解成：AI 在上小学，疯狂看书，但不会对话。</strong></p>
<hr>
<h3 id="SFT（Supervised-Fine-Tuning，监督微调）——-学会听人话"><a href="#SFT（Supervised-Fine-Tuning，监督微调）——-学会听人话" class="headerlink" title="SFT（Supervised Fine-Tuning，监督微调）—— 学会听人话"></a>SFT（Supervised Fine-Tuning，监督微调）—— 学会听人话</h3><blockquote>
<p>让 AI <strong>按照人类的方式回答问题，相当于中学阶段的老师手把手教学</strong>。</p>
</blockquote>
<ul>
<li>用<strong>人类标注的数据</strong>（例如 ShareGPT、Alpaca）微调模型，让 AI <strong>学会按照人类的方式回答问题</strong>。</li>
<li>让 AI 更加<strong>符合特定任务</strong>，比如医学问答、法律咨询、编程助手等。</li>
<li>这个阶段 AI <strong>会听人话了，但还不一定懂得哪些回答是更好的</strong>。</li>
</ul>
<p>📝 <strong>相当于：AI 进入中学，老师告诉它哪些回答是正确的，但它还不能区分好坏回答。</strong></p>
<hr>
<h3 id="Reward-Modeling（奖励建模）——-训练-AI-评判好坏"><a href="#Reward-Modeling（奖励建模）——-训练-AI-评判好坏" class="headerlink" title="Reward Modeling（奖励建模）—— 训练 AI 评判好坏"></a>Reward Modeling（奖励建模）—— 训练 AI 评判好坏</h3><blockquote>
<p>让 AI <strong>知道哪些答案是好答案，哪些是坏答案，相当于 AI 参加考试，学习评分标准</strong>。</p>
</blockquote>
<ul>
<li>训练一个<strong>奖励模型（Reward Model, RM）</strong>，用来给 AI 的回答<strong>打分</strong>。</li>
<li>人类会对 AI 生成的回答<strong>进行比较</strong>（例如，哪种回答更好？），然后训练 RM 学习这个评分标准。</li>
<li><strong>Reward Model 并不会直接优化 AI，而是用来指导 AI 训练</strong>。</li>
</ul>
<p>📝 <strong>相当于：AI 在考试，学习如何给自己打分，知道什么样的回答会得高分。</strong></p>
<hr>
<h3 id="PPO（Proximal-Policy-Optimization，近端策略优化）——-让-AI-生成高分答案"><a href="#PPO（Proximal-Policy-Optimization，近端策略优化）——-让-AI-生成高分答案" class="headerlink" title="PPO（Proximal Policy Optimization，近端策略优化）—— 让 AI 生成高分答案"></a>PPO（Proximal Policy Optimization，近端策略优化）—— 让 AI 生成高分答案</h3><blockquote>
<p>让 AI <strong>使用强化学习（RL）优化自己的回答，使其更符合人类偏好，相当于 AI 根据分数改进自己</strong>。</p>
</blockquote>
<ul>
<li>先用 <strong>Reward Model（奖励模型）</strong> 给 AI 生成的回答打分。</li>
<li>然后用 PPO 让 AI <strong>调整自己的回答方式，让它更偏向高分回答</strong>。</li>
<li>这是 <strong>RLHF（基于人类反馈的强化学习）</strong> 的关键步骤，OpenAI 训练 ChatGPT 时用了 PPO。</li>
</ul>
<p>📝 <strong>相当于：AI 知道考试评分标准后，学会如何答题得高分，但有时候会“讨好”评分系统，回答变得保守。</strong></p>
<hr>
<h3 id="DPO（Direct-Preference-Optimization，直接偏好优化）——-让-AI-直接学会人类偏好"><a href="#DPO（Direct-Preference-Optimization，直接偏好优化）——-让-AI-直接学会人类偏好" class="headerlink" title="DPO（Direct Preference Optimization，直接偏好优化）—— 让 AI 直接学会人类偏好"></a>DPO（Direct Preference Optimization，直接偏好优化）—— 让 AI 直接学会人类偏好</h3><blockquote>
<p>让 AI <strong>不需要奖励模型，直接从人类选择的数据中学习偏好，相当于 AI 直接看答案，学会哪种更好</strong>。</p>
</blockquote>
<ul>
<li><strong>DPO 不需要 Reward Model</strong>，而是<strong>直接学习人类的选择</strong>（例如，给 AI 两个回答，选择更好的那个）。</li>
<li>DPO 比 PPO <strong>更简单、更稳定，不需要强化学习</strong>。</li>
<li>适用于偏好学习，例如对话风格优化、客服 AI 训练等。</li>
</ul>
<p>📝 <strong>相当于：AI 不用自己摸索评分标准，而是直接看人类的选择，学会什么样的回答更受欢迎。</strong></p>
<hr>
<h3 id="KTO（KL-regularized-Transformer-Optimization，KL-正则化-Transformer-优化）——-让-AI-优化偏好但不跑偏"><a href="#KTO（KL-regularized-Transformer-Optimization，KL-正则化-Transformer-优化）——-让-AI-优化偏好但不跑偏" class="headerlink" title="KTO（KL-regularized Transformer Optimization，KL 正则化 Transformer 优化）—— 让 AI 优化偏好但不跑偏"></a>KTO（KL-regularized Transformer Optimization，KL 正则化 Transformer 优化）—— 让 AI 优化偏好但不跑偏</h3><blockquote>
<p>让 AI <strong>在优化偏好的同时，不会跑得太远，相当于 AI 在考试中学会稳定发挥</strong>。</p>
</blockquote>
<ul>
<li><strong>KTO 是 DPO 的改进版</strong>，用 KL 散度约束优化过程，让 AI 在学习人类偏好的同时，不会偏离原来的知识太远。</li>
<li>这样 AI <strong>既能学到人类偏好，又不会丢掉原有的知识</strong>。</li>
</ul>
<p>📝 <strong>相当于：AI 在改进答案时，不会把自己搞糊涂，确保稳步提升。</strong></p>
<hr>
<h3 id="ORPO（Offline-Reinforcement-Preference-Optimization，离线强化偏好优化）——-用现成数据优化-AI"><a href="#ORPO（Offline-Reinforcement-Preference-Optimization，离线强化偏好优化）——-用现成数据优化-AI" class="headerlink" title="ORPO（Offline Reinforcement Preference Optimization，离线强化偏好优化）—— 用现成数据优化 AI"></a>ORPO（Offline Reinforcement Preference Optimization，离线强化偏好优化）—— 用现成数据优化 AI</h3><blockquote>
<p>让 AI <strong>用已有的评分数据训练，而不是在线试错，相当于 AI 只看老师批改好的试卷学习</strong>。</p>
</blockquote>
<ul>
<li><strong>ORPO 不让 AI 自己试错，而是用已有的评分数据来优化 AI</strong>。</li>
<li>适合<strong>医学、法律等不能乱试错的场景</strong>，保证 AI 输出的答案可靠。</li>
</ul>
<p>📝 <strong>相当于：AI 只学习老师批改好的试卷，不自己试错，以免出危险的答案。</strong></p>
<hr>
<h3 id="SimPO（Simple-Preference-Optimization，简单偏好优化）——-更简单的-DPO"><a href="#SimPO（Simple-Preference-Optimization，简单偏好优化）——-更简单的-DPO" class="headerlink" title="SimPO（Simple Preference Optimization，简单偏好优化）—— 更简单的 DPO"></a>SimPO（Simple Preference Optimization，简单偏好优化）—— 更简单的 DPO</h3><blockquote>
<p>让 AI <strong>用更简单的方式学习人类偏好，相当于 AI 直接模仿优秀答案，不用复杂训练</strong>。</p>
</blockquote>
<ul>
<li>SimPO <strong>比 DPO 计算量更小，更快</strong>，适用于小规模模型微调。</li>
<li>适用于<strong>快速优化 AI 在某些领域的表现</strong>，比如让 AI 更懂编程、医学等。</li>
</ul>
<p>📝 <strong>相当于：AI 直接看好答案，快速调整，不进行复杂计算。</strong></p>
<hr>
<h3 id="总结（用简单的话对比这些概念）"><a href="#总结（用简单的话对比这些概念）" class="headerlink" title="总结（用简单的话对比这些概念）"></a>总结（用简单的话对比这些概念）</h3><table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
<th>是否用奖励模型</th>
<th>是否用强化学习</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Pre-Training</strong></td>
<td>让 AI 学习基础知识</td>
<td>❌ 否</td>
<td>❌ 否</td>
</tr>
<tr>
<td><strong>SFT（监督微调）</strong></td>
<td>让 AI 学会听人话</td>
<td>❌ 否</td>
<td>❌ 否</td>
</tr>
<tr>
<td><strong>Reward Modeling</strong></td>
<td>让 AI 学会评判好坏</td>
<td>✅ 是</td>
<td>❌ 否</td>
</tr>
<tr>
<td><strong>PPO</strong></td>
<td>让 AI 根据评分优化回答</td>
<td>✅ 是</td>
<td>✅ 是（强化学习）</td>
</tr>
<tr>
<td><strong>DPO</strong></td>
<td>让 AI 直接学习人类偏好</td>
<td>❌ 否</td>
<td>❌ 否</td>
</tr>
<tr>
<td><strong>KTO</strong></td>
<td>让 AI 优化偏好但不跑偏</td>
<td>❌ 否</td>
<td>❌ 否</td>
</tr>
<tr>
<td><strong>ORPO</strong></td>
<td>用已有评分数据训练 AI</td>
<td>❌ 否</td>
<td>❌ 否</td>
</tr>
<tr>
<td><strong>SimPO</strong></td>
<td>让 AI 低成本学习偏好</td>
<td>❌ 否</td>
<td>❌ 否</td>
</tr>
</tbody></table>
<hr>
<h3 id="你应该怎么选？"><a href="#你应该怎么选？" class="headerlink" title="你应该怎么选？"></a>你应该怎么选？</h3><ul>
<li><strong>想训练大模型</strong> → 先 <strong>Pre-Training → SFT → PPO（RLHF）</strong></li>
<li><strong>想让 AI 优化回答但不搞复杂训练</strong> → 选 <strong>DPO、SimPO、KTO</strong></li>
<li><strong>如果数据已经有评分，想稳定优化</strong> → 选 <strong>ORPO</strong></li>
</ul>
</li>
<li><p>再详细解释下MMLU、CMMU、CEval</p>
<p><strong>MMLU（Massive Multitask Language Understanding）</strong></p>
<ul>
<li><p>用途：评测模型在<strong>多任务语言理解</strong>上的表现，包括<strong>知识问答、推理、数学、历史、法律、医学等57个子任务</strong>。</p>
</li>
<li><p>特点：</p>
<p>数据集涵盖<strong>小学到大学水平</strong>的各种领域知识。</p>
<p>采用**四选一（Multiple Choice）**的测试方式，评估模型在不同知识领域的准确率。</p>
<p>通常使用<strong>5-shot 或 zero-shot</strong>（即模型是否需要少量示例学习）。</p>
</li>
<li><p>适用场景：</p>
<p>评估大模型的<strong>世界知识和推理能力</strong>。</p>
<p>对比不同模型的多任务理解能力（如 GPT-4、LLaMA-2、Qwen 等）。</p>
</li>
</ul>
<p><strong>CMMU（Chinese Massive Multitask Language Understanding）</strong></p>
<ul>
<li><p>用途：MMLU 的<strong>中文版本</strong>，测试模型在<strong>中文多任务理解</strong>上的表现。</p>
</li>
<li><p>特点：</p>
<p>设计思路类似 MMLU，但数据经过<strong>中文优化</strong>，涵盖中国背景知识。</p>
<p>适用于<strong>评估中文大模型</strong>（如 ChatGLM、Baichuan、Qwen）。</p>
<p>也采用<strong>四选一</strong>的评测方式。</p>
</li>
<li><p>适用场景：</p>
<p>评测大模型在<strong>中文任务</strong>（如历史、地理、数学、法律、医学等）上的表现。</p>
<p>对比不同大模型在<strong>中文理解能力</strong>方面的优劣。</p>
</li>
</ul>
<p><strong>CEval（Chinese Evaluation Benchmark）</strong></p>
<ul>
<li><p><strong>用途</strong>：专门为<strong>中文大模型</strong>设计的<strong>权威测试集</strong>，涵盖<strong>学术、专业和通用能力测试</strong>。</p>
</li>
<li><p>特点：</p>
<p>涵盖<strong>52个任务</strong>，包含**基础知识（数学、物理）、人文社科（历史、法律）、工程技术（计算机、电子）**等多个领域。</p>
<p>任务难度从<strong>小学到大学水平</strong>。</p>
<p>也是<strong>四选一</strong>的选择题形式。</p>
</li>
<li><p>适用场景：</p>
<p>评测大模型在<strong>不同中文任务</strong>上的泛化能力。</p>
<p>适用于国内大模型的<strong>对比测试</strong>。</p>
</li>
</ul>
</li>
</ol>
<h2 id="Gradio运行LLamaFactory（TODO）"><a href="#Gradio运行LLamaFactory（TODO）" class="headerlink" title="Gradio运行LLamaFactory（TODO）"></a>Gradio运行LLamaFactory（TODO）</h2><p>运行下面命令，指定使用第一个卡（我这本身就只有一个卡，运行在7860端口，参考链接3）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 GRADIO_SERVER_PORT=7860 llamafactory-cli webui</span><br></pre></td></tr></table></figure>

<p>我实际使用以下命令也没问题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llamafactory-cli webui</span><br></pre></td></tr></table></figure>

<img src="/2025/02/18/LLamaFactory%E5%BE%AE%E8%B0%83Qwen2-5VL/image-20250218181054901.png" class="" title="image-20250218181054901">

<p>参考链接3，更改一点配置项：</p>
<ul>
<li>语言-&gt;zh</li>
<li>模型名称-&gt;Qwen2.5-VL-7B-Instruct</li>
<li>模型路径-&gt;&#x2F;home&#x2F;chr&#x2F;桌面&#x2F;llamafactory&#x2F;Qwen2.5-VL-7B-Instruct</li>
<li>数据集-&gt;alpaca_zh_demo，可点击<strong>预览数据集</strong>查看数据集</li>
<li>梯度累积-&gt;4</li>
<li>预热步数-&gt;4</li>
<li>LoRA缩放系数-&gt;256</li>
</ul>
<p>可点击<strong>预览命令</strong>查看命令（具体含义<a target="_blank" rel="noopener" href="https://llamafactory.readthedocs.io/zh-cn/latest/getting_started/sft.html">参考</a>），点击开始，这个时候会出个问题。</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/695287607">https://zhuanlan.zhihu.com/p/695287607</a></li>
<li><a target="_blank" rel="noopener" href="https://llamafactory.readthedocs.io/zh-cn/latest/getting_started/installation.html#">https://llamafactory.readthedocs.io/zh-cn/latest/getting_started/installation.html#</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1UvF5eLEyb/?vd_source=075a061948e76c87e2ee8754e264056e">https://www.bilibili.com/video/BV1UvF5eLEyb/?vd_source=075a061948e76c87e2ee8754e264056e</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/hiyouga/LLaMA-Factory/blob/main/data/README_zh.md">https://github.com/hiyouga/LLaMA-Factory/blob/main/data/README_zh.md</a></li>
<li><a target="_blank" rel="noopener" href="https://llamafactory.readthedocs.io/zh-cn/latest/getting_started/inference.html">https://llamafactory.readthedocs.io/zh-cn/latest/getting_started/inference.html</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/LLM/" rel="tag"># LLM</a>
              <a href="/tags/Qwen2-5/" rel="tag"># Qwen2.5</a>
              <a href="/tags/LLamaFactory/" rel="tag"># LLamaFactory</a>
              <a href="/tags/Qwen2-5VL/" rel="tag"># Qwen2.5VL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/02/17/MobaXterm%E8%BF%9E%E6%8E%A5%E5%85%AC%E5%8F%B8%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2ASR%E7%8E%AF%E5%A2%83/" rel="prev" title="MobaXterm连接公司服务器部署ASR环境">
                  <i class="fa fa-angle-left"></i> MobaXterm连接公司服务器部署ASR环境
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/02/21/cam-senseVoice%E6%9E%84%E5%BB%BA%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="next" title="cam+senseVoice构建微服务">
                  cam+senseVoice构建微服务 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Chr</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">115k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">6:56</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
